---
title: 'Analyses in Perceiving through the Grapevine: A Network Approach to Reputations'
author: "MASKED FOR PEER REVIEW"
date: "last knitted: `r Sys.time()`"
output:
    html_document:
      toc: true
      toc_float: true
      code_folding: show
      df_print: paged
---

# Data & Libraries
Here I'll read in the data and load the libraries I'll use, including the `ReputationModelR` package I created for these analyses.
```{r setup, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE, cache = TRUE)
# Make sure necessary packages are installed
if("rio" %in% installed.packages()[,1] == FALSE){install.packages("rio")}
if("magrittr" %in% installed.packages()[,1] == FALSE){install.packages("tidyverse")}
if("ReputationModelR" %in% installed.packages()[,1] == FALSE){devtools::install_github("Coryc3133/ReputationModelR")}
library(rio)
library(tidyverse)
library(ReputationModelR)
study1 <- import("Data/rep_s1_4ms.csv")
study2 <- import("Data/rep_s2_4ms.csv") %>% 
  # missing condition are "", but need to be NA
  mutate(condition = ifelse(condition == "", NA, condition))
```

##  Calculate Scale Scores
Here I'll score the BFI into domain scores and the IRI into its subscales. I'll also produce coefficeint alphas and basic descriptives. 

I'm going to use the `scoreItems()` function from the `psych` package. This both reverse scores items and calculates scale scores. It also provide some information about the scores.

### Study 1 Data: Score Big Six Domains
* agreeableness     = 2, 7, 12R, 17R, 22R, 27, 32, 37R, 42R, 47R, 52, 57
* conscientiousness = 3R, 8R, 13, 18, 23R, 28R, 33, 38, 43, 48R, 53, 58R
* hp                = HP45r HP46r HP47r HP48r HP49r HP50 HP51 HP52
* neuroticism       = 4R, 9R, 14, 19, 24R, 29R, 34, 39, 44R, 49R, 54, 59
* extraversion      = 1, 6, 11R, 16R, 21, 26R, 31R, 36R, 41, 46, 51R, 56
* openness          = 5R, 10, 15, 20, 25R, 30R, 35, 40, 45R, 50R, 55R, 60

For now, first make the key:
```{r make_big6_keys}
# Make keys
big6_keys <- list(
                 agreeableness = c("bfi_2", "bfi_7", "-bfi_12", "-bfi_17", 
                                   "-bfi_22", "bfi_27", "bfi_32", "-bfi_37", 
                                   "-bfi_42", "-bfi_47", "bfi_52", "bfi_57"),
                 conscientiousness = c("-bfi_3", "-bfi_8", "bfi_13", "bfi_18", 
                                       "-bfi_23", "-bfi_28", "bfi_33", "bfi_38", 
                                       "bfi_43", "-bfi_48", "bfi_53", "-bfi_58"),
                 hp = c("-bfi_hp45", "-bfi_hp46", "-bfi_hp47", "-bfi_hp48", 
                            "-bfi_hp49", "bfi_hp50", "bfi_hp51", "bfi_hp52"),
                 neuroticism = c("-bfi_4", "-bfi_9", "bfi_14", "bfi_19", 
                                 "-bfi_24", "-bfi_29", "bfi_34", "bfi_39",
                                 "-bfi_44", "-bfi_49", "bfi_54", "bfi_59"),
                 extraversion = c("bfi_1", "bfi_6", "-bfi_11", "-bfi_16", 
                                  "bfi_21", "-bfi_26", "-bfi_31", "-bfi_36", 
                                  "bfi_41", "bfi_46", "-bfi_51", "bfi_56"),
                 openness = c("-bfi_5", "bfi_10", "bfi_15", "bfi_20", 
                              "-bfi_25", "-bfi_30", "bfi_35", "bfi_40", 
                              "-bfi_45", "-bfi_50", "-bfi_55", "bfi_60"))
```

Next, I'll score the Big Six. I'll turn the data into long format to make things a little easier, since it's the same scoring used for all of the Big Six ratings.
```{r score_big6}
# Lengthen Data
study1_big6_long <- 
study1 %>% 
  select(sess_id, contains("bfi")) %>% 
  gather(variable, rating, -sess_id) %>% 
  separate(variable, 
           c("perceiver", "target", "item"), 
           extra = "merge") %>% 
  spread(item, rating)

# Score long data and bind the scores to
# the end of the long data, then widen it back out
# and call it study1, replacing the raw data
study1 <- 
  psych::scoreItems(big6_keys, 
                    items = study1_big6_long, 
                    impute = "none") %>% 
  .[["scores"]] %>% 
  cbind(study1_big6_long, .) %>% 
  gather(variable, rating, -(1:3)) %>% 
  unite(variable, perceiver, target, variable) %>% 
  spread(variable, rating) %>% 
  select(sess_id,
         ends_with("agreeableness"),
         ends_with("conscientiousness"),
         ends_with("hp"),
         ends_with("neuroticism"),
         ends_with("extraversion"),
         ends_with("openness")) %>% 
  right_join(study1)
```

Finally, I'll get the coefficient alphas for each subscale. 

```{r alphas_big6}
library(kableExtra)

study1_big6_long %>% 
  mutate(rating_type = case_when(perceiver == target ~ "Self",
                               perceiver == "A" & target == "C" |
                                 perceiver == "C" & target == "A" ~ "P1",
                               perceiver == "B" & target == "C" |
                                 perceiver == "D" & target == "A" ~ "P2")) %>% 
  split(.$rating_type) %>% 
  map_df(~ psych::scoreItems(big6_keys,
                          items = .,
                          impute = "none") %>% pluck("alpha")) %>% 
  mutate(domain = names(big6_keys),
         domain = ifelse(domain == "hp", "honesty-propriety", domain)) %>% 
  gather(report, alpha, -domain) %>%
  mutate(report = fct_relevel(report, 
                              "Self",
                              "P1",
                              "P2")) %>% 
  select(report, domain, alpha) %>% 
  arrange(report) %>% 
  knitr::kable(digits = c(NA, NA, 2),
               caption = "Coefficient Alphas for Big Six Ratings Study 1",
               format = "html", escape = F) %>%
  kable_styling("striped", full_width = F)
  
```
### Study 1 Data: Calculate scale scores: IRI

* Empathic Concern = q2_emp, q4_empr, q9_emp, q14_empr, q18_empr, q20_emp, q22_emp

* Fantasy Scale = q1_fs, q5_fs, q7_fsr, q12_fsr, q16_fs, q23_fs, q26_fs

* Personal Distress = q6_pd, q10_pd, q13_pdr, q17_pd, q19_pdr, q24_pd, q27_pd

* Perspective Taking = q3_ptr, q8_pt, q11_pt, q15_ptr, q21_pt, q25_pt, q28_pt


Using the `scoreItems()` function from the psych package again. Then, Ill save out and cbind the scores to the data, and produce a table for the alphas. 

First make the key:
```{r make_keys_iri}
iri_keys <- list(
  iri_empathic = c("q2_emp", "-q4_emp", "q9_emp", "-q14_emp", "-q18_emp", "q20_emp", "q22_emp"),
  iri_fantasy = c("q1_fs", "q5_fs", "-q7_fs", "-q12_fs", "q16_fs", "q23_fs", "q26_fs"),
  iri_distress = c("q6_pd", "q10_pd", "-q13_pd", "q17_pd", "-q19_pd", "q24_pd", "q27_pd"),
  iri_perspective = c("-q3_pt", "q8_pt", "q11_pt", "-q15_pt", "q21_pt", "q25_pt", "q28_pt")
)
```

Next, I'll score the IRI. I'll turn the data into long format like above with the Big Six.
```{r score_iri}
# Lengthen Data
study1_iri_long <- 
study1 %>% 
  select(sess_id, starts_with("B_q"), starts_with("D_q")) %>% 
  gather(variable, rating, -sess_id) %>% 
  separate(variable, 
           c("perceiver", "item"), 
           extra = "merge") %>% 
  spread(item, rating)

# Score long data and bind the scores to
# the end of the long data, then widen it back out
# and call it study1, replacing the raw data
study1 <- 
  psych::scoreItems(iri_keys, 
                    items = study1_iri_long, 
                    impute = "none") %>% 
  .[["scores"]] %>% 
  cbind(study1_iri_long, .) %>% 
  gather(variable, rating, -(1:3)) %>% 
  unite(variable, perceiver, variable) %>% 
  spread(variable, rating) %>% 
  select(sess_id, contains("iri")) %>% 
  right_join(study1)
```

Finally, I'll get the coefficient alphas for each subscale. 

```{r alphas_iri}
library(kableExtra)

 psych::scoreItems(iri_keys, 
                    items = study1_iri_long, 
                    impute = "none") %>% 
  .[["alpha"]] %>% 
   as_tibble() %>% 
   gather(subscale, alpha) %>% 
   mutate(subscale =
            case_when(subscale == "iri_empathic" ~ "empathic concern",
                      subscale == "iri_fantasy" ~ "fantasy",
                      subscale == "iri_distress" ~ "distress tolerance",
                      subscale == "iri_perspective" ~ "perspective taking")) %>% 
  knitr::kable(digits = c(NA, 2),
               caption = "Coefficient Alphas for Perspective Taking Study 1",
               format = "html", escape = F) %>%
  kable_styling("striped", full_width = F)
  
```

### Study 2 Data: Score Big Six Domains
Same scoring & keys as Study 2. Basically just the dataframes are different, and the rest is the same.
```{r score_big6_s2}
# Lengthen Data
study2_big6_long <- 
study2 %>% 
  select(sess_id, contains("bfi")) %>% 
  gather(variable, rating, -sess_id) %>% 
  separate(variable, 
           c("perceiver", "target", "item"), 
           extra = "merge") %>% 
  spread(item, rating)

# Score long data and bind the scores to
# the end of the long data, then widen it back out
# and call it study2, replacing the raw data
study2 <- 
  psych::scoreItems(big6_keys, 
                    items = study2_big6_long, 
                    impute = "none") %>% 
  .[["scores"]] %>% 
  cbind(study2_big6_long, .) %>% 
  gather(variable, rating, -(1:3)) %>% 
  unite(variable, perceiver, target, variable) %>% 
  spread(variable, rating) %>% 
  select(sess_id,
         ends_with("agreeableness"),
         ends_with("conscientiousness"),
         ends_with("hp"),
         ends_with("neuroticism"),
         ends_with("extraversion"),
         ends_with("openness")) %>% 
  right_join(study2)
```

Finally, I'll get the coefficient alphas for each subscale. 

```{r alphas_big6_s2}
library(kableExtra)

study2_big6_long %>% 
  mutate(rating_type = case_when(perceiver == target ~ "Self",
                               perceiver == "A" & target == "C" |
                                 perceiver == "C" & target == "A" ~ "P1",
                               perceiver == "B" & target == "C" |
                                 perceiver == "D" & target == "A" ~ "P2")) %>% 
  split(.$rating_type) %>% 
  map_df(~ psych::scoreItems(big6_keys,
                          items = .,
                          impute = "none") %>% pluck("alpha")) %>% 
  mutate(domain = names(big6_keys),
         domain = ifelse(domain == "hp", "honesty-propriety", domain)) %>% 
  gather(report, alpha, -domain) %>%
  mutate(report = fct_relevel(report, 
                              "Self",
                              "P1",
                              "P2")) %>% 
  select(report, domain, alpha) %>% 
  arrange(report) %>% 
  knitr::kable(digits = c(NA, NA, 2),
               caption = "Coefficient Alphas for Big Six Ratings Study 2",
               format = "html", escape = F) %>%
  kable_styling("striped", full_width = F)
  
```

### Study 2 Data: Calculate scale scores: IRI
Same keys as before

Next, I'll score the IRI. I'll turn the data into long format like above with the Big Six.
```{r score_iri_s2}
# Lengthen Data
study2_iri_long <- 
study2 %>% 
  select(sess_id, starts_with("B_q"), starts_with("D_q")) %>% 
  gather(variable, rating, -sess_id) %>% 
  separate(variable, 
           c("perceiver", "item"), 
           extra = "merge") %>% 
  spread(item, rating)

# Score long data and bind the scores to
# the end of the long data, then widen it back out
# and call it study2, replacing the raw data
study2 <- 
  psych::scoreItems(iri_keys, 
                    items = study2_iri_long, 
                    impute = "none") %>% 
  .[["scores"]] %>% 
  cbind(study2_iri_long, .) %>% 
  gather(variable, rating, -(1:3)) %>% 
  unite(variable, perceiver, variable) %>% 
  spread(variable, rating) %>% 
  select(sess_id, contains("iri")) %>% 
  right_join(study2)
```

Finally, I'll get the coefficient alphas for each subscale. 

```{r alphas_iri_s2}
library(kableExtra)

 psych::scoreItems(iri_keys, 
                    items = study2_iri_long, 
                    impute = "none") %>% 
  .[["alpha"]] %>% 
   as_tibble() %>% 
   gather(subscale, alpha) %>% 
   mutate(subscale =
            case_when(subscale == "iri_empathic" ~ "empathic concern",
                      subscale == "iri_fantasy" ~ "fantasy",
                      subscale == "iri_distress" ~ "distress tolerance",
                      subscale == "iri_perspective" ~ "perspective taking")) %>% 
  knitr::kable(digits = c(NA, 2),
               caption = "Coefficient Alphas for Perspective Taking Study 2",
               format = "html", escape = F) %>%
  kable_styling("striped", full_width = F)
  
```

## Individual Difference Moderator Data Prep Study 1
Next up, prepping data for the individual difference moderators. These analyses require first mean-centering predictors and creating interaction terms, which the next chunk of code does. 
```{r prep_mod_data}
study1 <-
study1 %>%
  # First, mean center the predictors, 
  # since this is a continuous by continuous interaction.
  # We'll do this scale()
  mutate(
    # first, mean center P2 ratings for each domain
    B_C_extraversion_cent      = scale(B_C_extraversion, scale = FALSE),
    D_A_extraversion_cent      = scale(D_A_extraversion, scale = FALSE),
    B_C_agreeableness_cent     = scale(B_C_agreeableness, scale = FALSE),
    D_A_agreeableness_cent     = scale(D_A_agreeableness, scale = FALSE),
    B_C_conscientiousness_cent = scale(B_C_conscientiousness, scale = FALSE),
    D_A_conscientiousness_cent = scale(D_A_conscientiousness, scale = FALSE),
    B_C_neuroticism_cent       = scale(B_C_neuroticism, scale = FALSE),
    D_A_neuroticism_cent       = scale(D_A_neuroticism, scale = FALSE),
    B_C_openness_cent          = scale(B_C_openness, scale = FALSE),
    D_A_openness_cent          = scale(D_A_openness, scale = FALSE),
    B_C_hp_cent                = scale(B_C_hp, scale = FALSE),
    D_A_hp_cent                = scale(D_A_hp, scale = FALSE),
    # next, mean center empathy subscales (only have B and D for this)
    # this is a proposed moderator of consensus/accuracy
    B_iri_perspective_cent     = scale(B_iri_perspective, scale = FALSE),
    D_iri_perspective_cent     = scale(D_iri_perspective, scale = FALSE),
    B_iri_empathic_cent        = scale(B_iri_empathic, scale = FALSE),
    D_iri_empathic_cent        = scale(D_iri_empathic, scale = FALSE),
    B_iri_distress_cent        = scale(B_iri_distress, scale = FALSE),
    D_iri_distress_cent        = scale(D_iri_distress, scale = FALSE),
    B_iri_fantasy_cent         = scale(B_iri_fantasy, scale = FALSE),
    D_iri_fantasy_cent         = scale(D_iri_fantasy, scale = FALSE),
    # mean center self-reported extraversion
    # this is a proposed moderator of consensus/accuracy
    A_A_extraversion_cent      = scale(A_A_extraversion, scale = FALSE),
    C_C_extraversion_cent      = scale(C_C_extraversion, scale = FALSE),
    A_C_extraversion_cent      = scale(A_C_extraversion, scale = FALSE),
    C_A_extraversion_cent      = scale(C_A_extraversion, scale = FALSE),
    B_B_extraversion_cent      = scale(B_B_extraversion, scale = FALSE),
    D_D_extraversion_cent      = scale(D_D_extraversion, scale = FALSE)) %>% 
  # Next, create interaction terms
  mutate(
    # Extraversion moderators (for extraversion)
    extraXextra_AB = A_A_extraversion_cent*B_C_extraversion_cent,
    extraXextra_CD = C_C_extraversion_cent*D_A_extraversion_cent,
    extraXextra_BB = B_B_extraversion_cent*B_C_extraversion_cent,
    extraXextra_DD = D_D_extraversion_cent*D_A_extraversion_cent,
    extraXextra_CB = C_C_extraversion_cent*B_C_extraversion_cent,
    extraXextra_AD = A_A_extraversion_cent*D_A_extraversion_cent,
    # Extraversion moderators (for agreeableness)
    extraXagree_AB = A_A_extraversion_cent*B_C_agreeableness_cent,
    extraXagree_CD = C_C_extraversion_cent*D_A_agreeableness_cent,
    extraXagree_BB = B_B_extraversion_cent*B_C_agreeableness_cent,
    extraXagree_DD = D_D_extraversion_cent*D_A_agreeableness_cent,
    extraXagree_CB = C_C_extraversion_cent*B_C_agreeableness_cent,
    extraXagree_AD = A_A_extraversion_cent*D_A_agreeableness_cent,
    # Extraversion moderators (for conscientiousness)
    extraXconsc_AB = A_A_extraversion_cent*B_C_conscientiousness_cent,
    extraXconsc_CD = C_C_extraversion_cent*D_A_conscientiousness_cent,
    extraXconsc_BB = B_B_extraversion_cent*B_C_conscientiousness_cent,
    extraXconsc_DD = D_D_extraversion_cent*D_A_conscientiousness_cent,
    extraXconsc_CB = C_C_extraversion_cent*B_C_conscientiousness_cent,
    extraXconsc_AD = A_A_extraversion_cent*D_A_conscientiousness_cent,
    # Extraversion moderators (for Neuroticism)
    extraXneuro_AB = A_A_extraversion_cent*B_C_neuroticism_cent,
    extraXneuro_CD = C_C_extraversion_cent*D_A_neuroticism_cent,
    extraXneuro_BB = B_B_extraversion_cent*B_C_neuroticism_cent,
    extraXneuro_DD = D_D_extraversion_cent*D_A_neuroticism_cent,
    extraXneuro_CB = C_C_extraversion_cent*B_C_neuroticism_cent,
    extraXneuro_AD = A_A_extraversion_cent*D_A_neuroticism_cent,
    # Extraversion moderators (for Openness)
    extraXopen_AB = A_A_extraversion_cent*B_C_openness_cent,
    extraXopen_CD = C_C_extraversion_cent*D_A_openness_cent,
    extraXopen_BB = B_B_extraversion_cent*B_C_openness_cent,
    extraXopen_DD = D_D_extraversion_cent*D_A_openness_cent,
    extraXopen_CB = C_C_extraversion_cent*B_C_openness_cent,
    extraXopen_AD = A_A_extraversion_cent*D_A_openness_cent,
    # Extraversion moderators (for HP)
    extraXhp_AB = A_A_extraversion_cent*B_C_hp_cent,
    extraXhp_CD = C_C_extraversion_cent*D_A_hp_cent,
    extraXhp_BB = B_B_extraversion_cent*B_C_hp_cent,
    extraXhp_DD = D_D_extraversion_cent*D_A_hp_cent,
    extraXhp_CB = C_C_extraversion_cent*B_C_hp_cent,
    extraXhp_AD = A_A_extraversion_cent*D_A_hp_cent,
    # perspective taking moderators (for extraversion)
    PTxE_B = B_iri_perspective_cent*B_C_extraversion_cent,
    PTxE_D = D_iri_perspective_cent*D_A_extraversion_cent,
    # perspective taking moderators (for agreeableness)
    PTxA_B = B_iri_perspective_cent*B_C_agreeableness_cent,
    PTxA_D = D_iri_perspective_cent*D_A_agreeableness_cent,
    # perspective taking moderators (for conscientiousness)
    PTxC_B = B_iri_perspective_cent*B_C_conscientiousness_cent,
    PTxC_D = D_iri_perspective_cent*D_A_conscientiousness_cent,
    # perspective taking moderators (for neuroticism)
    PTxN_B = B_iri_perspective_cent*B_C_neuroticism_cent,
    PTxN_D = D_iri_perspective_cent*D_A_neuroticism_cent,
    # perspective taking moderators (for openness)
    PTxO_B = B_iri_perspective_cent*B_C_openness_cent,
    PTxO_D = D_iri_perspective_cent*D_A_openness_cent,
    # perspective taking moderators (for hp)
    PTxHP_B = B_iri_perspective_cent*B_C_hp_cent,
    PTxHP_D = D_iri_perspective_cent*D_A_hp_cent,
    # empathic concern moderators (for extraversion)
    empxE_B = B_iri_empathic_cent*B_C_extraversion_cent,
    empxE_D = D_iri_empathic_cent*D_A_extraversion_cent,
    # empathic concern moderators (for agreeableness)
    empxA_B = B_iri_empathic_cent*B_C_agreeableness_cent,
    empxA_D = D_iri_empathic_cent*D_A_agreeableness_cent,
    # empathic concern moderators (for conscientiousness)
    empxC_B = B_iri_empathic_cent*B_C_conscientiousness_cent,
    empxC_D = D_iri_empathic_cent*D_A_conscientiousness_cent,
    # empathic concern moderators (for neuroticism)
    empxN_B = B_iri_empathic_cent*B_C_neuroticism_cent,
    empxN_D = D_iri_empathic_cent*D_A_neuroticism_cent,
    # empathic concern moderators (for openness)
    empxO_B = B_iri_empathic_cent*B_C_openness_cent,
    empxO_D = D_iri_empathic_cent*D_A_openness_cent,
    # empathic concern moderators (for hp)
    empxHP_B = B_iri_empathic_cent*B_C_hp_cent,
    empxHP_D = D_iri_empathic_cent*D_A_hp_cent,
    # personal distress moderators (for extraversion)
    disxE_B = B_iri_distress_cent*B_C_extraversion_cent,
    disxE_D = D_iri_distress_cent*D_A_extraversion_cent,
    # personal distress moderators (for agreeableness)
    disxA_B = B_iri_distress_cent*B_C_agreeableness_cent,
    disxA_D = D_iri_distress_cent*D_A_agreeableness_cent,
    # personal distress moderators (for conscientiousness)
    disxC_B = B_iri_distress_cent*B_C_conscientiousness_cent,
    disxC_D = D_iri_distress_cent*D_A_conscientiousness_cent,
    # personal distress moderators (for neuroticism)
    disxN_B = B_iri_distress_cent*B_C_neuroticism_cent,
    disxN_D = D_iri_distress_cent*D_A_neuroticism_cent,
    # personal distress moderators (for openness)
    disxO_B = B_iri_distress_cent*B_C_openness_cent,
    disxO_D = D_iri_distress_cent*D_A_openness_cent,
    # personal distress moderators (for hp)
    disxHP_B = B_iri_distress_cent*B_C_hp_cent,
    disxHP_D = D_iri_distress_cent*D_A_hp_cent,
    # fantasy moderators (for extraversion)
    fantxE_B = B_iri_fantasy_cent*B_C_extraversion_cent,
    fantxE_D = D_iri_fantasy_cent*D_A_extraversion_cent,
    # fantasy moderators (for agreeableness)
    fantxA_B = B_iri_fantasy_cent*B_C_agreeableness_cent,
    fantxA_D = D_iri_fantasy_cent*D_A_agreeableness_cent,
    # fantasy moderators (for conscientiousness)
    fantxC_B = B_iri_fantasy_cent*B_C_conscientiousness_cent,
    fantxC_D = D_iri_fantasy_cent*D_A_conscientiousness_cent,
    # fantasy moderators (for neuroticism)
    fantxN_B = B_iri_fantasy_cent*B_C_neuroticism_cent,
    fantxN_D = D_iri_fantasy_cent*D_A_neuroticism_cent,
    # fantasy moderators (for openness)
    fantxO_B = B_iri_fantasy_cent*B_C_openness_cent,
    fantxO_D = D_iri_fantasy_cent*D_A_openness_cent,
    # fantasy moderators (for hp)
    fantxHP_B = B_iri_fantasy_cent*B_C_hp_cent,
    fantxHP_D = D_iri_fantasy_cent*D_A_hp_cent)
```

## Individual Difference Moderator Data Prep in Study 2  
Next, prep for the individual difference moderators for Study 2, same as Study 1. 
```{r prep_mod_data_s2}
study2 <-
study2 %>%
  # First, mean center the predictors, 
  # since this is a continuous by continuous interaction.
  # We'll do this scale()
  mutate(
    # first, mean center P2 ratings for each domain
    B_C_extraversion_cent      = scale(B_C_extraversion, scale = FALSE),
    D_A_extraversion_cent      = scale(D_A_extraversion, scale = FALSE),
    B_C_agreeableness_cent     = scale(B_C_agreeableness, scale = FALSE),
    D_A_agreeableness_cent     = scale(D_A_agreeableness, scale = FALSE),
    B_C_conscientiousness_cent = scale(B_C_conscientiousness, scale = FALSE),
    D_A_conscientiousness_cent = scale(D_A_conscientiousness, scale = FALSE),
    B_C_neuroticism_cent       = scale(B_C_neuroticism, scale = FALSE),
    D_A_neuroticism_cent       = scale(D_A_neuroticism, scale = FALSE),
    B_C_openness_cent          = scale(B_C_openness, scale = FALSE),
    D_A_openness_cent          = scale(D_A_openness, scale = FALSE),
    B_C_hp_cent                = scale(B_C_hp, scale = FALSE),
    D_A_hp_cent                = scale(D_A_hp, scale = FALSE),
    # next, mean center empathy subscales (only have B and D for this)
    # this is a proposed moderator of consensus/accuracy
    B_iri_perspective_cent     = scale(B_iri_perspective, scale = FALSE),
    D_iri_perspective_cent     = scale(D_iri_perspective, scale = FALSE),
    B_iri_empathic_cent        = scale(B_iri_empathic, scale = FALSE),
    D_iri_empathic_cent        = scale(D_iri_empathic, scale = FALSE),
    B_iri_distress_cent        = scale(B_iri_distress, scale = FALSE),
    D_iri_distress_cent        = scale(D_iri_distress, scale = FALSE),
    B_iri_fantasy_cent         = scale(B_iri_fantasy, scale = FALSE),
    D_iri_fantasy_cent         = scale(D_iri_fantasy, scale = FALSE),
    # mean center self-reported extraversion
    # this is a proposed moderator of consensus/accuracy
    A_A_extraversion_cent      = scale(A_A_extraversion, scale = FALSE),
    C_C_extraversion_cent      = scale(C_C_extraversion, scale = FALSE),
    A_C_extraversion_cent      = scale(A_C_extraversion, scale = FALSE),
    C_A_extraversion_cent      = scale(C_A_extraversion, scale = FALSE),
    B_B_extraversion_cent      = scale(B_B_extraversion, scale = FALSE),
    D_D_extraversion_cent      = scale(D_D_extraversion, scale = FALSE)) %>% 
  # Next, create interaction terms
  mutate(
    # Extraversion moderators (for extraversion)
    extraXextra_AB = A_A_extraversion_cent*B_C_extraversion_cent,
    extraXextra_CD = C_C_extraversion_cent*D_A_extraversion_cent,
    extraXextra_BB = B_B_extraversion_cent*B_C_extraversion_cent,
    extraXextra_DD = D_D_extraversion_cent*D_A_extraversion_cent,
    extraXextra_CB = C_C_extraversion_cent*B_C_extraversion_cent,
    extraXextra_AD = A_A_extraversion_cent*D_A_extraversion_cent,
    # Extraversion moderators (for agreeableness)
    extraXagree_AB = A_A_extraversion_cent*B_C_agreeableness_cent,
    extraXagree_CD = C_C_extraversion_cent*D_A_agreeableness_cent,
    extraXagree_BB = B_B_extraversion_cent*B_C_agreeableness_cent,
    extraXagree_DD = D_D_extraversion_cent*D_A_agreeableness_cent,
    extraXagree_CB = C_C_extraversion_cent*B_C_agreeableness_cent,
    extraXagree_AD = A_A_extraversion_cent*D_A_agreeableness_cent,
    # Extraversion moderators (for conscientiousness)
    extraXconsc_AB = A_A_extraversion_cent*B_C_conscientiousness_cent,
    extraXconsc_CD = C_C_extraversion_cent*D_A_conscientiousness_cent,
    extraXconsc_BB = B_B_extraversion_cent*B_C_conscientiousness_cent,
    extraXconsc_DD = D_D_extraversion_cent*D_A_conscientiousness_cent,
    extraXconsc_CB = C_C_extraversion_cent*B_C_conscientiousness_cent,
    extraXconsc_AD = A_A_extraversion_cent*D_A_conscientiousness_cent,
    # Extraversion moderators (for Neuroticism)
    extraXneuro_AB = A_A_extraversion_cent*B_C_neuroticism_cent,
    extraXneuro_CD = C_C_extraversion_cent*D_A_neuroticism_cent,
    extraXneuro_BB = B_B_extraversion_cent*B_C_neuroticism_cent,
    extraXneuro_DD = D_D_extraversion_cent*D_A_neuroticism_cent,
    extraXneuro_CB = C_C_extraversion_cent*B_C_neuroticism_cent,
    extraXneuro_AD = A_A_extraversion_cent*D_A_neuroticism_cent,
    # Extraversion moderators (for Openness)
    extraXopen_AB = A_A_extraversion_cent*B_C_openness_cent,
    extraXopen_CD = C_C_extraversion_cent*D_A_openness_cent,
    extraXopen_BB = B_B_extraversion_cent*B_C_openness_cent,
    extraXopen_DD = D_D_extraversion_cent*D_A_openness_cent,
    extraXopen_CB = C_C_extraversion_cent*B_C_openness_cent,
    extraXopen_AD = A_A_extraversion_cent*D_A_openness_cent,
    # Extraversion moderators (for HP)
    extraXhp_AB = A_A_extraversion_cent*B_C_hp_cent,
    extraXhp_CD = C_C_extraversion_cent*D_A_hp_cent,
    extraXhp_BB = B_B_extraversion_cent*B_C_hp_cent,
    extraXhp_DD = D_D_extraversion_cent*D_A_hp_cent,
    extraXhp_CB = C_C_extraversion_cent*B_C_hp_cent,
    extraXhp_AD = A_A_extraversion_cent*D_A_hp_cent,
    # perspective taking moderators (for extraversion)
    PTxE_B = B_iri_perspective_cent*B_C_extraversion_cent,
    PTxE_D = D_iri_perspective_cent*D_A_extraversion_cent,
    # perspective taking moderators (for agreeableness)
    PTxA_B = B_iri_perspective_cent*B_C_agreeableness_cent,
    PTxA_D = D_iri_perspective_cent*D_A_agreeableness_cent,
    # perspective taking moderators (for conscientiousness)
    PTxC_B = B_iri_perspective_cent*B_C_conscientiousness_cent,
    PTxC_D = D_iri_perspective_cent*D_A_conscientiousness_cent,
    # perspective taking moderators (for neuroticism)
    PTxN_B = B_iri_perspective_cent*B_C_neuroticism_cent,
    PTxN_D = D_iri_perspective_cent*D_A_neuroticism_cent,
    # perspective taking moderators (for openness)
    PTxO_B = B_iri_perspective_cent*B_C_openness_cent,
    PTxO_D = D_iri_perspective_cent*D_A_openness_cent,
    # perspective taking moderators (for hp)
    PTxHP_B = B_iri_perspective_cent*B_C_hp_cent,
    PTxHP_D = D_iri_perspective_cent*D_A_hp_cent,
    # empathic concern moderators (for extraversion)
    empxE_B = B_iri_empathic_cent*B_C_extraversion_cent,
    empxE_D = D_iri_empathic_cent*D_A_extraversion_cent,
    # empathic concern moderators (for agreeableness)
    empxA_B = B_iri_empathic_cent*B_C_agreeableness_cent,
    empxA_D = D_iri_empathic_cent*D_A_agreeableness_cent,
    # empathic concern moderators (for conscientiousness)
    empxC_B = B_iri_empathic_cent*B_C_conscientiousness_cent,
    empxC_D = D_iri_empathic_cent*D_A_conscientiousness_cent,
    # empathic concern moderators (for neuroticism)
    empxN_B = B_iri_empathic_cent*B_C_neuroticism_cent,
    empxN_D = D_iri_empathic_cent*D_A_neuroticism_cent,
    # empathic concern moderators (for openness)
    empxO_B = B_iri_empathic_cent*B_C_openness_cent,
    empxO_D = D_iri_empathic_cent*D_A_openness_cent,
    # empathic concern moderators (for hp)
    empxHP_B = B_iri_empathic_cent*B_C_hp_cent,
    empxHP_D = D_iri_empathic_cent*D_A_hp_cent,
    # personal distress moderators (for extraversion)
    disxE_B = B_iri_distress_cent*B_C_extraversion_cent,
    disxE_D = D_iri_distress_cent*D_A_extraversion_cent,
    # personal distress moderators (for agreeableness)
    disxA_B = B_iri_distress_cent*B_C_agreeableness_cent,
    disxA_D = D_iri_distress_cent*D_A_agreeableness_cent,
    # personal distress moderators (for conscientiousness)
    disxC_B = B_iri_distress_cent*B_C_conscientiousness_cent,
    disxC_D = D_iri_distress_cent*D_A_conscientiousness_cent,
    # personal distress moderators (for neuroticism)
    disxN_B = B_iri_distress_cent*B_C_neuroticism_cent,
    disxN_D = D_iri_distress_cent*D_A_neuroticism_cent,
    # personal distress moderators (for openness)
    disxO_B = B_iri_distress_cent*B_C_openness_cent,
    disxO_D = D_iri_distress_cent*D_A_openness_cent,
    # personal distress moderators (for hp)
    disxHP_B = B_iri_distress_cent*B_C_hp_cent,
    disxHP_D = D_iri_distress_cent*D_A_hp_cent,
    # fantasy moderators (for extraversion)
    fantxE_B = B_iri_fantasy_cent*B_C_extraversion_cent,
    fantxE_D = D_iri_fantasy_cent*D_A_extraversion_cent,
    # fantasy moderators (for agreeableness)
    fantxA_B = B_iri_fantasy_cent*B_C_agreeableness_cent,
    fantxA_D = D_iri_fantasy_cent*D_A_agreeableness_cent,
    # fantasy moderators (for conscientiousness)
    fantxC_B = B_iri_fantasy_cent*B_C_conscientiousness_cent,
    fantxC_D = D_iri_fantasy_cent*D_A_conscientiousness_cent,
    # fantasy moderators (for neuroticism)
    fantxN_B = B_iri_fantasy_cent*B_C_neuroticism_cent,
    fantxN_D = D_iri_fantasy_cent*D_A_neuroticism_cent,
    # fantasy moderators (for openness)
    fantxO_B = B_iri_fantasy_cent*B_C_openness_cent,
    fantxO_D = D_iri_fantasy_cent*D_A_openness_cent,
    # fantasy moderators (for hp)
    fantxHP_B = B_iri_fantasy_cent*B_C_hp_cent,
    fantxHP_D = D_iri_fantasy_cent*D_A_hp_cent)
```

## Combine Data for Integrated Analyses

Last (general)
```{r combine_data}
study1 <- mutate(study1, study = "study 1")
study2 <- mutate(study2, study = "study 2")
integrated <- study2 %>% 
  # Remove STudy
  .[, colnames(.) %in% colnames(study1)] %>% 
  rbind(study1) %>% 
  select(study, sess_id, everything()) %>% 
  arrange(study)
```

# Study 1

I'll start with Study 1. First I'll fit all of the main models, which will estimate relative elevation and differential hearsay consensus, differential hearsay accuracy, and differential direct accuracy. Then, to match the order of the manuscript, I'll display the relative elevation results followed by the differential results. This will be followed by the regression analyses; distinctive hearsay accuracy and the moderator analyses, which each require regressions (instead of working with the variance-covariance & mean structure created in the main models).

Study 2 will look similar, but will start with the condition analyses, then the mediation models. The integrated results will be in a similar order to the Study 1 results.


## Fit Models

For each of the Big Six, I'll estimate the full variance-covariance and mean structure with appropriate equality constraints using the `ReputationModelR` `rep_analyses_auto()` function I wrote. I'll save the relative elevation and differential tables to put together later, and display the summary of the model object.
### Agreeableness
```{r agree_model_fit}
agree_model <- rep_analyses_auto(study1, 
                  p1_reports =  c("A_C_agreeableness", "C_A_agreeableness"),
                  p2_reports =  c("B_C_agreeableness", "D_A_agreeableness"),
                  target_self = c("C_C_agreeableness", "A_A_agreeableness"))
agree_elevation <- ez_elevation_table(agree_model)
agree_differential <- ez_differential_table(agree_model)
summary(agree_model, standardized = TRUE)
```

### Conscientiousness
```{r consc_model_fit}
consc_model <- rep_analyses_auto(study1, 
                  p1_reports =  c("A_C_conscientiousness", "C_A_conscientiousness"),
                  p2_reports =  c("B_C_conscientiousness", "D_A_conscientiousness"),
                  target_self = c("C_C_conscientiousness", "A_A_conscientiousness"))
consc_elevation <- ez_elevation_table(consc_model)
consc_differential <- ez_differential_table(consc_model)
summary(consc_model, standardized = TRUE)
```

### Honesty-Propriety
```{r hp_model_fit}
hp_model <- rep_analyses_auto(study1, 
                  p1_reports =  c("A_C_hp", "C_A_hp"),
                  p2_reports =  c("B_C_hp", "D_A_hp"),
                  target_self = c("C_C_hp", "A_A_hp"))
hp_elevation <- ez_elevation_table(hp_model)
hp_differential <- ez_differential_table(hp_model)
summary(hp_model, standardized = TRUE)
```

### Neuroticism
```{r neuro_model_fit}
neuro_model <- rep_analyses_auto(study1, 
                  p1_reports =  c("A_C_neuroticism", "C_A_neuroticism"),
                  p2_reports =  c("B_C_neuroticism", "D_A_neuroticism"),
                  target_self = c("C_C_neuroticism", "A_A_neuroticism"))
neuro_elevation <- ez_elevation_table(neuro_model)
neuro_differential <- ez_differential_table(neuro_model)
summary(neuro_model, standardized = TRUE)
```

### Extraversion
```{r extra_model_fit}
extra_model <- rep_analyses_auto(study1, 
                  p1_reports =  c("A_C_extraversion", "C_A_extraversion"),
                  p2_reports =  c("B_C_extraversion", "D_A_extraversion"),
                  target_self = c("C_C_extraversion", "A_A_extraversion"))
extra_elevation <- ez_elevation_table(extra_model)
extra_differential <- ez_differential_table(extra_model)
summary(extra_model, standardized = TRUE)
```

### Openness
```{r open_model_fit}
open_model <- rep_analyses_auto(study1, 
                  p1_reports =  c("A_C_openness", "C_A_openness"),
                  p2_reports =  c("B_C_openness", "D_A_openness"),
                  target_self = c("C_C_openness", "A_A_openness"))
open_elevation <- ez_elevation_table(open_model)
open_differential <- ez_differential_table(open_model)
summary(open_model, standardized = TRUE)
```

## Relative Elevation
### Elevation Results

And here is a table of the relative elevation results, similar to Table 1 in the manuscript.
```{r rel_el_tbl}
mutate(agree_elevation$elevation_table,
       domain = "Agreeableness") %>% 
  rbind(mutate(consc_elevation$elevation_table,
               domain = "Conscientiousness")) %>% 
  rbind(mutate(hp_elevation$elevation_table,
               domain = "Honesty-Propriety")) %>% 
  rbind(mutate(neuro_elevation$elevation_table,
               domain = "Neuroticism")) %>% 
  rbind(mutate(extra_elevation$elevation_table,
               domain = "Extraversion")) %>% 
  rbind(mutate(open_elevation$elevation_table,
               domain = "Openness")) %>% 
  select(parameter, domain, everything()) %>% 
  mutate(parameter = factor(parameter, levels = c("P1-P2 Relative Elevation",
                                                  "Self-P2 Relative Elevation",
                                                  "Self-P1 Relative Elevation"))) %>% 
  arrange(parameter) %>% 
  mutate(pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 4, side = "right", pad ="0"),  
                         "< .001"),
         raw_diff = round(raw_diff, 2),
         raw_diff = ifelse(str_detect(raw_diff, "\\..$"), paste0(raw_diff, "0"), 
                    ifelse(str_detect(raw_diff, "^0$"), paste0(raw_diff, ".00"), raw_diff)),
         raw_diff = cell_spec(raw_diff, "html", 
                              color = ifelse(raw_diff < 0, "red", "blue"),
                               bold = ifelse(abs(z) >= 1.96, TRUE, FALSE)),
         ci_upper = round(ci_upper, 2),
         ci_upper = ifelse(str_detect(ci_upper, "\\..$"), paste0(ci_upper, "0"), 
                    ifelse(str_detect(ci_upper, "^0$"), paste0(ci_upper, ".00"), ci_upper)),
         ci_upper = cell_spec(ci_upper, "html", 
                              color = ifelse(ci_upper < 0, "red", "blue"),
                              bold = ifelse(abs(z) >= 1.96, TRUE, FALSE)),
         ci_lower = round(ci_lower, 2),
         ci_lower = ifelse(str_detect(ci_lower, "\\..$"), paste0(ci_lower, "0"), 
                    ifelse(str_detect(ci_lower, "^0$"), paste0(ci_lower, ".00"), ci_lower)),
         ci_lower = cell_spec(ci_lower, "html", 
                              color = ifelse(ci_lower < 0, "red", "blue"),
                              bold = ifelse(abs(z) >= 1.96, TRUE, FALSE)),
         cohen_d = round(cohen_d, 2),
         cohen_d = ifelse(str_detect(cohen_d, "\\..$"), paste0(cohen_d, "0"), 
                    ifelse(str_detect(cohen_d, "^0$"), paste0(cohen_d, ".00"), cohen_d)),
         cohen_d = cell_spec(cohen_d, "html", 
                             color = ifelse(cohen_d < 0, "red", "blue"),
                             bold = ifelse(abs(z) >= 1.96, TRUE, FALSE)),
         z = round(z, 2)) %>% 
  knitr::kable(caption = "Study 1 Relative Elevation Results",
               format = "html", escape = F) %>%
  kable_styling("striped", full_width = F) %>% 
  footnote(general = "Blue = Positive Difference; Red = Negative Difference; bold = p < .05")

```

### Means & SDs
And here is a table of pooled means and standard deviations for ratings, similar to Supplemental Table S3.
```{r pooled_m_sd_tbl}
mutate(agree_elevation$pooled_means_sd,
       domain = "Agreeableness") %>% 
  rbind(mutate(consc_elevation$pooled_means_sd,
               domain = "Conscientiousness")) %>% 
  rbind(mutate(hp_elevation$pooled_means_sd,
               domain = "Honesty-Propriety")) %>% 
  rbind(mutate(neuro_elevation$pooled_means_sd,
               domain = "Neuroticism")) %>% 
  rbind(mutate(extra_elevation$pooled_means_sd,
               domain = "Extraversion")) %>% 
  rbind(mutate(open_elevation$pooled_means_sd,
               domain = "Openness")) %>% 
  # reordering the variables
  select(domain, perceiver, target, mean, sd) %>% 
  unite(rating, perceiver, target, sep = " (") %>% 
  mutate(rating = str_c(rating, ")"),
         rating = str_to_upper(rating),
         mean = round(mean, 2),
         mean = str_pad(mean, width = 4, side = "right", pad = 0),
         sd = round(sd, 2),
         sd = str_pad(sd, width = 4, side = "right", pad = 0),
         domain = fct_relevel(domain, 
                              "Agreeableness",
                              "Conscientiousness",
                              "Honesty-Propriety",
                              "Neuroticism",
                              "Extraversion",
                              "Openness")) %>% 
  unite(value, mean, sd, sep = " (") %>% 
  mutate(value = paste0(value, ")")) %>% 
  rename(`M (SD)` = value) %>% 
  spread(rating, `M (SD)`) %>% 
  select(domain, `T (T)`, everything()) %>% 
  rename(`M (SD)` = `P1 (T)`,
         `M (SD)` = `P2 (T)`,
         `M (SD)` = `T (T)`) %>% 
  knitr::kable(caption = "Study 1 Pooled Means & SDs",
               format = "html", escape = F) %>%
  kable_styling("striped", full_width = F) %>%
  add_header_above(c(" " = 1, "T (T)" = 1, "P1(T)" = 1, "P2 (T)" = 1)) %>% 
  footnote("T(T) = the target’s self-report. P1(T) = P1’s rating of the target. P2(T) = P2’s rating of the target.")

```

## Differential Hearsay Consensus, Accuracy, and Direct Accuracy

First, I'll display the differential hearsay consensus, accuracy, and direct accuracy results as a Table. This is not in the MS.
```{r diff_results_tbl}
diff_results_s1 <- mutate(agree_differential,
       domain = "Agreeableness") %>% 
  rbind(mutate(consc_differential,
               domain = "Conscientiousness")) %>% 
  rbind(mutate(hp_differential,
               domain = "Honesty-Propriety")) %>% 
  rbind(mutate(neuro_differential,
               domain = "Neuroticism")) %>% 
  rbind(mutate(extra_differential,
               domain = "Extraversion")) %>% 
  rbind(mutate(open_differential,
               domain = "Openness")) %>% 
  select(parameter, domain, everything()) %>% 
  mutate(parameter = str_to_title(parameter), 
         parameter = factor(parameter, levels = c("Hearsay Consensus",
                                                  "Hearsay Accuracy",
                                                  "Direct Accuracy"))) %>% 
  arrange(parameter) %>% 
  mutate(pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 4, side = "right", pad ="0"),  
                         "< .001"))

diff_results_s1 %>% 
  mutate(r = round(r, 2),
         r = ifelse(str_detect(r, "\\..$"), paste0(r, "0"), 
                    ifelse(str_detect(r, "^0$"), paste0(r, ".00"), r)),
         r = cell_spec(r, "html", 
                             bold = ifelse(ci_lower > 0, TRUE, FALSE)),
         ci_lower = round(ci_lower, 2),
         ci_lower = ifelse(str_detect(ci_lower, "\\..$"), paste0(ci_lower, "0"), 
                    ifelse(str_detect(ci_lower, "^0$"), paste0(ci_lower, ".00"), ci_lower)),
         ci_lower = cell_spec(ci_lower, "html", 
                             bold = ifelse(ci_lower > 0, TRUE, FALSE)),
         ci_upper = round(ci_upper, 2),
         ci_upper = ifelse(str_detect(ci_upper, "\\..$"), paste0(ci_upper, "0"), 
                    ifelse(str_detect(ci_upper, "^0$"), paste0(ci_upper, ".00"), ci_upper)),
         ci_upper = cell_spec(ci_upper, "html",
                             bold = ifelse(pvalue == "< .001", TRUE,
                                    ifelse(as.numeric(pvalue) < .05, TRUE, FALSE)))) %>% 
  knitr::kable(caption = "Study 1 Differential Consensus & Accuracy Results",
              format = "html", escape = F) %>% 
  kable_styling("striped", full_width = F) 
```

Next, I'll create the plots shown in the Manuscript (Figures 3, 4, & Supplemental Figure S1). First, I'll prep the plot data by entering in the meta-analytic estimates from Connelly & Ones (2010) used as benchmarks in this study, merging that into the differential results data, and doing a little clean up to prepare for the plots.
```{r diff_results_plot_data}
diff_plot_data <- as_tibble(cbind(
  domain = c("Agreeableness",
             "Conscientiousness",
             "Honesty-Propriety",
             "Neuroticism",
             "Extraversion",
             "Openness"),
  # Connelly & Ones (2010) inter-rater r
  co2010_irr = c(.31, .35, NA, .32, .50, .29),
  # Connelly & Ones (2010) self-other agreement
  co2010_soa_1 = c(.09, .13, NA, .08, .22, .12),
  # Connelly & Ones (2010) self-other agreement again
  # since we'll use it for direct and hearsay accuracy
  co2010_soa_2 = c(.09, .13, NA, .08, .22, .12))) %>% 
  gather(source, r, -domain) %>% 
  mutate(parameter = 
           case_when(source == "co2010_irr" ~ "Hearsay Consensus",
                     source == "co2010_soa_1" ~ "Hearsay Accuracy",
                     source == "co2010_soa_2" ~ "Direct Accuracy"),
         source = str_replace_all(source, 
                                  "co2010_irr", 
                                  "Connelly & Ones (2010) Study 1"),
         source = str_replace_all(source, 
                                  "co2010_soa_1", 
                                  "Connelly & Ones (2010) Study 2"),
         source = str_replace_all(source, 
                                  "co2010_soa_2", 
                                  "Connelly & Ones (2010) Study 2"),
         r = as.double(r),
         # To make plotting easier, I'm going to make two
         # variables ci.lower and ci.upper (to match the structure of our estimates)
         # and I'll make them equal to the point estimate (since that is all we have for
         # uncorrected estimates).
         ci_lower = r,
         ci_upper = r) %>% 
  full_join(mutate(diff_results_s1,
                   parameter = str_to_title(parameter),
                   source = parameter)) %>% 
  # Re-level to have plots in the order we want them in
  mutate(domain = fct_relevel(factor(domain),
                              "Openness",
                              "Extraversion",
                              "Neuroticism",
                              "Honesty-Propriety",
                              "Conscientiousness",
                              "Agreeableness"))
```

Next, I'll set the theme I use in the manuscript.
```{r plot_theme}
# Custom theme for the reputation manuscript
theme_rep_manuscript <-  theme(panel.background = element_blank(),
                         panel.grid.major.x = element_line(size=.4, color="gray90"))+
  theme(axis.line.x = element_line(color="black", size = 1),
        axis.line.y = element_line(color="black", size = 1))+
  theme(axis.title = element_text(size = rel(1), color="black"), 
        axis.text = element_text(size = rel(1), color="black"))+
  theme(plot.title= element_text(size=rel(1), hjust = .5))

```



Finally, this writes out thed individual plots (Figure 3, 4, and S1) to a folder called 'plots' in the current directory. I'll also make a 3-panelled plot, which contains Figures 3, 4, and S1 all in one plot for the markdown.
```{r making_plots4MS_and_ppt, fig.height=11, fig.width=12}
plot_names <- c(1:3)
i <- 1
for (each in unique(diff_plot_data$parameter)){
  i <- i + 1
  plot_name <- paste("plot", i, sep = "_")
  plot_names[i] <- plot_name
  plot_data <- filter(diff_plot_data, parameter == each)
  assign(plot_name, ggplot(data = plot_data, 
                 aes(x = domain, y = r, shape = source)) + 
  geom_pointrange(aes(ymin = ci_lower, ymax = ci_upper),
                  position = position_dodge(width = .4),
                  size = 1) + 
  labs(title = NULL,
       x = NULL,
       y = "r") +
  theme_rep_manuscript +
  geom_hline(yintercept = 0, linetype = 2, alpha = .5) + 
    scale_y_continuous(limit=c(-0.3, .80))+
  coord_flip()+
  guides(shape=guide_legend(reverse=TRUE)))
  ggsave(paste0("Plots/Study1_", print(each), ".png"), get(plot_name),
         device = "png", height = 5, width = 9.5)
  ggsave(paste0("Plots/Study1_", print(each), "_4ppt.png"), get(plot_name),
         device = "png", height = 5, width = 9.5, scale = .80)
}

plot_names <- plot_names[str_detect(plot_names, "^plot")]
cowplot::plot_grid(get(plot_names[1]), get(plot_names[2]),
                   get(plot_names[3]), nrow = 3)
```

## Distinctive Hearsay Accuracy

### Agreeableness
The model and results for distinctive hearsay accuracy of Agreeableness. 

#### Full Model
```{r distinctive_ha_agreeableness}
# specify the model
agreeableness_distinctive_hearsay_accuracy <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_agreeableness ~ DHA*B_C_agreeableness + DDA*A_C_agreeableness
A_A_agreeableness ~ DHA*D_A_agreeableness + DDA*C_A_agreeableness

# hearsay consensus
B_C_agreeableness ~~ HC*A_C_agreeableness
D_A_agreeableness ~~ HC*C_A_agreeableness

# variances (pooled)
C_C_agreeableness ~~ v_self*C_C_agreeableness
A_A_agreeableness ~~ v_self*A_A_agreeableness
A_C_agreeableness ~~ v_P1*A_C_agreeableness
C_A_agreeableness ~~ v_P1*C_A_agreeableness
B_C_agreeableness ~~ v_P2*B_C_agreeableness
D_A_agreeableness ~~ v_P2*D_A_agreeableness

# intercepts (pooled)
C_C_agreeableness ~ int_self*1
A_A_agreeableness ~ int_self*1
B_C_agreeableness ~ int_P1*1
D_A_agreeableness ~ int_P1*1
A_C_agreeableness ~ int_P2*1
C_A_agreeableness ~ int_P2*1
'
# fit the model
fit_agreeableness_distinctive_hearsay_accuracy <- 
  sem(agreeableness_distinctive_hearsay_accuracy,
      data = study1, 
      # missing = FIML critical due to planned missingness
      missing="FIML")

# display results
summary(fit_agreeableness_distinctive_hearsay_accuracy, 
        # include standardized estimates
        standardized=TRUE)
```

#### Table of Results

Now get a table of the three main results we want:

* Distinctive Hearsay Accuracy
* Distinctive Direct Accuracy
* Hearsay Consensus

```{r table_ha_agreeableness}
agree_ha_table <- fit_agreeableness_distinctive_hearsay_accuracy@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs) %>% 
  left_join(standardizedsolution(fit_agreeableness_distinctive_hearsay_accuracy)) %>% 
  filter(label == "DHA" |
         label == "DDA" |
         label == "HC") %>%
  filter(duplicated(.[["label"]])) %>% 
  mutate(
    label = str_replace_all(label, "DHA", "Distinctive Hearsay Accuracy"),
    label = str_replace_all(label, "DDA", "Distinctive Direct Accuracy"),
    label = str_replace_all(label, "HC", "Hearsay Consensus")) %>%
  select(label, est.std, ci.lower, ci.upper, pvalue)
```

### Conscientiousness
The model and results for distinctive hearsay accuracy of Conscientiousness. 

#### Full Model
```{r distinctive_ha_conscientiousness}
# specify the model
conscientiousness_distinctive_hearsay_accuracy <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_conscientiousness ~ DHA*B_C_conscientiousness + DDA*A_C_conscientiousness
A_A_conscientiousness ~ DHA*D_A_conscientiousness + DDA*C_A_conscientiousness

# hearsay consensus
B_C_conscientiousness ~~ HC*A_C_conscientiousness
D_A_conscientiousness ~~ HC*C_A_conscientiousness

# variances (pooled)
C_C_conscientiousness ~~ v_self*C_C_conscientiousness
A_A_conscientiousness ~~ v_self*A_A_conscientiousness
A_C_conscientiousness ~~ v_P1*A_C_conscientiousness
C_A_conscientiousness ~~ v_P1*C_A_conscientiousness
B_C_conscientiousness ~~ v_P2*B_C_conscientiousness
D_A_conscientiousness ~~ v_P2*D_A_conscientiousness

# intercepts (pooled)
C_C_conscientiousness ~ int_self*1
A_A_conscientiousness ~ int_self*1
B_C_conscientiousness ~ int_P1*1
D_A_conscientiousness ~ int_P1*1
A_C_conscientiousness ~ int_P2*1
C_A_conscientiousness ~ int_P2*1
'
# fit the model
fit_conscientiousness_distinctive_hearsay_accuracy <- 
  sem(conscientiousness_distinctive_hearsay_accuracy,
      data=study1, 
      # missing = FIML critical due to planned missingness
      missing="FIML")

# display results
summary(fit_conscientiousness_distinctive_hearsay_accuracy, 
        # include standardized estimates
        standardized=TRUE)
```


#### Table of Results

Now get a table of the three main results we want:

* Distinctive Hearsay Accuracy
* Distinctive Direct Accuracy
* Hearsay Consensus

```{r table_ha_conscientiousness}
consc_ha_table <- fit_conscientiousness_distinctive_hearsay_accuracy@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs) %>% 
  left_join(standardizedsolution(fit_conscientiousness_distinctive_hearsay_accuracy)) %>% 
  filter(label == "DHA" |
         label == "DDA" |
         label == "HC") %>%
  filter(duplicated(.[["label"]])) %>% 
  mutate(
    label = str_replace_all(label, "DHA", "Distinctive Hearsay Accuracy"),
    label = str_replace_all(label, "DDA", "Distinctive Direct Accuracy"),
    label = str_replace_all(label, "HC", "Hearsay Consensus")) %>%
  select(label, est.std, ci.lower, ci.upper, pvalue)

```

### HP
The model and results for distinctive hearsay accuracy of HP. 

#### Full Model
```{r distinctive_ha_hp}
# specify the model
hp_distinctive_hearsay_accuracy <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_hp ~ DHA*B_C_hp + DDA*A_C_hp
A_A_hp ~ DHA*D_A_hp + DDA*C_A_hp

# hearsay consensus
B_C_hp ~~ HC*A_C_hp
D_A_hp ~~ HC*C_A_hp

# variances (pooled)
C_C_hp ~~ v_self*C_C_hp
A_A_hp ~~ v_self*A_A_hp
A_C_hp ~~ v_P1*A_C_hp
C_A_hp ~~ v_P1*C_A_hp
B_C_hp ~~ v_P2*B_C_hp
D_A_hp ~~ v_P2*D_A_hp

# intercepts (pooled)
C_C_hp ~ int_self*1
A_A_hp ~ int_self*1
B_C_hp ~ int_P1*1
D_A_hp ~ int_P1*1
A_C_hp ~ int_P2*1
C_A_hp ~ int_P2*1
'
# fit the model
fit_hp_distinctive_hearsay_accuracy <- 
  sem(hp_distinctive_hearsay_accuracy,
      data=study1, 
      # missing = FIML critical due to planned missingness
      missing="FIML")

# display results
summary(fit_hp_distinctive_hearsay_accuracy, 
        # include standardized estimates
        standardized=TRUE)
```


#### Table of Results

Now get a table of the three main results we want:

* Distinctive Hearsay Accuracy
* Distinctive Direct Accuracy
* Hearsay Consensus


```{r table_ha_hp}
hp_ha_table <- fit_hp_distinctive_hearsay_accuracy@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs) %>% 
  left_join(standardizedsolution(fit_hp_distinctive_hearsay_accuracy)) %>% 
  filter(label == "DHA" |
         label == "DDA" |
         label == "HC") %>%
  filter(duplicated(.[["label"]])) %>% 
  mutate(
    label = str_replace_all(label, "DHA", "Distinctive Hearsay Accuracy"),
    label = str_replace_all(label, "DDA", "Distinctive Direct Accuracy"),
    label = str_replace_all(label, "HC", "Hearsay Consensus")) %>%
  select(label, est.std, ci.lower, ci.upper, pvalue)
```


### Neuroticism
The model and results for distinctive hearsay accuracy of Neuroticism. 

#### Full Model
```{r distinctive_ha_neuroticism}
# specify the model
neuroticism_distinctive_hearsay_accuracy <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_neuroticism ~ DHA*B_C_neuroticism + DDA*A_C_neuroticism
A_A_neuroticism ~ DHA*D_A_neuroticism + DDA*C_A_neuroticism

# hearsay consensus
B_C_neuroticism ~~ HC*A_C_neuroticism
D_A_neuroticism ~~ HC*C_A_neuroticism

# variances (pooled)
C_C_neuroticism ~~ v_self*C_C_neuroticism
A_A_neuroticism ~~ v_self*A_A_neuroticism
A_C_neuroticism ~~ v_P1*A_C_neuroticism
C_A_neuroticism ~~ v_P1*C_A_neuroticism
B_C_neuroticism ~~ v_P2*B_C_neuroticism
D_A_neuroticism ~~ v_P2*D_A_neuroticism

# intercepts (pooled)
C_C_neuroticism ~ int_self*1
A_A_neuroticism ~ int_self*1
B_C_neuroticism ~ int_P1*1
D_A_neuroticism ~ int_P1*1
A_C_neuroticism ~ int_P2*1
C_A_neuroticism ~ int_P2*1
'
# fit the model
fit_neuroticism_distinctive_hearsay_accuracy <- 
  sem(neuroticism_distinctive_hearsay_accuracy,
      data=study1, 
      # missing = FIML critical due to planned missingness
      missing="FIML")

# display results
summary(fit_neuroticism_distinctive_hearsay_accuracy, 
        # include standardized estimates
        standardized=TRUE)
```

#### Table of Results

Now get a table of the three main results we want:

* Distinctive Hearsay Accuracy
* Distinctive Direct Accuracy
* Hearsay Consensus

```{r table_ha_neuroticism}
neur_ha_table <- fit_neuroticism_distinctive_hearsay_accuracy@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs) %>% 
  left_join(standardizedsolution(fit_neuroticism_distinctive_hearsay_accuracy)) %>% 
  filter(label == "DHA" |
         label == "DDA" |
         label == "HC") %>%
  filter(duplicated(.[["label"]])) %>% 
  mutate(
    label = str_replace_all(label, "DHA", "Distinctive Hearsay Accuracy"),
    label = str_replace_all(label, "DDA", "Distinctive Direct Accuracy"),
    label = str_replace_all(label, "HC", "Hearsay Consensus")) %>%
  select(label, est.std, ci.lower, ci.upper, pvalue)
```

### Extraversion
The model and results for distinctive hearsay accuracy of Extraversion. 

#### Full Model
```{r distinctive_ha_extraversion}
# specify the model
extraversion_distinctive_hearsay_accuracy <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_extraversion ~ DHA*B_C_extraversion + DDA*A_C_extraversion
A_A_extraversion ~ DHA*D_A_extraversion + DDA*C_A_extraversion

# hearsay consensus
B_C_extraversion ~~ HC*A_C_extraversion
D_A_extraversion ~~ HC*C_A_extraversion

# variances (pooled)
C_C_extraversion ~~ v_self*C_C_extraversion
A_A_extraversion ~~ v_self*A_A_extraversion
A_C_extraversion ~~ v_P1*A_C_extraversion
C_A_extraversion ~~ v_P1*C_A_extraversion
B_C_extraversion ~~ v_P2*B_C_extraversion
D_A_extraversion ~~ v_P2*D_A_extraversion

# intercepts (pooled)
C_C_extraversion ~ int_self*1
A_A_extraversion ~ int_self*1
B_C_extraversion ~ int_P1*1
D_A_extraversion ~ int_P1*1
A_C_extraversion ~ int_P2*1
C_A_extraversion ~ int_P2*1
'
# fit the model
fit_extraversion_distinctive_hearsay_accuracy <- 
  sem(extraversion_distinctive_hearsay_accuracy,
      data=study1, 
      # missing = FIML critical due to planned missingness
      missing="FIML")

# display results
summary(fit_extraversion_distinctive_hearsay_accuracy, 
        # include standardized estimates
        standardized=TRUE)
```

#### Table of Results

Now get a table of the three main results we want:

* Distinctive Hearsay Accuracy
* Distinctive Direct Accuracy
* Hearsay Consensus

```{r table_ha_extraversion}
extra_ha_table <- fit_extraversion_distinctive_hearsay_accuracy@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs) %>% 
  left_join(standardizedsolution(fit_extraversion_distinctive_hearsay_accuracy)) %>% 
  filter(label == "DHA" |
         label == "DDA" |
         label == "HC") %>%
  filter(duplicated(.[["label"]])) %>% 
  mutate(
    label = str_replace_all(label, "DHA", "Distinctive Hearsay Accuracy"),
    label = str_replace_all(label, "DDA", "Distinctive Direct Accuracy"),
    label = str_replace_all(label, "HC", "Hearsay Consensus")) %>%
  select(label, est.std, ci.lower, ci.upper, pvalue) 
```


### Openness
The model and results for distinctive hearsay accuracy of Openness. 

#### Full Model

```{r distinctive_ha_openness}
# specify the model
openness_distinctive_hearsay_accuracy <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_openness ~ DHA*B_C_openness + DDA*A_C_openness
A_A_openness ~ DHA*D_A_openness + DDA*C_A_openness

# hearsay consensus
B_C_openness ~~ HC*A_C_openness
D_A_openness ~~ HC*C_A_openness

# variances (pooled)
C_C_openness ~~ v_self*C_C_openness
A_A_openness ~~ v_self*A_A_openness
A_C_openness ~~ v_P1*A_C_openness
C_A_openness ~~ v_P1*C_A_openness
B_C_openness ~~ v_P2*B_C_openness
D_A_openness ~~ v_P2*D_A_openness

# intercepts (pooled)
C_C_openness ~ int_self*1
A_A_openness ~ int_self*1
B_C_openness ~ int_P1*1
D_A_openness ~ int_P1*1
A_C_openness ~ int_P2*1
C_A_openness ~ int_P2*1
'
# fit the model
fit_openness_distinctive_hearsay_accuracy <- 
  sem(openness_distinctive_hearsay_accuracy,
      data=study1, 
      # missing = FIML critical due to planned missingness
      missing="FIML")

# display results
summary(fit_openness_distinctive_hearsay_accuracy, 
        # include standardized estimates
        standardized=TRUE)
```

#### Table of Results

Now get a table of the three main results we want:

* Distinctive Hearsay Accuracy
* Distinctive Direct Accuracy
* Hearsay Consensus


```{r table_ha_open}
open_ha_table <- fit_openness_distinctive_hearsay_accuracy@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs) %>% 
  left_join(standardizedsolution(fit_openness_distinctive_hearsay_accuracy)) %>% 
  filter(label == "DHA" |
         label == "DDA" |
         label == "HC") %>%
  filter(duplicated(.[["label"]])) %>% 
  mutate(
    label = str_replace_all(label, "DHA", "Distinctive Hearsay Accuracy"),
    label = str_replace_all(label, "DDA", "Distinctive Direct Accuracy"),
    label = str_replace_all(label, "HC", "Hearsay Consensus")) %>%
  select(label, est.std, ci.lower, ci.upper, pvalue)
```

### Table of All Big Six together

And finally a table of all of the results together. This is akin to Table 2 in the manuscript, but is organized a bit differently.
```{r table_ha_all}
agree_ha_table$domain = "Agreeableness"
consc_ha_table$domain = "Conscientiousness"
hp_ha_table$domain = "Honesty-Propriety"
neur_ha_table$domain = "Neuroticism"
extra_ha_table$domain = "Extraversion"
open_ha_table$domain = "Openness"

agree_ha_table %>% 
  full_join(consc_ha_table) %>% 
  full_join(hp_ha_table) %>% 
  full_join(neur_ha_table) %>% 
  full_join(extra_ha_table) %>% 
  full_join(open_ha_table) %>% 
  mutate(parameter = fct_relevel(label,
                                 "Distinctive Hearsay Accuracy",
                                 "Distinctive Direct Accuracy",
                                 "Hearsay Consensus"),
         pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 
                                 4, side = "right", pad ="0"), "< .001")) %>% 
  arrange(parameter) %>% 
  select(domain, parameter, est.std, ci.lower, ci.upper, pvalue) %>% 
  knitr::kable(digits = c(NA, NA, 2, 2, 2, NA),
               caption = "Distinctive Hearsay Accuracy: All Big Six",
               format = "html", escape = F) %>% 
  kable_styling("striped", full_width = F) 
```

## Extraversion Moderating Hearsay Consensus

I'll start with Extraversion moderating hearsay consensus, which predicts P1 reports from P2 reports, (Target, P1, and P2 ) self-reported Extraversion, and their interaction.

### Target Extraversion

Starting with targets' self-reported Extraversion moderating hearsay consensus for each of the Big Six.

#### Agreeableness
```{r Text_mod_hc_agree}
agreeableness_Textmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXagree_CB", 
                                           "extraXagree_AD"))
summary(agreeableness_Textmod_hc, standardized = TRUE)
```

#### Conscientiousness
```{r Text_mod_hc_consc}
conscientiousness_Textmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXconsc_CB", 
                                           "extraXconsc_AD"))
summary(conscientiousness_Textmod_hc, standardized = TRUE)
```
#### Honesty-Propriety
```{r Text_mod_hc_hp}
hp_Textmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXhp_CB", 
                                           "extraXhp_AD"))
summary(hp_Textmod_hc, standardized = TRUE)
```

#### Neuroticism
```{r Text_mod_hc_neuro}
neuroticism_Textmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXneuro_CB", 
                                           "extraXneuro_AD"))
summary(neuroticism_Textmod_hc, standardized = TRUE)
```

#### Extraversion
```{r Text_mod_hc_extra}
extraversion_Textmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXextra_CB", 
                                           "extraXextra_AD"))
summary(extraversion_Textmod_hc, standardized = TRUE)
```

#### Openness
```{r Text_mod_hc_open}
openness_Textmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXopen_CB", 
                                           "extraXopen_AD"))
summary(openness_Textmod_hc, standardized = TRUE)
```


### P1 Extraversion

Next up, P1s' self-reported Extraversion moderating hearsay consensus for each of the Big Six.

#### Agreeableness
```{r P1ext_mod_hc_agree}
agreeableness_P1extmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXagree_AB", 
                                           "extraXagree_CD"))
summary(agreeableness_P1extmod_hc, standardized = TRUE)
```

#### Conscientiousness
```{r P1ext_mod_hc_consc}
conscientiousness_P1extmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXconsc_AB", 
                                           "extraXconsc_CD"))
summary(conscientiousness_P1extmod_hc, standardized = TRUE)
```
#### Honesty-Propriety
```{r P1ext_mod_hc_hp}
hp_P1extmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXhp_AB", 
                                           "extraXhp_CD"))
summary(hp_P1extmod_hc, standardized = TRUE)
```

#### Neuroticism
```{r P1ext_mod_hc_neuro}
neuroticism_P1extmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXneuro_AB", 
                                           "extraXneuro_CD"))
summary(neuroticism_P1extmod_hc, standardized = TRUE)
```

#### Extraversion
```{r P1ext_mod_hc_extra}
extraversion_P1extmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXextra_AB", 
                                           "extraXextra_CD"))
summary(extraversion_P1extmod_hc, standardized = TRUE)
```

#### Openness
```{r P1ext_mod_hc_open}
openness_P1extmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXopen_AB", 
                                           "extraXopen_CD"))
summary(openness_P1extmod_hc, standardized = TRUE)
```

### P2 Extraversion

Next, P2s' self-reported Extraversion moderating hearsay consensus for each of the Big Six.

#### Agreeableness
```{r P2ext_mod_hc_agree}
agreeableness_P2extmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXagree_BB", 
                                           "extraXagree_DD"))
summary(agreeableness_P2extmod_hc, standardized = TRUE)
```

#### Conscientiousness
```{r P2ext_mod_hc_consc}
conscientiousness_P2extmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXconsc_BB", 
                                           "extraXconsc_DD"))
summary(conscientiousness_P2extmod_hc, standardized = TRUE)
```
#### Honesty-Propriety
```{r P2ext_mod_hc_hp}
hp_P2extmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXhp_BB", 
                                           "extraXhp_DD"))
summary(hp_P2extmod_hc, standardized = TRUE)
```

#### Neuroticism
```{r P2ext_mod_hc_neuro}
neuroticism_P2extmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXneuro_BB", 
                                           "extraXneuro_DD"))
summary(neuroticism_P2extmod_hc, standardized = TRUE)
```

#### Extraversion
```{r P2ext_mod_hc_extra}
extraversion_P2extmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXextra_BB", 
                                           "extraXextra_DD"))
summary(extraversion_P2extmod_hc, standardized = TRUE)
```

#### Openness
```{r P2ext_mod_hc_open}
openness_P2extmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXopen_BB", 
                                           "extraXopen_DD"))
summary(openness_P2extmod_hc, standardized = TRUE)
```

### Table of Extraversion Moderating Hearsay Consensus (Table S4)
First, search the environment for all of the objects ending in _hc, which is how all of the  Extraversion moderating Heaesay Consensus models end.

```{r extra_mod_hc_tbl}
extra_mod_hc <- ls() %>% 
  .[str_detect(., "_hc$")]

extra_mod_hc %>% 
  map(get) %>%
  map_df(ez_id_mod_table) %>% 
  cbind(domain = rep(as.character(str_extract_all(extra_mod_hc, "^[:alpha:]*")), each = 3)) %>% 
  mutate(moderator = rep(str_extract(extra_mod_hc, "_[:alnum:]*"), each = 3),
         moderator = str_remove_all(moderator, "_"),
         moderator = str_remove_all(moderator, "extmod"),
  moderator = paste(moderator, "Extraversion"),
  moderator = fct_relevel(moderator,
                          "T Extraversion",
                          "P1 Extraversion",
                          "P2 Extraversion"),
  domain = fct_relevel(domain,
                       "agreeableness",
                       "conscientiousness",
                       "hp",
                       "neuroticism",
                       "extraversion",
                       "openness"),
  pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), 
                                             "0.", "."), 4, 
                                 side = "right", pad ="0"),  
                         "< .001")) %>% 
  filter(parameter == "interaction effect") %>% 
  select(moderator, domain, everything(), -parameter) %>% 
  arrange(moderator, domain) %>% 
  knitr::kable(caption = "Extraversion Moderating Hearsay Consensus (akin to Table S4)",
               digits = c(NA, NA, 2, 2, 2, NA)) %>% 
  kable_styling("striped", full_width = F) 
```

## Extraversion Moderating Hearsay Accuracy

Next up: Extraversion moderating hearsay accuracy. These models are almost identical to the one's above, but instead have targets' self-reports as the outcome variable in the regression equations. 

### Target Extraversion
Starting with target Extraversion moderating hearsay accuracy for each of the Big Six. 

#### Agreeableness
```{r Text_mod_ha_agree}
agreeableness_Textmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXagree_CB", 
                                           "extraXagree_AD"))
summary(agreeableness_Textmod_ha, standardized = TRUE)
```

#### Conscientiousness
```{r Text_mod_ha_consc}
conscientiousness_Textmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXconsc_CB", 
                                           "extraXconsc_AD"))
summary(conscientiousness_Textmod_ha, standardized = TRUE)
```
#### Honesty-Propriety
```{r Text_mod_ha_hp}
hp_Textmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXhp_CB", 
                                           "extraXhp_AD"))
summary(hp_Textmod_ha, standardized = TRUE)
```

#### Neuroticism
```{r Text_mod_ha_neuro}
neuroticism_Textmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXneuro_CB", 
                                           "extraXneuro_AD"))
summary(neuroticism_Textmod_ha, standardized = TRUE)
```

#### Extraversion
Extraversion is not possible, as it would be a predictor and outcome in the same equation.

#### Openness
```{r Text_mod_ha_open}
openness_Textmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXopen_CB", 
                                           "extraXopen_AD"))
summary(openness_Textmod_ha, standardized = TRUE)
```


### P1 Extraversion
Next up: P1 self-reported Extraversion moderating hearsay accuracy for each of the Big Six.
#### Agreeableness
```{r P1ext_mod_ha_agree}
agreeableness_P1extmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXagree_AB", 
                                           "extraXagree_CD"))
summary(agreeableness_P1extmod_ha, standardized = TRUE)
```

#### Conscientiousness
```{r P1ext_mod_ha_consc}
conscientiousness_P1extmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXconsc_AB", 
                                           "extraXconsc_CD"))
summary(conscientiousness_P1extmod_ha, standardized = TRUE)
```
#### Honesty-Propriety
```{r P1ext_mod_ha_hp}
hp_P1extmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXhp_AB", 
                                           "extraXhp_CD"))
summary(hp_P1extmod_ha, standardized = TRUE)
```

#### Neuroticism
```{r P1ext_mod_ha_neuro}
neuroticism_P1extmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXneuro_AB", 
                                           "extraXneuro_CD"))
summary(neuroticism_P1extmod_ha, standardized = TRUE)
```

#### Extraversion
P1 Extraversion moderating hearsay accuracy is a little different than the others and doesn't work well with the individual difference moderator function, because targets' self-reported extraversion is an outcome in one equation (as the accuracy criterion for Extraversion) and a predictor in the other (as P1s' Extraversion). That one needs to be written 'by hand' and passed to `Lavaan`.
```{r P1ext_mod_ha_extra}
extraversion_P1extmod_ha <- '
C_C_extraversion_cent ~ ha_me*B_C_extraversion_cent + mod_me*A_A_extraversion_cent + interaction*extraXextra_AB
A_A_extraversion_cent ~ ha_me*D_A_extraversion_cent + mod_me*C_C_extraversion_cent + interaction*extraXextra_CD

C_C_extraversion_cent ~ int_se*1
A_A_extraversion_cent ~ int_se*1
B_C_extraversion_cent ~ int_p2*1
D_A_extraversion_cent ~ int_p2*1
C_C_extraversion ~ int_se2*1
A_A_extraversion ~ int_se2*1
extraXextra_AB ~ int_mod*1
extraXextra_CD ~ int_mod*1

B_C_extraversion_cent ~~ v_p2*B_C_extraversion_cent
D_A_extraversion_cent ~~ v_p2*D_A_extraversion_cent

A_A_extraversion_cent ~~ v_se*A_A_extraversion_cent
C_C_extraversion_cent ~~ v_se*C_C_extraversion_cent

extraXextra_AB ~~ v_mod*extraXextra_AB
extraXextra_CD ~~ v_mod*extraXextra_CD
'

extraversion_P1extmod_ha  <- sem(extraversion_P1extmod_ha, 
                                  data = study1, 
                                  missing="FIML", fixed.x = FALSE)
summary(extraversion_P1extmod_ha, standardized=TRUE)
```

#### Openness
```{r P1ext_mod_ha_open}
openness_P1extmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXopen_AB", 
                                           "extraXopen_CD"))
summary(openness_P1extmod_ha, standardized = TRUE)
```

### P2 Extraversion
Next: P2 self-reported Extraversion moderating hearsay accuracy for each of the Big Six.
#### Agreeableness
```{r P2ext_mod_ha_agree}
agreeableness_P2extmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXagree_BB", 
                                           "extraXagree_DD"))
summary(agreeableness_P2extmod_ha, standardized = TRUE)
```

#### Conscientiousness
```{r P2ext_mod_ha_consc}
conscientiousness_P2extmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXconsc_BB", 
                                           "extraXconsc_DD"))
summary(conscientiousness_P2extmod_ha, standardized = TRUE)
```
#### Honesty-Propriety
```{r P2ext_mod_ha_hp}
hp_P2extmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXhp_BB", 
                                           "extraXhp_DD"))
summary(hp_P2extmod_ha, standardized = TRUE)
```

#### Neuroticism
```{r P2ext_mod_ha_neuro}
neuroticism_P2extmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXneuro_BB", 
                                           "extraXneuro_DD"))
summary(neuroticism_P2extmod_ha, standardized = TRUE)
```

#### Extraversion
```{r P2ext_mod_ha_extra}
extraversion_P2extmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_extraversion", 
                                     "A_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXextra_BB", 
                                           "extraXextra_DD"))
summary(extraversion_P2extmod_ha, standardized = TRUE)
```

#### Openness
```{r P2ext_mod_ha_open}
openness_P2extmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXopen_BB", 
                                           "extraXopen_DD"))
summary(openness_P2extmod_ha, standardized = TRUE)
```
### Table of Extraversion Moderating Hearsay Accuracy
```{r extraversion_mod_hearacc_tbl}
extra_mod_ha <- ls() %>% 
  .[str_detect(., "_ha$")]

extra_mod_ha %>% 
  map(get) %>% 
  map_df(ez_id_mod_table) %>%
  cbind(domain = rep(as.character(str_extract_all(extra_mod_ha, "^[:alpha:]*")), 
                     each = 3)) %>% 
  mutate(moderator = rep(str_extract(extra_mod_ha, "_[:alnum:]*"), each = 3),
         moderator = str_remove_all(moderator, "_"),
         moderator = str_remove_all(moderator, "extmod"),
  moderator = paste(moderator, "Extraversion"),
  moderator = fct_relevel(moderator,
                          "T Extraversion",
                          "P1 Extraversion",
                          "P2 Extraversion"),
  domain = fct_relevel(domain,
                       "agreeableness",
                       "conscientiousness",
                       "hp",
                       "neuroticism",
                       "extraversion",
                       "openness"),
  pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), 
                                             "0.", "."), 4, 
                                 side = "right", pad ="0"),  
                         "< .001")) %>% 
  filter(parameter == "interaction effect") %>% 
  select(moderator, domain, everything(), -parameter) %>% 
  arrange(moderator, domain) %>% 
  knitr::kable(caption = "Extraversion Moderating Hearsay Accuracy (akin to Table S5)",
               digits = c(NA, NA, 2, 2, 2, NA)) %>% 
  kable_styling("striped", full_width = F) 
```


## Empathy Moderating Hearsay Consensus

Next up: P2s' self-reported Empathy (as assessed by the IRI; Davis, 1980) moderating hearsay consensus for each of the Big Six.

### Perspective Taking
Starting with perspective taking.
#### Agreeableness
```{r PTmod_hc_agree}
agreeableness_PTmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxA_B", 
                                           "PTxA_D"))
summary(agreeableness_PTmod_hc, standardized = TRUE)
```

#### Conscientiousness
```{r PTmod_hc_consc}
conscientiousness_PTmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxC_B", 
                                           "PTxC_D"))
summary(conscientiousness_PTmod_hc, standardized = TRUE)
```
#### Honesty-Propriety
```{r PTmod_hc_hp}
hp_PTmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxHP_B", 
                                           "PTxHP_D"))
summary(hp_PTmod_hc, standardized = TRUE)
```

#### Neuroticism
```{r PTmod_hc_neuro}
neuroticism_PTmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxN_B", 
                                           "PTxN_D"))
summary(neuroticism_PTmod_hc, standardized = TRUE)
```

#### Extraversion
```{r PTmod_hc_extra}
extraversion_PTmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxE_B", 
                                           "PTxE_D"))
summary(extraversion_PTmod_hc, standardized = TRUE)
```

#### Openness
```{r PTmod_hc_open}
openness_PTmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxO_B", 
                                           "PTxO_D"))
summary(openness_PTmod_hc, standardized = TRUE)
```


### Empathic Concern
Then empathic concern.
#### Agreeableness
```{r empmod_hc_agree}
agreeableness_empmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxA_B", 
                                           "empxA_D"))
summary(agreeableness_empmod_hc, standardized = TRUE)
```

#### Conscientiousness
```{r empmod_hc_consc}
conscientiousness_empmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxC_B", 
                                           "empxC_D"))
summary(conscientiousness_empmod_hc, standardized = TRUE)
```
#### Honesty-Propriety
```{r empmod_hc_hp}
hp_empmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxHP_B", 
                                           "empxHP_D"))
summary(hp_empmod_hc, standardized = TRUE)
```

#### Neuroticism
```{r empmod_hc_neuro}
neuroticism_empmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxN_B", 
                                           "empxN_D"))
summary(neuroticism_empmod_hc, standardized = TRUE)
```

#### Extraversion
```{r empmod_hc_extra}
extraversion_empmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxE_B", 
                                           "empxE_D"))
summary(extraversion_empmod_hc, standardized = TRUE)
```

#### Openness
```{r empmod_hc_open}
openness_empmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxO_B", 
                                           "empxO_D"))
summary(openness_empmod_hc, standardized = TRUE)
```


### Personal Distress
Then personal distress.
#### Agreeableness
```{r dismod_hc_agree}
agreeableness_dismod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxA_B", 
                                           "disxA_D"))
summary(agreeableness_dismod_hc, standardized = TRUE)
```

#### Conscientiousness
```{r dismod_hc_consc}
conscientiousness_dismod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxC_B", 
                                           "disxC_D"))
summary(conscientiousness_dismod_hc, standardized = TRUE)
```
#### Honesty-Propriety
```{r dismod_hc_hp}
hp_dismod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxHP_B", 
                                           "disxHP_D"))
summary(hp_dismod_hc, standardized = TRUE)
```

#### Neuroticism
```{r dismod_hc_neuro}
neuroticism_dismod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxN_B", 
                                           "disxN_D"))
summary(neuroticism_dismod_hc, standardized = TRUE)
```

#### Extraversion
```{r dismod_hc_extra}
extraversion_dismod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxE_B", 
                                           "disxE_D"))
summary(extraversion_dismod_hc, standardized = TRUE)
```

#### Openness
```{r dismod_hc_open}
openness_dismod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxO_B", 
                                           "disxO_D"))
summary(openness_dismod_hc, standardized = TRUE)
```

### Fantasy
Lastly, the fantasy subscale.
#### Agreeableness
```{r fantmod_hc_agree}
agreeableness_fantmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxA_B", 
                                           "fantxA_D"))
summary(agreeableness_fantmod_hc, standardized = TRUE)
```

#### Conscientiousness
```{r fantmod_hc_consc}
conscientiousness_fantmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxC_B", 
                                           "fantxC_D"))
summary(conscientiousness_fantmod_hc, standardized = TRUE)
```
#### Honesty-Propriety
```{r fantmod_hc_hp}
hp_fantmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxHP_B", 
                                           "fantxHP_D"))
summary(hp_fantmod_hc, standardized = TRUE)
```

#### Neuroticism
```{r fantmod_hc_neuro}
neuroticism_fantmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxN_B", 
                                           "fantxN_D"))
summary(neuroticism_fantmod_hc, standardized = TRUE)
```

#### Extraversion
```{r fantmod_hc_extra}
extraversion_fantmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxE_B", 
                                           "fantxE_D"))
summary(extraversion_fantmod_hc, standardized = TRUE)
```

#### Openness
```{r fantmod_hc_open}
openness_fantmod_hc <- rep_consensus_id_mods(study1,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxO_B", 
                                           "fantxO_D"))
summary(openness_fantmod_hc, standardized = TRUE)
```

### Table of Empathy Moderating Hearsay Consensus
And now a table with all of the empathy moderating hearsay consensus analyses, which is similar to the first part of Table S6. 
```{r emp_mod_hc_table}
emp_mod_hc <- ls()[str_detect(ls(), "PTmod_hc$|empmod_hc$|dismod_hc$|fantmod_hc$")]
         

emp_mod_hc %>% 
  map(get) %>% 
  map_df(ez_id_mod_table) %>%
  cbind(domain = rep(as.character(str_extract_all(emp_mod_hc, "^[:alpha:]*")), 
                     each = 3)) %>% 
  mutate(moderator = rep(str_extract(emp_mod_hc, "_[:alnum:]*"), each = 3),
         moderator = str_remove_all(moderator, "_"),
         moderator = str_remove_all(moderator, "mod"),
         moderator = case_when(moderator == "PT" ~ "Perspective Taking",
                               moderator == "emp" ~ "Empathic Concern",
                               moderator == "dis" ~ "Personal Distress",
                               moderator == "fant" ~ "Fantasy"),
  moderator = fct_relevel(moderator,
                          "Perspective Taking",
                          "Empathic Concern",
                          "Personal Distress",
                          "Fantasy"),
  domain = fct_relevel(domain,
                       "agreeableness",
                       "conscientiousness",
                       "hp",
                       "neuroticism",
                       "extraversion",
                       "openness"),
  pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), 
                                             "0.", "."), 4, 
                                 side = "right", pad ="0"),  
                         "< .001")) %>% 
  filter(parameter == "interaction effect") %>% 
  select(moderator, domain, everything(), -parameter) %>% 
  arrange(moderator, domain) %>% 
  knitr::kable(caption = "Empathy Moderating Hearsay Consensus (akin to part of Table S6)",
               digits = c(NA, NA, 2, 2, 2, NA)) %>% 
  kable_styling("striped", full_width = F) 
```



## Empathy Moderating Hearsay Accuracy
Finally, empathy moderating hearsay accuracy, which are the last analyses included in Study 1.
### Perspective Taking
#### Agreeableness
```{r PTmod_ha_agree}
agreeableness_PTmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxA_B", 
                                           "PTxA_D"))
summary(agreeableness_PTmod_ha, standardized = TRUE)
```

#### Conscientiousness
```{r PTmod_ha_consc}
conscientiousness_PTmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxC_B", 
                                           "PTxC_D"))
summary(conscientiousness_PTmod_ha, standardized = TRUE)
```
#### Honesty-Propriety
```{r PTmod_ha_hp}
hp_PTmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxHP_B", 
                                           "PTxHP_D"))
summary(hp_PTmod_ha, standardized = TRUE)
```

#### Neuroticism
```{r PTmod_ha_neuro}
neuroticism_PTmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxN_B", 
                                           "PTxN_D"))
summary(neuroticism_PTmod_ha, standardized = TRUE)
```

#### Extraversion
```{r PTmod_ha_extra}
extraversion_PTmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_extraversion", 
                                     "A_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxE_B", 
                                           "PTxE_D"))
summary(extraversion_PTmod_ha, standardized = TRUE)
```

#### Openness
```{r PTmod_ha_open}
openness_PTmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxO_B", 
                                           "PTxO_D"))
summary(openness_PTmod_ha, standardized = TRUE)
```


### Empathic Concern
#### Agreeableness
```{r empmod_ha_agree}
agreeableness_empmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxA_B", 
                                           "empxA_D"))
summary(agreeableness_empmod_ha, standardized = TRUE)
```

#### Conscientiousness
```{r empmod_ha_consc}
conscientiousness_empmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxC_B", 
                                           "empxC_D"))
summary(conscientiousness_empmod_ha, standardized = TRUE)
```
#### Honesty-Propriety
```{r empmod_ha_hp}
hp_empmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxHP_B", 
                                           "empxHP_D"))
summary(hp_empmod_ha, standardized = TRUE)
```

#### Neuroticism
```{r empmod_ha_neuro}
neuroticism_empmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxN_B", 
                                           "empxN_D"))
summary(neuroticism_empmod_ha, standardized = TRUE)
```

#### Extraversion
```{r empmod_ha_extra}
extraversion_empmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_extraversion", 
                                     "A_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxE_B", 
                                           "empxE_D"))
summary(extraversion_empmod_ha, standardized = TRUE)
```

#### Openness
```{r empmod_ha_open}
openness_empmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxO_B", 
                                           "empxO_D"))
summary(openness_empmod_ha, standardized = TRUE)
```


### Personal Distress
#### Agreeableness
```{r dismod_ha_agree}
agreeableness_dismod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxA_B", 
                                           "disxA_D"))
summary(agreeableness_dismod_ha, standardized = TRUE)
```

#### Conscientiousness
```{r dismod_ha_consc}
conscientiousness_dismod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxC_B", 
                                           "disxC_D"))
summary(conscientiousness_dismod_ha, standardized = TRUE)
```
#### Honesty-Propriety
```{r dismod_ha_hp}
hp_dismod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxHP_B", 
                                           "disxHP_D"))
summary(hp_dismod_ha, standardized = TRUE)
```

#### Neuroticism
```{r dismod_ha_neuro}
neuroticism_dismod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxN_B", 
                                           "disxN_D"))
summary(neuroticism_dismod_ha, standardized = TRUE)
```

#### Extraversion
```{r dismod_ha_extra}
extraversion_dismod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_extraversion", 
                                     "A_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxE_B", 
                                           "disxE_D"))
summary(extraversion_dismod_ha, standardized = TRUE)
```

#### Openness
```{r dismod_ha_open}
openness_dismod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxO_B", 
                                           "disxO_D"))
summary(openness_dismod_ha, standardized = TRUE)
```

### Fantasy
#### Agreeableness
```{r fantmod_ha_agree}
agreeableness_fantmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxA_B", 
                                           "fantxA_D"))
summary(agreeableness_fantmod_ha, standardized = TRUE)
```

#### Conscientiousness
```{r fantmod_ha_consc}
conscientiousness_fantmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxC_B", 
                                           "fantxC_D"))
summary(conscientiousness_fantmod_ha, standardized = TRUE)
```
#### Honesty-Propriety
```{r fantmod_ha_hp}
hp_fantmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxHP_B", 
                                           "fantxHP_D"))
summary(hp_fantmod_ha, standardized = TRUE)
```

#### Neuroticism
```{r fantmod_ha_neuro}
neuroticism_fantmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxN_B", 
                                           "fantxN_D"))
summary(neuroticism_fantmod_ha, standardized = TRUE)
```

#### Extraversion
```{r fantmod_ha_extra}
extraversion_fantmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_extraversion", 
                                     "A_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxE_B", 
                                           "fantxE_D"))
summary(extraversion_fantmod_ha, standardized = TRUE)
```

#### Openness
```{r fantmod_ha_open}
openness_fantmod_ha <- rep_accuracy_id_mods(study1,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxO_B", 
                                           "fantxO_D"))
summary(openness_fantmod_ha, standardized = TRUE)
```

### Table of Empathy Moderating Hearsay Accuracy
This table has all of the empathy moderating hearsay accuracy similar to the second half of Supplemental Table S6
```{r emp_mod_ha_tbl}
emp_mod_ha <- ls()[str_detect(ls(), "PTmod_ha$|empmod_ha$|dismod_ha$|fantmod_ha$")]
         

emp_mod_ha %>% 
  map(get) %>% 
  map_df(ez_id_mod_table) %>%
  cbind(domain = rep(as.character(str_extract_all(emp_mod_ha, "^[:alpha:]*")), 
                     each = 3)) %>% 
  mutate(moderator = rep(str_extract(emp_mod_ha, "_[:alnum:]*"), each = 3),
         moderator = str_remove_all(moderator, "_"),
         moderator = str_remove_all(moderator, "mod"),
         moderator = case_when(moderator == "PT" ~ "Perspective Taking",
                               moderator == "emp" ~ "Empathic Concern",
                               moderator == "dis" ~ "Personal Distress",
                               moderator == "fant" ~ "Fantasy"),
  moderator = fct_relevel(moderator,
                          "Perspective Taking",
                          "Empathic Concern",
                          "Personal Distress",
                          "Fantasy"),
  domain = fct_relevel(domain,
                       "agreeableness",
                       "conscientiousness",
                       "hp",
                       "neuroticism",
                       "extraversion",
                       "openness"),
  pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), 
                                             "0.", "."), 4, 
                                 side = "right", pad ="0"),  
                         "< .001")) %>% 
  filter(parameter == "interaction effect") %>% 
  select(moderator, domain, everything(), -parameter) %>% 
  arrange(moderator, domain) %>% 
  knitr::kable(caption = "Empathy Moderating Hearsay Accuracy (akin to part of Table S6)",
               digits = c(NA, NA, 2, 2, 2, NA)) %>% 
  kable_styling("striped", full_width = F) 
```

# Study 2

The Study 2 analyses (below) are in the same order as the manuscript, which is: 
1. the context manipulation analyses 
2. the social decision (leadership and friendship judgement) analyses
3. the integrated analyses.

## Status-relevant context and extraversion

First up, comparing hearsay consensus and accuracy for Extraversion in the status vs. control conditions. 
```{r status_extraversion_models}
extra_status_noeq <- rep_auto_group_mod(study2, 
                                        p1_reports = c("A_C_extraversion", "C_A_extraversion"),
                                        p2_reports = c("B_C_extraversion", "D_A_extraversion"),
                                        target_self = c("C_C_extraversion", "A_A_extraversion"),
                                        group_mod = "condition",
                                        groups_eql = "none",
                                        params_eql = "none",
                                        use_labs = TRUE)

extra_status_hceq <- rep_auto_group_mod(study2, 
                                        p1_reports = c("A_C_extraversion", "C_A_extraversion"),
                                        p2_reports = c("B_C_extraversion", "D_A_extraversion"),
                                        target_self = c("C_C_extraversion", "A_A_extraversion"),
                                        group_mod = "condition",
                                        groups_eql = 2:3,
                                        params_eql = "hc",
                                        use_labs = TRUE)

extra_status_haeq <- rep_auto_group_mod(study2, 
                                        p1_reports = c("A_C_extraversion", "C_A_extraversion"),
                                        p2_reports = c("B_C_extraversion", "D_A_extraversion"),
                                        target_self = c("C_C_extraversion", "A_A_extraversion"),
                                        group_mod = "condition",
                                        groups_eql = 2:3,
                                        params_eql = c("ha"),
                                        use_labs = TRUE)

extra_status_daeq <- rep_auto_group_mod(study2, 
                                        p1_reports = c("A_C_extraversion", "C_A_extraversion"),
                                        p2_reports = c("B_C_extraversion", "D_A_extraversion"),
                                        target_self = c("C_C_extraversion", "A_A_extraversion"),
                                        group_mod = "condition",
                                        groups_eql = 2:3,
                                        params_eql = c("da"),
                                        use_labs = TRUE)
```

### Table of Model Comparison For Extraversion across Conditions
```{r extra_status_model_comp_tbl}
extra_status_models <- c("extra_status_hceq", 
                         "extra_status_haeq", 
                         "extra_status_daeq") 
extra_status_models %>% 
  map(get) %>% 
  map(anova, extra_status_noeq) %>% 
  map(as.data.frame) %>% 
  map(mutate, delt_aic = AIC - lag(AIC) ,
         delt_bic = BIC - lag(BIC)) %>% 
  map_df(slice, -1) %>% 
  cbind(comparison = c("Hearsay Consensus Equal",
                       "Hearsay Accuracy Equal",
                       "Direct Accuracy Equal")) %>% 
  select(comparison, 5:9) %>% 
  rename(pvalue = `Pr(>Chisq)`) %>% 
  mutate(comparison = as.character(comparison),
         comparison = ifelse(comparison == "Direct Accuracy Equal", 
                             paste0(comparison, footnote_marker_alphabet(1)), comparison),
         pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), 
                                             "0.", "."), 4, 
                                 side = "right", pad ="0"),  
                         "< .001")) %>% 
  knitr::kable(caption = "Model Comparison Results for Status-Relevant Context and Extraversion",
               digits = c(NA, 2, 0, NA, 2, 2),
               format = "html", escape = FALSE) %>% 
  kable_styling("striped", full_width = F) %>% 
  footnote(general = "Each Model is Compared to the Null Model",
           alphabet = "not pre-registered")
```
### Table of Differential Agreement for Extraversion by Condition
```{r differential_extraversion_by_condition}
ez_differential_group_table(extra_status_noeq) %>%
  mutate(condition = case_when(
  group_label == "grp1" ~ "Affiliation",
  group_label == "grp2" ~ "Neutral/Control",
  group_label == "grp3" ~ "Status"
  ),
  pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 4, 
                                 side = "right", pad ="0"),  
                         "< .001")) %>% 
  select(condition, everything(), -group_label) %>% 
  knitr::kable(caption = "Differential Results for Extraversion Across Condition",
               digits = c(NA, NA, 2, 2, 2, 3),
               format = "html", escape = FALSE) %>% 
  kable_styling("striped", full_width = F) 
```

### Plot of Hearsay Consensus & Accuracy for Extraversion in the Status vs. Control Conditions (Figure 5)
```{r differential_extraversion_by_condition_plot}
extra_status_plot <- ez_differential_group_table(extra_status_noeq) %>%
  mutate(condition = case_when(group_label == "grp1" ~ "Affiliation",
  group_label == "grp2" ~ "Neutral/Control",
  group_label == "grp3" ~ "Status")) %>% 
  filter(condition != "Affiliation") %>% 
  ggplot(aes(x = parameter, y = r, shape = condition)) +
  geom_pointrange(aes(ymin = ci_lower, ymax = ci_upper), position = position_dodge(width = .5)) + 
  theme_rep_manuscript +
  geom_hline(yintercept = 0, linetype = 2, alpha = .5) + 
  scale_y_continuous(limit=c(-0.3, .95))+
  coord_flip()+
  guides(shape=guide_legend(reverse=TRUE)) +
  labs(x = NULL)
extra_status_plot
ggsave("Plots/extraXCond.png",
       extra_status_plot,
       device = "png", height = 5, width = 9.5)
```
## Affiliation-relevant context and agreeableness

Next up, comparing hearsay consensus and accuracy for Agreeableness in the affiliation vs. control conditions.

```{r affil_agree_models}
agree_affil_noeq <- rep_auto_group_mod(study2, 
                                        p1_reports = c("A_C_agreeableness", "C_A_agreeableness"),
                                        p2_reports = c("B_C_agreeableness", "D_A_agreeableness"),
                                        target_self = c("C_C_agreeableness", "A_A_agreeableness"),
                                        group_mod = "condition",
                                        groups_eql = "none",
                                        params_eql = "none",
                                        use_labs = TRUE)

agree_affil_hceq <- rep_auto_group_mod(study2, 
                                        p1_reports = c("A_C_agreeableness", "C_A_agreeableness"),
                                        p2_reports = c("B_C_agreeableness", "D_A_agreeableness"),
                                        target_self = c("C_C_agreeableness", "A_A_agreeableness"),
                                        group_mod = "condition",
                                        groups_eql = 1:2,
                                        params_eql = "hc",
                                        use_labs = TRUE)

agree_affil_haeq <- rep_auto_group_mod(study2, 
                                        p1_reports = c("A_C_agreeableness", "C_A_agreeableness"),
                                        p2_reports = c("B_C_agreeableness", "D_A_agreeableness"),
                                        target_self = c("C_C_agreeableness", "A_A_agreeableness"),
                                        group_mod = "condition",
                                        groups_eql = 1:2,
                                        params_eql = c("ha"),
                                        use_labs = TRUE)

agree_affil_daeq <- rep_auto_group_mod(study2, 
                                        p1_reports = c("A_C_agreeableness", "C_A_agreeableness"),
                                        p2_reports = c("B_C_agreeableness", "D_A_agreeableness"),
                                        target_self = c("C_C_agreeableness", "A_A_agreeableness"),
                                        group_mod = "condition",
                                        groups_eql = 1:2,
                                        params_eql = c("da"),
                                        use_labs = TRUE)
```
### Table of Model Comparison For Agreeableness across Conditions
```{r agree_affil_model_comp_tbl}
agree_affil_models <- c("agree_affil_hceq", 
                         "agree_affil_haeq", 
                         "agree_affil_daeq") 
agree_affil_models %>% 
  map(get) %>% 
  map(anova, agree_affil_noeq) %>% 
  map(as.data.frame) %>% 
  map(mutate, delt_aic = AIC - lag(AIC) ,
         delt_bic = BIC - lag(BIC)) %>% 
  map_df(slice, -1) %>% 
  cbind(comparison = c("Hearsay Consensus Equal",
                       "Hearsay Accuracy Equal",
                       "Direct Accuracy Equal")) %>% 
  select(comparison, 5:9) %>% 
  rename(pvalue = `Pr(>Chisq)`) %>% 
  mutate(comparison = as.character(comparison),
         comparison = ifelse(comparison == "Direct Accuracy Equal", 
                             paste0(comparison, footnote_marker_alphabet(1)), comparison),
         pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), 
                                             "0.", "."), 4, 
                                 side = "right", pad ="0"),  
                         "< .001")) %>% 
  knitr::kable(caption = "Model Comparison Results for Affiliation-Relevant Context and Agreeableness",
               digits = c(NA, 2, 0, NA, 2, 2),
               format = "html", escape = FALSE) %>% 
  kable_styling("striped", full_width = F) %>% 
  footnote(general = "Each Model is Compared to the Null Model",
           alphabet = "not pre-registered")
```

### Table of Differential Agreement for Agreeableness by Condition

```{r affil_agree_table}
ez_differential_group_table(agree_affil_noeq) %>%
  mutate(condition = case_when(
  group_label == "grp1" ~ "Affiliation",
  group_label == "grp2" ~ "Neutral/Control",
  group_label == "grp3" ~ "Status"
  ),
  pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 4, 
                                 side = "right", pad ="0"),  
                         "< .001")) %>% 
  select(condition, everything(), -group_label) %>% 
  knitr::kable(caption = "Differential Results for Agreeableness Across Condition",
               digits = c(NA, NA, 2, 2, 2, 3),
               format = "html", escape = FALSE) %>% 
  kable_styling("striped", full_width = F) 
```

### Plot of Hearsay Consensus & Accuracy for Agreeableness in the Status vs. Control Conditions (Figure 6)
```{r differential_agreeableness_by_condition_plot}
agree_affil_plot <- ez_differential_group_table(agree_affil_noeq) %>%
  mutate(condition = case_when(group_label == "grp1" ~ "Affiliation",
  group_label == "grp2" ~ "Neutral/Control",
  group_label == "grp3" ~ "Status"),
  condition = fct_relevel(condition, 
                                 "Neutral/Control",
                                 "Affiliation",
                                 "Status")) %>% 
  filter(condition != "Status") %>% 
  ggplot(aes(x = parameter, y = r, shape = condition)) +
  geom_pointrange(aes(ymin = ci_lower, ymax = ci_upper), position = position_dodge(width = .5)) + 
  theme_rep_manuscript +
  geom_hline(yintercept = 0, linetype = 2, alpha = .5) + 
  scale_y_continuous(limit=c(-0.3, .95))+
  coord_flip()+
  guides(shape=guide_legend(reverse=TRUE)) +
  labs(x = NULL)
agree_affil_plot
ggsave("Plots/agreeXCond.png",
       agree_affil_plot,
       device = "png", height = 5, width = 9.5)
```

## Effects of reputation on leadership judgments

### Pre-registered Mediation Model: Extraversion to Leadership
This is a pre-registerd analysis looking at whether P1's perception of thr target's Extraversion influences P2's perception of the target's Extraversion, which in turn influences their perception of the target's leadership potential. It was pre-registered as hypothesis 3 on OSF.

```{r H3_path_model}
extraversion_status_med_model_h3 <-'
# Model for A-B-C triad
B_C_contextitem_goodleader ~ b*B_C_extraversion + c*A_C_extraversion
B_C_extraversion ~ a*A_C_extraversion

# Model for C-D-A triad
D_A_contextitem_goodleader ~ b*D_A_extraversion + c*C_A_extraversion
D_A_extraversion ~ a*C_A_extraversion

# variances
B_C_contextitem_goodleader ~~ v_P2_gl*B_C_contextitem_goodleader
D_A_contextitem_goodleader ~~ v_P2_gl*D_A_contextitem_goodleader
B_C_extraversion ~~ v_P2*B_C_extraversion
D_A_extraversion ~~ v_P2*D_A_extraversion
A_C_extraversion ~~ v_P1*A_C_extraversion
C_A_extraversion ~~ v_P1*C_A_extraversion

# intercepts
B_C_contextitem_goodleader ~ int_P2_gl*1
D_A_contextitem_goodleader ~ int_P2_gl*1
B_C_extraversion ~ int_P2*1
D_A_extraversion ~ int_P2*1
A_C_extraversion ~ int_P1*1
C_A_extraversion ~ int_P1*1

# indirect (mediated) effect
indirecteffect := a*b
'
fit_extraversion_status_med_model_h3 <-sem(extraversion_status_med_model_h3, 
                                            data = study2, 
                                            missing="FIML", 
                                            se="bootstrap", 
                                            fixed.x=TRUE)

summary(fit_extraversion_status_med_model_h3)
```

#### Table for Extraversion to Leadership Mediation model
```{r extra_leader_med_model_tbl}
parameterestimates(fit_extraversion_status_med_model_h3) %>%
  as.data.frame() %>% 
  filter(label == "a" |
         label == "b" |
         label == "c" |
         label == "indirecteffect") %>% 
  rename(ci_upper = ci.upper,
         ci_lower = ci.lower) %>% 
  mutate(parameter = case_when(label == "b" ~ "P2(T) Extraversion -> P2(T) Leadership",
                              label == "c" ~ "P1(T) Extraversion -> P2(T) Leadership",
                              label == "a" ~ "P1(T) Extraversion -> P2(T) Extraversion",
                              label == "indirecteffect" ~ "Mediated Effect"),
         label == fct_relevel(label,
                             "a",
                             "b",
                             "c"),
        pvalue = ifelse(pvalue >= .001, 
                        str_pad(str_replace(round(pvalue, 3),
                                            "0.", "."), 4, 
                                side = "right", pad ="0"),  
                        "< .001"),
        est = round(est, 2),
        est = ifelse(str_detect(est, "\\..$"), paste0(est, "0"), 
                   ifelse(str_detect(est, "^0$"), paste0(est, ".00"), est)),
        est = cell_spec(est, "html", 
                            bold = ifelse(abs(z) > 1.96, TRUE, FALSE)),
        ci_lower = round(ci_lower, 2),
        ci_lower = ifelse(str_detect(ci_lower, "\\..$"), paste0(ci_lower, "0"), 
                   ifelse(str_detect(ci_lower, "^0$"), paste0(ci_lower, ".00"), ci_lower)),
        ci_lower = cell_spec(ci_lower, "html", 
                            bold = ifelse(abs(z) > 1.96, TRUE, FALSE)),
        ci_upper = round(ci_upper, 2),
        ci_upper = ifelse(str_detect(ci_upper, "\\..$"), paste0(ci_upper, "0"), 
                   ifelse(str_detect(ci_upper, "^0$"), paste0(ci_upper, ".00"), ci_upper)),
        ci_upper = cell_spec(ci_upper, "html",
                            bold = ifelse(abs(z) > 1.96, TRUE, FALSE)),
        z = round(z, 2)) %>% 
  arrange(label) %>% 
  select(parameter, est, ci_lower, ci_upper, z, pvalue) %>% 
  distinct() %>% 
  knitr::kable(caption = "Extraversion and Leadership Mediation Results",
              format = "html", escape = F) %>% 
 kable_styling("striped", full_width = F) 
  
```


Our results are consistent with our hypothesis: P2's perception of the target's leadership is infleunced by their perception of the target's Extraversion, which is in turn influenced by P1's perception of the target's Extraversion.

### Additional Model: All Big Six and Leadership

```{r h3_all6_leadership_multi_med_model}
big6_status_multi_med_model_h3alt <-'
# Model for A-B-C triad
B_C_contextitem_goodleader ~ b1*B_C_extraversion + b2*B_C_agreeableness + b3*B_C_conscientiousness + b4*B_C_neuroticism + b5*B_C_openness + b6*B_C_hp + c1*A_C_extraversion + c2*A_C_agreeableness + c3*A_C_conscientiousness + c4*A_C_neuroticism + c5*A_C_openness + c6*A_C_hp 

B_C_extraversion      ~ a1*A_C_extraversion
B_C_agreeableness     ~ a2*A_C_agreeableness
B_C_conscientiousness ~ a3*A_C_conscientiousness
B_C_neuroticism       ~ a4*A_C_neuroticism
B_C_openness          ~ a5*A_C_openness
B_C_hp                ~ a6*A_C_hp

# Model for C-D-A triad
D_A_contextitem_goodleader ~ b1*D_A_extraversion + b2*D_A_agreeableness + b3*D_A_conscientiousness + b4*D_A_neuroticism + b5*D_A_openness + b6*D_A_hp + c1*C_A_extraversion + c2*C_A_agreeableness + c3*C_A_conscientiousness + c4*C_A_neuroticism + c5*C_A_openness + c6*C_A_hp 

D_A_extraversion      ~ a1*C_A_extraversion
D_A_agreeableness     ~ a2*C_A_agreeableness
D_A_conscientiousness ~ a3*C_A_conscientiousness
D_A_neuroticism       ~ a4*C_A_neuroticism
D_A_openness          ~ a5*C_A_openness
D_A_hp                ~ a6*C_A_hp

# variances
B_C_contextitem_goodleader ~~ v_P2_gl*B_C_contextitem_goodleader
D_A_contextitem_goodleader ~~ v_P2_gl*D_A_contextitem_goodleader
B_C_extraversion ~~ v_P2_ex*B_C_extraversion
D_A_extraversion ~~ v_P2_ex*D_A_extraversion
B_C_agreeableness ~~ v_P2_ag*B_C_agreeableness
D_A_agreeableness ~~ v_P2_ag*D_A_agreeableness
B_C_conscientiousness ~~ v_P2_co*B_C_conscientiousness
D_A_conscientiousness ~~ v_P2_co*D_A_conscientiousness
B_C_neuroticism ~~ v_P2_ne*B_C_neuroticism
D_A_neuroticism ~~ v_P2_ne*D_A_neuroticism
B_C_openness ~~ v_P2_op*B_C_openness
D_A_openness ~~ v_P2_op*D_A_openness
B_C_hp ~~ v_P2_hp*B_C_hp
D_A_hp ~~ v_P2_hp*D_A_hp

A_C_extraversion ~~ v_P1_ex*A_C_extraversion
C_A_extraversion ~~ v_P1_ex*C_A_extraversion
A_C_agreeableness ~~ v_P1_ag*A_C_agreeableness
C_A_agreeableness ~~ v_P1_ag*C_A_agreeableness
A_C_conscientiousness ~~ v_P1_co*A_C_conscientiousness
C_A_conscientiousness ~~ v_P1_co*C_A_conscientiousness
A_C_neuroticism ~~ v_P1_ne*A_C_neuroticism
C_A_neuroticism ~~ v_P1_ne*C_A_neuroticism
A_C_openness ~~ v_P1_op*A_C_openness
C_A_openness ~~ v_P1_op*C_A_openness
A_C_hp ~~ v_P1_hp*A_C_hp
C_A_hp ~~ v_P1_hp*C_A_hp


# intercepts

B_C_contextitem_goodleader ~ int_P2_gl*1
D_A_contextitem_goodleader ~ int_P2_gl*1
B_C_extraversion ~ int_P2_ex*1
D_A_extraversion ~ int_P2_ex*1
B_C_agreeableness ~ int_P2_ag*1
D_A_agreeableness ~ int_P2_ag*1
B_C_conscientiousness ~ int_P2_co*1
D_A_conscientiousness ~ int_P2_co*1
B_C_neuroticism ~ int_P2_ne*1
D_A_neuroticism ~ int_P2_ne*1
B_C_openness ~ int_P2_op*1
D_A_openness ~ int_P2_op*1
B_C_hp ~ int_P2_hp*1
D_A_hp ~ int_P2_hp*1

A_C_extraversion ~ int_P1_ex*1
C_A_extraversion ~ int_P1_ex*1
A_C_agreeableness ~ int_P1_ag*1
C_A_agreeableness ~ int_P1_ag*1
A_C_conscientiousness ~ int_P1_co*1
C_A_conscientiousness ~ int_P1_co*1
A_C_neuroticism ~ int_P1_ne*1
C_A_neuroticism ~ int_P1_ne*1
A_C_openness ~ int_P1_op*1
C_A_openness ~ int_P1_op*1
A_C_hp ~ int_P1_hp*1
C_A_hp ~ int_P1_hp*1


# indirect (mediated) effect
indirect_ex := a1*b1
indirect_ag := a2*b2
indirect_co := a3*b3
indirect_ne := a4*b4
indirect_op := a5*b5
indirect_hp := a6*b6
'
fit_big6_status_multi_med_model_h3alt <-sem(big6_status_multi_med_model_h3alt, 
                                            data = study2, 
                                            missing = "FIML", 
                                            se = "bootstrap", 
                                            fixed.x = TRUE)

summary(fit_big6_status_multi_med_model_h3alt)

```

#### Table for Big Six to Leadership Mediation model
```{r bigsix_leader_med_model_tbl}
parameterestimates(fit_big6_status_multi_med_model_h3alt) %>%
  as.data.frame() %>% 
  filter(str_detect(label, "^a") |
         str_detect(label, "^b") |
         str_detect(label, "^c") |
         str_detect(label, "^indirect_")) %>% 
  rename(ci_upper = ci.upper,
         ci_lower = ci.lower) %>% 
  mutate(parameter = case_when(
    label == "a1" ~ "P1(T) Extraversion -> P2(T) Extraversion",
    label == "a2" ~ "P1(T) Agreeableness -> P2(T) Agreeableness",
    label == "a3" ~ "P1(T) Conscientiousness -> P2(T) Conscientiousness",
    label == "a4" ~ "P1(T) Neuroticism -> P2(T) Neuroticism",
    label == "a5" ~ "P1(T) Openness -> P2(T) Openness",
    label == "a6" ~ "P1(T) Honesty-Propriety -> P2(T) Honesty-Propriety",
    label == "b1" ~ "P2(T) Extraversion -> P2(T) Leadership",
    label == "b2" ~ "P2(T) Agreeableness -> P2(T) Leadership",
    label == "b3" ~ "P2(T) Conscientiousness -> P2(T) Leadership",
    label == "b4" ~ "P2(T) Neuroticism -> P2(T) Leadership",
    label == "b5" ~ "P2(T) Openness -> P2(T) Leadership",
    label == "b6" ~ "P2(T) Honesty-Propriety -> P2(T) Leadership",
    label == "c1" ~ "P1(T) Extraversion -> P2(T) Leadership",
    label == "c2" ~ "P1(T) Agreeableness -> P2(T) Leadership",
    label == "c3" ~ "P1(T) Conscientiousness -> P2(T) Leadership",
    label == "c4" ~ "P1(T) Neuroticism -> P2(T) Leadership",
    label == "c5" ~ "P1(T) Openness -> P2(T) Leadership",
    label == "c6" ~ "P1(T) Honesty-Propriety -> P2(T) Leadership",
    label == "indirect_ex" ~ "Indirect Extraversion",
    label == "indirect_ag" ~ "Indirect Agreeableness",
    label == "indirect_co" ~ "Indirect Conscientiousness",
    label == "indirect_ne" ~ "Indirect Neuroticism",
    label == "indirect_op" ~ "Indirect Openness ",
    label == "indirect_hp" ~ "Indirect Honesty-Propriety"),
    label = fct_relevel(label,
                             "a1",
                             "a2",
                             "a3",
                             "a4",
                             "a5",
                             "a6",
                             "b1",
                             "b2",
                             "b3",
                             "b4",
                             "b5",
                             "b6",
                             "c1",
                             "c2",
                             "c3",
                             "c4",
                             "c5",
                             "c6",
                             "indirect_ex",
                             "indirect_ag",
                             "indirect_co",
                             "indirect_ne",
                             "indirect_op",
                             "indirect_hp"),
        pvalue = ifelse(pvalue >= .001, 
                        str_pad(str_replace(round(pvalue, 3),
                                            "0.", "."), 4, 
                                side = "right", pad ="0"),  
                        "< .001"),
        est = round(est, 2),
        est = ifelse(str_detect(est, "\\..$"), paste0(est, "0"), 
                   ifelse(str_detect(est, "^0$"), paste0(est, ".00"), est)),
        est = cell_spec(est, "html", 
                            bold = ifelse(abs(z) > 1.96, TRUE, FALSE)),
        ci_lower = round(ci_lower, 2),
        ci_lower = ifelse(str_detect(ci_lower, "\\..$"), paste0(ci_lower, "0"), 
                   ifelse(str_detect(ci_lower, "^0$"), paste0(ci_lower, ".00"), ci_lower)),
        ci_lower = cell_spec(ci_lower, "html", 
                            bold = ifelse(abs(z) > 1.96, TRUE, FALSE)),
        ci_upper = round(ci_upper, 2),
        ci_upper = ifelse(str_detect(ci_upper, "\\..$"), paste0(ci_upper, "0"), 
                   ifelse(str_detect(ci_upper, "^0$"), paste0(ci_upper, ".00"), ci_upper)),
        ci_upper = cell_spec(ci_upper, "html",
                            bold = ifelse(abs(z) > 1.96, TRUE, FALSE)),
        z = round(z, 2)) %>% 
  arrange(label) %>% 
  select(parameter, est, ci_lower, ci_upper, z, pvalue) %>% 
  distinct() %>% 
  knitr::kable(caption = "All Big Six and Leadership Mediation Results",
              format = "html", escape = F) %>% 
 kable_styling("striped", full_width = F) %>% 
 pack_rows("Hearsay Consensus Path", 1, 6) %>% 
 pack_rows("Hearsay Reputations of Big Six to Leadership", 7, 12) %>% 
 pack_rows("Direct Reputations of Big Six to Hearsay Reputations of Leadership", 13, 18) %>% 
 pack_rows("Indirect (Mediated) Effects", 19, 24)
```
Looks like the b paths (P2(T) trait -> P2(T) leadership) and the indirect effects are significant for Extraversion, Conscientiousness, and Openness. Suggests that P2's perception of T's leadership is determined by how Extraverted, Agreeable, and Conscientious they think T is, which in turn is affected by P1's perception of T on those dimensions.

## Effects of reputation on friendship judgments.

### Pre-Registered Mediation Model: Agreeableness to Friendship

This is a pre-registerd analysis looking at whether P1's perception of thr target's Agreeableness influences P2's perception of the target's Agreeableness, which in turn influences their perception of the target's friendship potential. It was pre-registered as hypothesis 4 on OSF.

```{r H4_path_model}
agreeableness_affil_med_model_h4 <-'
# Model for A-B-C triad
B_C_contextitem_goodfriend ~ b*B_C_agreeableness + c*A_C_agreeableness
B_C_agreeableness ~ a*A_C_agreeableness

# Model for C-D-A triad
D_A_contextitem_goodfriend ~ b*D_A_agreeableness + c*C_A_agreeableness
D_A_agreeableness ~ a*C_A_agreeableness

# variances
B_C_contextitem_goodfriend ~~ v_P2_gl*B_C_contextitem_goodfriend
D_A_contextitem_goodfriend ~~ v_P2_gl*D_A_contextitem_goodfriend
B_C_agreeableness ~~ v_P2*B_C_agreeableness
D_A_agreeableness ~~ v_P2*D_A_agreeableness
A_C_agreeableness ~~ v_P1*A_C_agreeableness
C_A_agreeableness ~~ v_P1*C_A_agreeableness

# intercepts
B_C_contextitem_goodfriend ~ int_P2_gl*1
D_A_contextitem_goodfriend ~ int_P2_gl*1
B_C_agreeableness ~ int_P2*1
D_A_agreeableness ~ int_P2*1
A_C_agreeableness ~ int_P1*1
C_A_agreeableness ~ int_P1*1

# indirect (mediated) effect
indirecteffect := a*b
'
fit_agreeableness_affil_med_model_h4 <-sem(agreeableness_affil_med_model_h4, 
                                            data = study2, 
                                            missing="FIML", 
                                            se="bootstrap", 
                                            fixed.x=TRUE)

summary(fit_agreeableness_affil_med_model_h4)
```

#### Table for Agreeableness to Friendship Mediation model
```{r agree_friendship_med_model_tbl}
parameterestimates(fit_agreeableness_affil_med_model_h4) %>%
  as.data.frame() %>% 
  filter(label == "a" |
         label == "b" |
         label == "c" |
         label == "indirecteffect") %>% 
  rename(ci_upper = ci.upper,
         ci_lower = ci.lower) %>% 
  mutate(parameter = case_when(label == "b" ~ "P2(T) Agreeableness -> P2(T) Friendship",
                              label == "c" ~ "P1(T) Agreeableness -> P2(T) Friendship",
                              label == "a" ~ "P1(T) Agreeableness -> P2(T) Agreeableness",
                              label == "indirecteffect" ~ "Mediated Effect"),
         label == fct_relevel(label,
                             "a",
                             "b",
                             "c"),
        pvalue = ifelse(pvalue >= .001, 
                        str_pad(str_replace(round(pvalue, 3),
                                            "0.", "."), 4, 
                                side = "right", pad ="0"),  
                        "< .001"),
        est = round(est, 2),
        est = ifelse(str_detect(est, "\\..$"), paste0(est, "0"), 
                   ifelse(str_detect(est, "^0$"), paste0(est, ".00"), est)),
        est = cell_spec(est, "html", 
                            bold = ifelse(abs(z) > 1.96, TRUE, FALSE)),
        ci_lower = round(ci_lower, 2),
        ci_lower = ifelse(str_detect(ci_lower, "\\..$"), paste0(ci_lower, "0"), 
                   ifelse(str_detect(ci_lower, "^0$"), paste0(ci_lower, ".00"), ci_lower)),
        ci_lower = cell_spec(ci_lower, "html", 
                            bold = ifelse(abs(z) > 1.96, TRUE, FALSE)),
        ci_upper = round(ci_upper, 2),
        ci_upper = ifelse(str_detect(ci_upper, "\\..$"), paste0(ci_upper, "0"), 
                   ifelse(str_detect(ci_upper, "^0$"), paste0(ci_upper, ".00"), ci_upper)),
        ci_upper = cell_spec(ci_upper, "html",
                            bold = ifelse(abs(z) > 1.96, TRUE, FALSE)),
        z = round(z, 2)) %>% 
  arrange(label) %>% 
  select(parameter, est, ci_lower, ci_upper, z, pvalue) %>% 
  distinct() %>% 
  knitr::kable(caption = "Agreeableness and Friendship Mediation Results",
              format = "html", escape = F) %>% 
 kable_styling("striped", full_width = F) 
  
```

Looks like our results are consistent with our hypothesis: P2's perception of the target's friendship is infleunced by their perception of the target's Agreeableness, which is in turn influenced by P1's perception of the target's Agreeableness.

### Alternative Model : All Big Six and Friendship

```{r h3_all6_friendship_multi_med_model}
big6_affil_multi_med_model_h3alt <-'
# Model for A-B-C triad
B_C_contextitem_goodfriend ~ b1*B_C_extraversion + b2*B_C_agreeableness + b3*B_C_conscientiousness + b4*B_C_neuroticism + b5*B_C_openness + b6*B_C_hp + c1*A_C_extraversion + c2*A_C_agreeableness + c3*A_C_conscientiousness + c4*A_C_neuroticism + c5*A_C_openness + c6*A_C_hp 

B_C_extraversion      ~ a1*A_C_extraversion
B_C_agreeableness     ~ a2*A_C_agreeableness
B_C_conscientiousness ~ a3*A_C_conscientiousness
B_C_neuroticism       ~ a4*A_C_neuroticism
B_C_openness          ~ a5*A_C_openness
B_C_hp                ~ a6*A_C_hp

# Model for C-D-A triad
D_A_contextitem_goodfriend ~ b1*D_A_extraversion + b2*D_A_agreeableness + b3*D_A_conscientiousness + b4*D_A_neuroticism + b5*D_A_openness + b6*D_A_hp + c1*C_A_extraversion + c2*C_A_agreeableness + c3*C_A_conscientiousness + c4*C_A_neuroticism + c5*C_A_openness + c6*C_A_hp 

D_A_extraversion      ~ a1*C_A_extraversion
D_A_agreeableness     ~ a2*C_A_agreeableness
D_A_conscientiousness ~ a3*C_A_conscientiousness
D_A_neuroticism       ~ a4*C_A_neuroticism
D_A_openness          ~ a5*C_A_openness
D_A_hp                ~ a6*C_A_hp

# variances
B_C_contextitem_goodfriend ~~ v_P2_gf*B_C_contextitem_goodfriend
D_A_contextitem_goodfriend ~~ v_P2_gf*D_A_contextitem_goodfriend
B_C_extraversion ~~ v_P2_ex*B_C_extraversion
D_A_extraversion ~~ v_P2_ex*D_A_extraversion
B_C_agreeableness ~~ v_P2_ag*B_C_agreeableness
D_A_agreeableness ~~ v_P2_ag*D_A_agreeableness
B_C_conscientiousness ~~ v_P2_co*B_C_conscientiousness
D_A_conscientiousness ~~ v_P2_co*D_A_conscientiousness
B_C_neuroticism ~~ v_P2_ne*B_C_neuroticism
D_A_neuroticism ~~ v_P2_ne*D_A_neuroticism
B_C_openness ~~ v_P2_op*B_C_openness
D_A_openness ~~ v_P2_op*D_A_openness
B_C_hp ~~ v_P2_hp*B_C_hp
D_A_hp ~~ v_P2_hp*D_A_hp

A_C_extraversion ~~ v_P1_ex*A_C_extraversion
C_A_extraversion ~~ v_P1_ex*C_A_extraversion
A_C_agreeableness ~~ v_P1_ag*A_C_agreeableness
C_A_agreeableness ~~ v_P1_ag*C_A_agreeableness
A_C_conscientiousness ~~ v_P1_co*A_C_conscientiousness
C_A_conscientiousness ~~ v_P1_co*C_A_conscientiousness
A_C_neuroticism ~~ v_P1_ne*A_C_neuroticism
C_A_neuroticism ~~ v_P1_ne*C_A_neuroticism
A_C_openness ~~ v_P1_op*A_C_openness
C_A_openness ~~ v_P1_op*C_A_openness
A_C_hp ~~ v_P1_hp*A_C_hp
C_A_hp ~~ v_P1_hp*C_A_hp


# intercepts

B_C_contextitem_goodfriend ~ int_P2_gf*1
D_A_contextitem_goodfriend ~ int_P2_gf*1
B_C_extraversion ~ int_P2_ex*1
D_A_extraversion ~ int_P2_ex*1
B_C_agreeableness ~ int_P2_ag*1
D_A_agreeableness ~ int_P2_ag*1
B_C_conscientiousness ~ int_P2_co*1
D_A_conscientiousness ~ int_P2_co*1
B_C_neuroticism ~ int_P2_ne*1
D_A_neuroticism ~ int_P2_ne*1
B_C_openness ~ int_P2_op*1
D_A_openness ~ int_P2_op*1
B_C_hp ~ int_P2_hp*1
D_A_hp ~ int_P2_hp*1

A_C_extraversion ~ int_P1_ex*1
C_A_extraversion ~ int_P1_ex*1
A_C_agreeableness ~ int_P1_ag*1
C_A_agreeableness ~ int_P1_ag*1
A_C_conscientiousness ~ int_P1_co*1
C_A_conscientiousness ~ int_P1_co*1
A_C_neuroticism ~ int_P1_ne*1
C_A_neuroticism ~ int_P1_ne*1
A_C_openness ~ int_P1_op*1
C_A_openness ~ int_P1_op*1
A_C_hp ~ int_P1_hp*1
C_A_hp ~ int_P1_hp*1


# indirect (mediated) effect
indirect_ex := a1*b1
indirect_ag := a2*b2
indirect_co := a3*b3
indirect_ne := a4*b4
indirect_op := a5*b5
indirect_hp := a6*b6
'
fit_big6_affil_multi_med_model_h3alt <-sem(big6_affil_multi_med_model_h3alt, 
                                            data = study2, 
                                            missing = "FIML", 
                                            se = "bootstrap", 
                                            fixed.x = TRUE)

summary(fit_big6_affil_multi_med_model_h3alt)
```

#### Table for Big Six to Friendship Mediation model
```{r bigsix_friend_med_model_tbl}
parameterestimates(fit_big6_affil_multi_med_model_h3alt) %>%
  as.data.frame() %>% 
  filter(str_detect(label, "^a") |
         str_detect(label, "^b") |
         str_detect(label, "^c") |
         str_detect(label, "^indirect_")) %>% 
  rename(ci_upper = ci.upper,
         ci_lower = ci.lower) %>% 
  mutate(parameter = case_when(
    label == "a1" ~ "P1(T) Extraversion -> P2(T) Extraversion",
    label == "a2" ~ "P1(T) Agreeableness -> P2(T) Agreeableness",
    label == "a3" ~ "P1(T) Conscientiousness -> P2(T) Conscientiousness",
    label == "a4" ~ "P1(T) Neuroticism -> P2(T) Neuroticism",
    label == "a5" ~ "P1(T) Openness -> P2(T) Openness",
    label == "a6" ~ "P1(T) Honesty-Propriety -> P2(T) Honesty-Propriety",
    label == "b1" ~ "P2(T) Extraversion -> P2(T) Friendship",
    label == "b2" ~ "P2(T) Agreeableness -> P2(T) Friendship",
    label == "b3" ~ "P2(T) Conscientiousness -> P2(T) Friendship",
    label == "b4" ~ "P2(T) Neuroticism -> P2(T) Friendship",
    label == "b5" ~ "P2(T) Openness -> P2(T) Friendship",
    label == "b6" ~ "P2(T) Honesty-Propriety -> P2(T) Friendship",
    label == "c1" ~ "P1(T) Extraversion -> P2(T) Friendship",
    label == "c2" ~ "P1(T) Agreeableness -> P2(T) Friendship",
    label == "c3" ~ "P1(T) Conscientiousness -> P2(T) Friendship",
    label == "c4" ~ "P1(T) Neuroticism -> P2(T) Friendship",
    label == "c5" ~ "P1(T) Openness -> P2(T) Friendship",
    label == "c6" ~ "P1(T) Honesty-Propriety -> P2(T) Friendship",
    label == "indirect_ex" ~ "Indirect Extraversion",
    label == "indirect_ag" ~ "Indirect Agreeableness",
    label == "indirect_co" ~ "Indirect Conscientiousness",
    label == "indirect_ne" ~ "Indirect Neuroticism",
    label == "indirect_op" ~ "Indirect Openness ",
    label == "indirect_hp" ~ "Indirect Honesty-Propriety"),
    label = fct_relevel(label,
                             "a1",
                             "a2",
                             "a3",
                             "a4",
                             "a5",
                             "a6",
                             "b1",
                             "b2",
                             "b3",
                             "b4",
                             "b5",
                             "b6",
                             "c1",
                             "c2",
                             "c3",
                             "c4",
                             "c5",
                             "c6",
                             "indirect_ex",
                             "indirect_ag",
                             "indirect_co",
                             "indirect_ne",
                             "indirect_op",
                             "indirect_hp"),
        pvalue = ifelse(pvalue >= .001, 
                        str_pad(str_replace(round(pvalue, 3),
                                            "0.", "."), 4, 
                                side = "right", pad ="0"),  
                        "< .001"),
        est = round(est, 2),
        est = ifelse(str_detect(est, "\\..$"), paste0(est, "0"), 
                   ifelse(str_detect(est, "^0$"), paste0(est, ".00"), est)),
        est = cell_spec(est, "html", 
                            bold = ifelse(abs(z) > 1.96, TRUE, FALSE)),
        ci_lower = round(ci_lower, 2),
        ci_lower = ifelse(str_detect(ci_lower, "\\..$"), paste0(ci_lower, "0"), 
                   ifelse(str_detect(ci_lower, "^0$"), paste0(ci_lower, ".00"), ci_lower)),
        ci_lower = cell_spec(ci_lower, "html", 
                            bold = ifelse(abs(z) > 1.96, TRUE, FALSE)),
        ci_upper = round(ci_upper, 2),
        ci_upper = ifelse(str_detect(ci_upper, "\\..$"), paste0(ci_upper, "0"), 
                   ifelse(str_detect(ci_upper, "^0$"), paste0(ci_upper, ".00"), ci_upper)),
        ci_upper = cell_spec(ci_upper, "html",
                            bold = ifelse(abs(z) > 1.96, TRUE, FALSE)),
        z = round(z, 2)) %>% 
  arrange(label) %>% 
  select(parameter, est, ci_lower, ci_upper, z, pvalue) %>% 
  distinct() %>% 
  knitr::kable(caption = "All Big Six and Friendship Mediation Results",
              format = "html", escape = F) %>% 
 kable_styling("striped", full_width = F) %>% 
 pack_rows("Hearsay Consensus Path", 1, 6) %>% 
 pack_rows("Hearsay Reputations of Big Six to Friendship", 7, 12) %>% 
 pack_rows("Direct Reputations of Big Six to Hearsay Reputations of Friendship", 13, 18) %>% 
 pack_rows("Indirect (Mediated) Effects", 19, 24)
```

Looks like the b path (P2(T) trait -> P2(T) friendship) and indirect effect are only significant for Agreeableness; the remaining Big Six did not have a significant b path or indirect effect (Openness was close, but no cigar). Suggests that P2's perception of T's friendship is determined by how Agreeable they think T is, which in turn is affected by P1's perception of T's Agreeableness. 

## Model Comparisons to Assess Justifiability of Pooling across Studies

### Agreeableness
```{r agree_integrated_models}
agree_integrated_noeq <- rep_auto_group_mod(integrated, 
                                        p1_reports = c("A_C_agreeableness", "C_A_agreeableness"),
                                        p2_reports = c("B_C_agreeableness", "D_A_agreeableness"),
                                        target_self = c("C_C_agreeableness", "A_A_agreeableness"),
                                        group_mod = "study",
                                        groups_eql = "none",
                                        params_eql = "none",
                                        use_labs = TRUE)

agree_integrated_alleq <- rep_auto_group_mod(integrated, 
                                        p1_reports = c("A_C_agreeableness", "C_A_agreeableness"),
                                        p2_reports = c("B_C_agreeableness", "D_A_agreeableness"),
                                        target_self = c("C_C_agreeableness", "A_A_agreeableness"),
                                        group_mod = "study",
                                        groups_eql = "all",
                                        params_eql = "all",
                                        use_labs = TRUE)

int_model_comp_agree <- anova(agree_integrated_noeq,
                              agree_integrated_alleq)
```

### Conscientiousness
```{r consc_integrated_models}
consc_integrated_noeq <- rep_auto_group_mod(integrated, 
                                        p1_reports = c("A_C_conscientiousness", "C_A_conscientiousness"),
                                        p2_reports = c("B_C_conscientiousness", "D_A_conscientiousness"),
                                        target_self = c("C_C_conscientiousness", "A_A_conscientiousness"),
                                        group_mod = "study",
                                        groups_eql = "none",
                                        params_eql = "none",
                                        use_labs = TRUE)

consc_integrated_alleq <- rep_auto_group_mod(integrated, 
                                        p1_reports = c("A_C_conscientiousness", "C_A_conscientiousness"),
                                        p2_reports = c("B_C_conscientiousness", "D_A_conscientiousness"),
                                        target_self = c("C_C_conscientiousness", "A_A_conscientiousness"),
                                        group_mod = "study",
                                        groups_eql = "all",
                                        params_eql = "all",
                                        use_labs = TRUE)
int_model_comp_consc <- anova(consc_integrated_noeq,
                              consc_integrated_alleq)
```

### Honesty-Propriety
```{r hp_integrated_models}
hp_integrated_noeq <- rep_auto_group_mod(integrated, 
                                        p1_reports = c("A_C_hp", "C_A_hp"),
                                        p2_reports = c("B_C_hp", "D_A_hp"),
                                        target_self = c("C_C_hp", "A_A_hp"),
                                        group_mod = "study",
                                        groups_eql = "none",
                                        params_eql = "none",
                                        use_labs = TRUE)

hp_integrated_alleq <- rep_auto_group_mod(integrated, 
                                        p1_reports = c("A_C_hp", "C_A_hp"),
                                        p2_reports = c("B_C_hp", "D_A_hp"),
                                        target_self = c("C_C_hp", "A_A_hp"),
                                        group_mod = "study",
                                        groups_eql = "all",
                                        params_eql = "all",
                                        use_labs = TRUE)

int_model_comp_hp <- anova(hp_integrated_noeq,
                           hp_integrated_alleq)
```

### Neuroticism
```{r neuro_integrated_models}
neuro_integrated_noeq <- rep_auto_group_mod(integrated, 
                                        p1_reports = c("A_C_neuroticism", "C_A_neuroticism"),
                                        p2_reports = c("B_C_neuroticism", "D_A_neuroticism"),
                                        target_self = c("C_C_neuroticism", "A_A_neuroticism"),
                                        group_mod = "study",
                                        groups_eql = "none",
                                        params_eql = "none",
                                        use_labs = TRUE)

neuro_integrated_alleq <- rep_auto_group_mod(integrated, 
                                        p1_reports = c("A_C_neuroticism", "C_A_neuroticism"),
                                        p2_reports = c("B_C_neuroticism", "D_A_neuroticism"),
                                        target_self = c("C_C_neuroticism", "A_A_neuroticism"),
                                        group_mod = "study",
                                        groups_eql = "all",
                                        params_eql = "all",
                                        use_labs = TRUE)

int_model_comp_neuro <- anova(neuro_integrated_noeq,
                              neuro_integrated_alleq)
```

### Extraversion
```{r extra_integrated_models}
extra_integrated_noeq <- rep_auto_group_mod(integrated, 
                                        p1_reports = c("A_C_extraversion", "C_A_extraversion"),
                                        p2_reports = c("B_C_extraversion", "D_A_extraversion"),
                                        target_self = c("C_C_extraversion", "A_A_extraversion"),
                                        group_mod = "study",
                                        groups_eql = "none",
                                        params_eql = "none",
                                        use_labs = TRUE)

extra_integrated_alleq <- rep_auto_group_mod(integrated, 
                                        p1_reports = c("A_C_extraversion", "C_A_extraversion"),
                                        p2_reports = c("B_C_extraversion", "D_A_extraversion"),
                                        target_self = c("C_C_extraversion", "A_A_extraversion"),
                                        group_mod = "study",
                                        groups_eql = "all",
                                        params_eql = "all",
                                        use_labs = TRUE)
int_model_comp_extra <- anova(extra_integrated_noeq,
                              extra_integrated_alleq)
```

### Openness
```{r open_integrated_models}
open_integrated_noeq <- rep_auto_group_mod(integrated, 
                                        p1_reports = c("A_C_openness", "C_A_openness"),
                                        p2_reports = c("B_C_openness", "D_A_openness"),
                                        target_self = c("C_C_openness", "A_A_openness"),
                                        group_mod = "study",
                                        groups_eql = "none",
                                        params_eql = "none",
                                        use_labs = TRUE)

open_integrated_alleq <- rep_auto_group_mod(integrated, 
                                        p1_reports = c("A_C_openness", "C_A_openness"),
                                        p2_reports = c("B_C_openness", "D_A_openness"),
                                        target_self = c("C_C_openness", "A_A_openness"),
                                        group_mod = "study",
                                        groups_eql = "all",
                                        params_eql = "all",
                                        use_labs = TRUE)

int_model_comp_open <- anova(open_integrated_noeq,
                             open_integrated_alleq)
```

### Table of Comparisons

```{r integrated_model_comp_tbl}
model_comp_domains <- ls()[str_detect(ls(), "int_model_comp")] %>% 
  str_split("_") %>% 
  sapply(., function(df, position){df[position]}, 4)

ls()[str_detect(ls(), "int_model_comp")] %>% 
  lapply(FUN = get) %>%
  map(mutate, delt_aic = AIC - lag(AIC) ,
         delt_bic = BIC - lag(BIC) ) %>% 
  map_df(slice, -1) %>% 
  rename(pvalue = `Pr(>Chisq)`) %>% 
  mutate(pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 4, side = "right", pad ="0"),  
                         "< .001"),
         domain = model_comp_domains,
         domain = case_when(domain == "agree" ~ "Agreeableness",
                            domain == "consc" ~ "Conscientiousness",
                            domain == "hp" ~ "Honesty-Propriety",
                            domain == "neuro" ~ "Neuroticism",
                            domain == "extra" ~ "Extraversion",
                            domain == "open" ~ "Openness"),
         domain = fct_relevel(domain,
                              "Agreeableness",
                              "Conscientiousness",
                              "Honesty-Propriety",
                              "Neuroticism",
                              "Extraversion",
                              "Openness")) %>% 
  arrange(domain) %>% 
  select(domain, `Df diff`, `Chisq diff`, pvalue, delt_aic, delt_bic) %>% 
  knitr::kable(caption = "Model Comparison Results for Integrating across Studies",
               digits = c(NA, 0, 2, 3, 2, 2),
               format = "html", escape = FALSE) %>% 
  kable_styling("striped", full_width = F)
  
```

## Study 2 & Integrated Relative elevation

```{r int_elevation_tables}
int_model_names <- ls()[str_detect(ls(), "integrated_[:alpha:]*eq$")]

int_model_domain <- int_model_names %>% 
  str_extract("[:alpha:]*")

int_rel_el_tables <- 
  int_model_names %>% 
  map(get) %>%
  map(ez_elevation_group_table) %>% 
  enframe() %>% 
  mutate(name = int_model_names) %>% 
  unnest() %>% 
  separate(name, c("domain", "temp1", "temp2")) %>% 
  select(-temp1, -temp2) %>% 
  mutate(domain = case_when(domain == "agree" ~ "Agreeableness",
                            domain == "consc" ~ "Conscientiousness",
                            domain == "hp" ~ "Honesty-Propriety",
                            domain == "neuro" ~ "Neuroticism",
                            domain == "extra" ~ "Extraversion",
                            domain == "open" ~ "Openness"),
         tbl = rep(c("elevation_table", "pooled_m_sd"), 12)) %>% 
    split(.$tbl) %>% 
    map(unnest) %>% 
    map(mutate, group_label = case_when(
      group_label == "eql" ~ "Integrated",
      group_label == "grp1" ~ "Study 1",
      group_label == "grp2" ~ "Study 2"
    )) %>% 
    map(mutate, domain = fct_relevel(domain, 
                       "Agreeableness",
                       "Conscientiousness",
                       "Honesty-Propriety",
                       "Neuroticism",
                       "Extraversion",
                       "Openness")) %>%
    map(mutate, study = fct_relevel(group_label,
                                          "Study 1",
                                          "Study 2",
                                          "Integrated")) %>% 
    map(arrange, domain, group_label) %>% 
    map(select, study, everything(), -tbl, -group_label)
```

### Study 2 & Integrated Elevation Table
And now a table of the elevation results from the Study 2 and the integrated model, like Table 3 in the manuscript.
```{r int_rel_el_table}
int_rel_el_tables[[1]] %>% 
  arrange(parameter) %>% 
  mutate(pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 4, side = "right", pad ="0"),  
                         "< .001"),
         raw_diff = round(raw_diff, 2),
         raw_diff = ifelse(str_detect(raw_diff, "\\..$"), paste0(raw_diff, "0"), 
                    ifelse(str_detect(raw_diff, "^0$"), paste0(raw_diff, ".00"), raw_diff)),
         raw_diff = cell_spec(raw_diff, "html", 
                              color = ifelse(raw_diff < 0, "red", "blue"),
                               bold = ifelse(abs(z) >= 1.96, TRUE, FALSE)),
         ci_upper = round(ci_upper, 2),
         ci_upper = ifelse(str_detect(ci_upper, "\\..$"), paste0(ci_upper, "0"), 
                    ifelse(str_detect(ci_upper, "^0$"), paste0(ci_upper, ".00"), ci_upper)),
         ci_upper = cell_spec(ci_upper, "html", 
                              color = ifelse(ci_upper < 0, "red", "blue"),
                              bold = ifelse(abs(z) >= 1.96, TRUE, FALSE)),
         ci_lower = round(ci_lower, 2),
         ci_lower = ifelse(str_detect(ci_lower, "\\..$"), paste0(ci_lower, "0"), 
                    ifelse(str_detect(ci_lower, "^0$"), paste0(ci_lower, ".00"), ci_lower)),
         ci_lower = cell_spec(ci_lower, "html", 
                              color = ifelse(ci_lower < 0, "red", "blue"),
                              bold = ifelse(abs(z) >= 1.96, TRUE, FALSE)),
         cohen_d = round(cohen_d, 2),
         cohen_d = ifelse(str_detect(cohen_d, "\\..$"), paste0(cohen_d, "0"), 
                    ifelse(str_detect(cohen_d, "^0$"), paste0(cohen_d, ".00"), cohen_d)),
         cohen_d = cell_spec(cohen_d, "html", 
                             color = ifelse(cohen_d < 0, "red", "blue"),
                             bold = ifelse(abs(z) >= 1.96, TRUE, FALSE)),
         z = round(z, 2)) %>% 
  arrange(desc(study)) %>% 
  filter(study != "Study 1") %>% 
  select(-study) %>% 
  knitr::kable(caption = "Integrated Relative Elevation Results",
               format = "html", escape = F) %>%
  kable_styling("striped", full_width = F) %>% 
  footnote(general = "Blue = Positive Difference; Red = Negative Difference; bold = p < .05") %>% 
  pack_rows("Integrated", 1, 18) %>%
  pack_rows("Study 2", 19, 36)
```
### Study 2 & Integrated Means & SDs
And here is a table of pooled means and standard deviations for ratings, similar to Supplemental Table S10.
```{r int_pooled_m_sd_tbl}
int_rel_el_tables[[2]] %>% 
  # reordering the variables
  select(study, domain, perceiver, target, mean, sd) %>% 
  unite(rating, perceiver, target, sep = " (") %>% 
  mutate(rating = str_c(rating, ")"),
         rating = str_to_upper(rating),
         mean = round(mean, 2),
         mean = str_pad(mean, width = 4, side = "right", pad = 0),
         sd = round(sd, 2),
         sd = str_pad(sd, width = 4, side = "right", pad = 0),) %>% 
  unite(value, mean, sd, sep = " (") %>% 
  mutate(value = paste0(value, ")")) %>% 
  rename(`M (SD)` = value) %>% 
  spread(rating, `M (SD)`) %>% 
  filter(study != "Study 1") %>% 
  arrange(desc(study)) %>% 
  select(domain, `T (T)`, everything(), -study) %>% 
  rename(`M (SD)` = `P1 (T)`,
         `M (SD)` = `P2 (T)`,
         `M (SD)` = `T (T)`) %>% 
  knitr::kable(caption = "Integrated & Study 2 Pooled Means & SDs",
               format = "html", escape = F) %>%
  kable_styling("striped", full_width = F) %>%
  add_header_above(c(" " = 1, "T (T)" = 1, "P1(T)" = 1, "P2 (T)" = 1)) %>% 
  footnote("T(T) = the target’s self-report. P1(T) = P1’s rating of the target. P2(T) = P2’s rating of the target.") %>% 
  pack_rows("Integrated", 1, 6) %>% 
  pack_rows("Study 2", 7, 12)
```

##  Study 2 & Integrated differential hearsay consensus, accuracy, and direct accuracy

```{r int_diff_results}
int_diff_results <- 
  int_model_names %>% 
  map(get) %>%
  map(ez_differential_group_table) %>% 
  enframe() %>% 
  mutate(name = int_model_names) %>% 
  unnest() %>% 
  separate(name, c("domain", "temp1", "temp2")) %>% 
  select(-temp1, -temp2) %>% 
  mutate(domain = case_when(domain == "agree" ~ "Agreeableness",
                            domain == "consc" ~ "Conscientiousness",
                            domain == "hp" ~ "Honesty-Propriety",
                            domain == "neuro" ~ "Neuroticism",
                            domain == "extra" ~ "Extraversion",
                            domain == "open" ~ "Openness")) %>% 
    mutate(study = case_when(
      is.na(group_label) ~ "Integrated",
      group_label == "grp1" ~ "Study 1",
      group_label == "grp2" ~ "Study 2"),
      domain = fct_relevel(domain, 
                       "Agreeableness",
                       "Conscientiousness",
                       "Honesty-Propriety",
                       "Neuroticism",
                       "Extraversion",
                       "Openness"),
      study = fct_relevel(study,
                          "Study 1",
                          "Study 2",
                          "Integrated"),
      parameter = fct_relevel(parameter,
                              "hearsay consensus",
                              "hearsay accuracy",
                              "direct accuracy")) %>% 
    select(study, parameter, domain, everything(), -group_label)
```

### Table of Study 2 & Integrated Differential Results
```{r int_diff_results_tbl}
int_diff_results %>% 
  mutate(r = round(r, 2),
         r = ifelse(str_detect(r, "\\..$"), paste0(r, "0"), 
                    ifelse(str_detect(r, "^0$"), paste0(r, ".00"), r)),
         r = cell_spec(r, "html", 
                             bold = ifelse(ci_lower > 0, TRUE, FALSE)),
         ci_lower = round(ci_lower, 2),
         ci_lower = ifelse(str_detect(ci_lower, "\\..$"), paste0(ci_lower, "0"), 
                    ifelse(str_detect(ci_lower, "^0$"), paste0(ci_lower, ".00"), ci_lower)),
         ci_lower = cell_spec(ci_lower, "html", 
                             bold = ifelse(ci_lower > 0, TRUE, FALSE)),
         ci_upper = round(ci_upper, 2),
         ci_upper = ifelse(str_detect(ci_upper, "\\..$"), paste0(ci_upper, "0"), 
                    ifelse(str_detect(ci_upper, "^0$"), paste0(ci_upper, ".00"), ci_upper)),
         ci_upper = cell_spec(ci_upper, "html",
                             bold = ifelse(pvalue == "< .001", TRUE,
                                    ifelse(as.numeric(pvalue) < .05, TRUE, FALSE))),
         pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 4, side = "right", pad ="0"),  
                         "< .001")) %>% 
  arrange(desc(study), parameter, domain) %>% 
  filter(study != "Study 1") %>% 
  select(-study) %>% 
  knitr::kable(caption = "Study 2 & Integrated Differrntial Consensus & Accuracy Results",
              format = "html", escape = F) %>% 
  kable_styling("striped", full_width = F) %>% 
  pack_rows("Integrated", 1, 18) %>% 
  pack_rows("Study 2", 19, 36)
```

```{r int_diff_results_plot_data}
int_diff_plot_data <- as_tibble(cbind(domain = c("Agreeableness",
                                                 "Conscientiousness",
                                                 "Honesty-Propriety",
                                                 "Neuroticism",
                                                 "Extraversion",
                                                 "Openness"),
  # Connelly & Ones (2010) inter-rater r
  co2010_irr = c(.31, .35, NA, .32, .50, .29),
  # Connelly & Ones (2010) self-other agreement
  co2010_soa_1 = c(.09, .13, NA, .08, .22, .12),
  # Connelly & Ones (2010) self-other agreement again
  # since we'll use it for direct and hearsay accuracy
  co2010_soa_2 = c(.09, .13, NA, .08, .22, .12))) %>% 
  gather(source, r, -domain) %>% 
  mutate(parameter = 
           case_when(source == "co2010_irr" ~ "Hearsay Consensus",
                     source == "co2010_soa_1" ~ "Hearsay Accuracy",
                     source == "co2010_soa_2" ~ "Direct Accuracy"),
         source = str_replace_all(source, 
                                  "co2010_irr", 
                                  "Connelly & Ones (2010) Study 1"),
         source = str_replace_all(source, 
                                  "co2010_soa_1", 
                                  "Connelly & Ones (2010) Study 2"),
         source = str_replace_all(source, 
                                  "co2010_soa_2", 
                                  "Connelly & Ones (2010) Study 2"),
         r = as.double(r),
         # To make plotting easier, I'm going to make two
         # variables ci.lower and ci.upper (to match the structure of our estimates)
         # and I'll make them equal to the point estimate (since that is all we have for
         # uncorrected estimates).
         ci_lower = r,
         ci_upper = r) %>% 
  full_join(mutate(int_diff_results,
                   parameter = str_to_title(parameter),
                   source = study)) %>%
  select(-study) %>% 
  # Re-level to have plots in the order we want them in
  mutate(domain = fct_relevel(factor(domain),
                              "Openness",
                              "Extraversion",
                              "Neuroticism",
                              "Honesty-Propriety",
                              "Conscientiousness",
                              "Agreeableness"),
         focus = ifelse(source == "Integrated", "low", "high"),
         source = fct_relevel(source, 
                              "Connelly & Ones (2010) Study 1",
                              "Connelly & Ones (2010) Study 2",
                              "Integrated",
                              "Study 2",
                              "Study 1"))
```


Finally, this writes out thed individual plots (Figure 8, 9, and S4) to a folder called 'plots' in the current directory. I'll also make a 3-panelled plot, which contains Figures 8, 9, and S4 all in one plot for the markdown.
```{r int_making_plots4MS_and_ppt, fig.height=11, fig.width=12}
plot_names <- c(1:3)
i <- 1
for (each in unique(int_diff_plot_data$parameter)){
  i <- i + 1
  plot_name <- paste("plot", i, sep = "_")
  plot_names[i] <- plot_name
  plot_data <- filter(int_diff_plot_data, parameter == each)
  assign(plot_name, ggplot(data = plot_data, 
                 aes(x = domain, y = r, shape = source, alpha = focus)) + 
  geom_pointrange(aes(ymin = ci_lower, ymax = ci_upper),
                  position = position_dodge(width = 1),
                  size = 1) + 
  labs(title = NULL,
       x = NULL,
       y = "r") +
  theme_rep_manuscript +
  geom_hline(yintercept = 0, linetype = 2, alpha = .5) + 
    scale_y_continuous(limit=c(-0.3, .80))+
    scale_alpha_discrete(range = c(.3, 1)) +
  coord_flip()+
  guides(shape = guide_legend(reverse = TRUE),
         alpha = FALSE) +
  scale_shape_manual(values = c(16,12, 0, 3)))
  ggsave(paste0("Plots/Integrated_", print(each), ".png"), get(plot_name),
         device = "png", height = 5, width = 9.5)
  ggsave(paste0("Plots/Integrated_", print(each), "_4ppt.png"), get(plot_name),
         device = "png", height = 5, width = 9.5, scale = .80)
}

plot_names <- plot_names[str_detect(plot_names, "^plot")]
cowplot::plot_grid(get(plot_names[1]), get(plot_names[2]),
                   get(plot_names[3]), nrow = 3,
                   labels = c("Hearsay Consensus",
                              "Hearsay Accuracy",
                              "Direct Accuracy"), 
                   label_y = 1.01,
                   label_x = .06)
```

## Study 2 & Integrated Distinctive Hearsay Accuracy

### Agreeableness
The models and results for distinctive hearsay accuracy of Agreeableness. 

#### Check Justifiability of Pooling
```{r distinctive_ha_agreeableness_model1_uneq}
# specify the model
agreeableness_distinctive_hearsay_accuracy_uneq <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_agreeableness ~ c(DHA_s1, DHA_s2)*B_C_agreeableness + c(DDA_s1, DDA_s2)*A_C_agreeableness
A_A_agreeableness ~ c(DHA_s1, DHA_s2)*D_A_agreeableness + c(DDA_s1, DDA_s2)*C_A_agreeableness

# hearsay consensus
B_C_agreeableness ~~ c(HC_s1, HC_s2)*A_C_agreeableness
D_A_agreeableness ~~ c(HC_s1, HC_s2)*C_A_agreeableness

# variances (pooled)
C_C_agreeableness ~~ c(v_s_s1, v_s_s2)*C_C_agreeableness
A_A_agreeableness ~~ c(v_s_s1, v_s_s2)*A_A_agreeableness
A_C_agreeableness ~~ c(v_p1_s1, v_p1_s2)*A_C_agreeableness
C_A_agreeableness ~~ c(v_p1_s1, v_p1_s2)*C_A_agreeableness
B_C_agreeableness ~~ c(v_p2_s1, v_p2_s2)*B_C_agreeableness
D_A_agreeableness ~~ c(v_p2_s1, v_p2_s2)*D_A_agreeableness

# intercepts (pooled)
C_C_agreeableness ~ c(int_s_s1, int_s_s2)*1
A_A_agreeableness ~ c(int_s_s1, int_s_s2)*1
B_C_agreeableness ~ c(int_p1_s1, int_p1_s2)*1
D_A_agreeableness ~ c(int_p1_s1, int_p1_s2)*1
A_C_agreeableness ~ c(int_p2_s1, int_p2_s2)*1
C_A_agreeableness ~ c(int_p2_s1, int_p2_s2)*1
'
# fit the model
fit_agreeableness_distinctive_hearsay_accuracy_uneq <- 
  sem(agreeableness_distinctive_hearsay_accuracy_uneq,
      data = integrated, 
      group = "study",
      # missing = FIML critical due to planned missingness
      missing="FIML")
```

```{r distinctive_ha_agreeableness_model2_eq}
# specify the model
agreeableness_distinctive_hearsay_accuracy_eq <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_agreeableness ~ c(DHA, DHA)*B_C_agreeableness + c(DDA, DDA)*A_C_agreeableness
A_A_agreeableness ~ c(DHA, DHA)*D_A_agreeableness + c(DDA, DDA)*C_A_agreeableness

# hearsay consensus
B_C_agreeableness ~~ c(HC, HC)*A_C_agreeableness
D_A_agreeableness ~~ c(HC, HC)*C_A_agreeableness

# variances (pooled)
C_C_agreeableness ~~ c(v_s, v_s)*C_C_agreeableness
A_A_agreeableness ~~ c(v_s, v_s)*A_A_agreeableness
A_C_agreeableness ~~ c(v_p1, v_p1)*A_C_agreeableness
C_A_agreeableness ~~ c(v_p1, v_p1)*C_A_agreeableness
B_C_agreeableness ~~ c(v_p2, v_p2)*B_C_agreeableness
D_A_agreeableness ~~ c(v_p2, v_p2)*D_A_agreeableness

# intercepts (pooled)
C_C_agreeableness ~ c(int_s, int_s)*1
A_A_agreeableness ~ c(int_s, int_s)*1
B_C_agreeableness ~ c(int_p1, int_p1)*1
D_A_agreeableness ~ c(int_p1, int_p1)*1
A_C_agreeableness ~ c(int_p2, int_p2)*1
C_A_agreeableness ~ c(int_p2, int_p2)*1
'
# fit the model
fit_agreeableness_distinctive_hearsay_accuracy_eq <- 
  sem(agreeableness_distinctive_hearsay_accuracy_eq,
      data = integrated, 
      group = "study",
      # missing = FIML critical due to planned missingness
      missing = "FIML")
```

##### Compare Models

```{r agreeableness_model_comp}
agree_dha_model_comp <- anova(fit_agreeableness_distinctive_hearsay_accuracy_uneq,
      fit_agreeableness_distinctive_hearsay_accuracy_eq)

agree_dha_model_comp
```
AIC and BIC are better for the model pooling across studies. and $\chi^2$ is not significant. All signs point to pooling across studies.

#### Full Model Results

```{r agreeableness_model_results}
summary(fit_agreeableness_distinctive_hearsay_accuracy_eq, 
        standardized = TRUE)
```

Looks like the path from P2(T) -> T(T) is not significant, suggesting that P2s do not achieve distinctive hearsay accuracy for Agreeableness.

#### Table of Results

Now get a table of the three main results we want:

* Distinctive Hearsay Accuracy
* Distinctive Direct Accuracy
* Hearsay Consensus

```{r agreeableness_DHA_table}
agree_dha_uneq_results <- 
  fit_agreeableness_distinctive_hearsay_accuracy_uneq@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs, group) %>% 
  left_join(standardizedsolution(fit_agreeableness_distinctive_hearsay_accuracy_uneq)) %>% 
  separate(label, c("label", "study"), sep = -3) %>% 
  mutate(study = str_remove(study, "_"),
         study = case_when(study == "s1" ~ "Study 1",
                           study == "s2" ~ "Study 2"))  %>% 
  select(study, label, est.std, ci.lower, ci.upper, pvalue)

agree_dha_eq_results <- 
  fit_agreeableness_distinctive_hearsay_accuracy_eq@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs) %>% 
  left_join(standardizedsolution(fit_agreeableness_distinctive_hearsay_accuracy_eq)) %>% 
  mutate(study = "Integrated") %>% 
  select(study, label, est.std, ci.lower, ci.upper, pvalue)

agree_dha_table <- agree_dha_uneq_results %>% 
  full_join(agree_dha_eq_results) %>% 
  filter(label == "DHA" |
         label == "DDA" |
         label == "HC") %>% 
  distinct(label, study, .keep_all = TRUE) %>% 
  mutate(label = str_replace_all(label, "DHA", "Distinctive Hearsay Accuracy"),
         label = str_replace_all(label, "DDA", "Distinctive Direct Accuracy"),
         label = str_replace_all(label, "HC", "Hearsay Consensus")) %>%
  select(study, label, est.std, ci.lower, ci.upper, pvalue)
```

### Conscientiousness
The model and results for distinctive hearsay accuracy of Conscientiousness. 

#### Check Justifiability of Pooling
```{r distinctive_ha_conscientiousness_model1_uneq}
# specify the model
conscientiousness_distinctive_hearsay_accuracy_uneq <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_conscientiousness ~ c(DHA_s1, DHA_s2)*B_C_conscientiousness + c(DDA_s1, DDA_s2)*A_C_conscientiousness
A_A_conscientiousness ~ c(DHA_s1, DHA_s2)*D_A_conscientiousness + c(DDA_s1, DDA_s2)*C_A_conscientiousness

# hearsay consensus
B_C_conscientiousness ~~ c(HC_s1, HC_s2)*A_C_conscientiousness
D_A_conscientiousness ~~ c(HC_s1, HC_s2)*C_A_conscientiousness

# variances (pooled)
C_C_conscientiousness ~~ c(v_s_s1, v_s_s2)*C_C_conscientiousness
A_A_conscientiousness ~~ c(v_s_s1, v_s_s2)*A_A_conscientiousness
A_C_conscientiousness ~~ c(v_p1_s1, v_p1_s2)*A_C_conscientiousness
C_A_conscientiousness ~~ c(v_p1_s1, v_p1_s2)*C_A_conscientiousness
B_C_conscientiousness ~~ c(v_p2_s1, v_p2_s2)*B_C_conscientiousness
D_A_conscientiousness ~~ c(v_p2_s1, v_p2_s2)*D_A_conscientiousness

# intercepts (pooled)
C_C_conscientiousness ~ c(int_s_s1, int_s_s2)*1
A_A_conscientiousness ~ c(int_s_s1, int_s_s2)*1
B_C_conscientiousness ~ c(int_p1_s1, int_p1_s2)*1
D_A_conscientiousness ~ c(int_p1_s1, int_p1_s2)*1
A_C_conscientiousness ~ c(int_p2_s1, int_p2_s2)*1
C_A_conscientiousness ~ c(int_p2_s1, int_p2_s2)*1
'
# fit the model
fit_conscientiousness_distinctive_hearsay_accuracy_uneq <- 
  sem(conscientiousness_distinctive_hearsay_accuracy_uneq,
      data = integrated, 
      group = "study",
      # missing = FIML critical due to planned missingness
      missing="FIML")
```

```{r distinctive_ha_conscientiousness_model2_eq}
# specify the model
conscientiousness_distinctive_hearsay_accuracy_eq <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_conscientiousness ~ c(DHA, DHA)*B_C_conscientiousness + c(DDA, DDA)*A_C_conscientiousness
A_A_conscientiousness ~ c(DHA, DHA)*D_A_conscientiousness + c(DDA, DDA)*C_A_conscientiousness

# hearsay consensus
B_C_conscientiousness ~~ c(HC, HC)*A_C_conscientiousness
D_A_conscientiousness ~~ c(HC, HC)*C_A_conscientiousness

# variances (pooled)
C_C_conscientiousness ~~ c(v_s, v_s)*C_C_conscientiousness
A_A_conscientiousness ~~ c(v_s, v_s)*A_A_conscientiousness
A_C_conscientiousness ~~ c(v_p1, v_p1)*A_C_conscientiousness
C_A_conscientiousness ~~ c(v_p1, v_p1)*C_A_conscientiousness
B_C_conscientiousness ~~ c(v_p2, v_p2)*B_C_conscientiousness
D_A_conscientiousness ~~ c(v_p2, v_p2)*D_A_conscientiousness

# intercepts (pooled)
C_C_conscientiousness ~ c(int_s, int_s)*1
A_A_conscientiousness ~ c(int_s, int_s)*1
B_C_conscientiousness ~ c(int_p1, int_p1)*1
D_A_conscientiousness ~ c(int_p1, int_p1)*1
A_C_conscientiousness ~ c(int_p2, int_p2)*1
C_A_conscientiousness ~ c(int_p2, int_p2)*1
'
# fit the model
fit_conscientiousness_distinctive_hearsay_accuracy_eq <- 
  sem(conscientiousness_distinctive_hearsay_accuracy_eq,
      data = integrated, 
      group = "study",
      # missing = FIML critical due to planned missingness
      missing = "FIML")
```

##### Compare Models

```{r conscientiousness_model_comp}
consc_dha_model_comp <- anova(fit_conscientiousness_distinctive_hearsay_accuracy_uneq,
      fit_conscientiousness_distinctive_hearsay_accuracy_eq)

consc_dha_model_comp
```
AIC and BIC are better for the model pooling across studies. and $\chi^2$ is not significant. All signs point to pooling across studies.

#### Full Model Results

```{r conscientiousness_model_results}
summary(fit_conscientiousness_distinctive_hearsay_accuracy_eq, 
        standardized = TRUE)
```

Looks like the path from P2(T) -> T(T) is not significant, suggesting that P2s do not achieve distinctive hearsay accuracy for Conscientiousness.

#### Table of Results

Now get a table of the three main results we want:

* Distinctive Hearsay Accuracy
* Distinctive Direct Accuracy
* Hearsay Consensus

```{r conscientiousness_DHA_table}
consc_dha_uneq_results <- 
  fit_conscientiousness_distinctive_hearsay_accuracy_uneq@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs, group) %>% 
  left_join(standardizedsolution(fit_conscientiousness_distinctive_hearsay_accuracy_uneq)) %>% 
  separate(label, c("label", "study"), sep = -3) %>% 
  mutate(study = str_remove(study, "_"),
         study = case_when(study == "s1" ~ "Study 1",
                           study == "s2" ~ "Study 2"))  %>% 
  select(study, label, est.std, ci.lower, ci.upper, pvalue)

consc_dha_eq_results <- 
  fit_conscientiousness_distinctive_hearsay_accuracy_eq@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs) %>% 
  left_join(standardizedsolution(fit_conscientiousness_distinctive_hearsay_accuracy_eq)) %>% 
  mutate(study = "Integrated") %>% 
  select(study, label, est.std, ci.lower, ci.upper, pvalue)

consc_dha_table <- consc_dha_uneq_results %>% 
  full_join(consc_dha_eq_results) %>% 
  filter(label == "DHA" |
         label == "DDA" |
         label == "HC") %>% 
  distinct(label, study, .keep_all = TRUE) %>% 
  mutate(label = str_replace_all(label, "DHA", "Distinctive Hearsay Accuracy"),
         label = str_replace_all(label, "DDA", "Distinctive Direct Accuracy"),
         label = str_replace_all(label, "HC", "Hearsay Consensus")) %>%
  select(study, label, est.std, ci.lower, ci.upper, pvalue)
```

### Honesty-Propriety
The model and results for distinctive hearsay accuracy of Honesty-Propriety. 

#### Check Justifiability of Pooling
```{r distinctive_ha_hp_model1_uneq}
# specify the model
hp_distinctive_hearsay_accuracy_uneq <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_hp ~ c(DHA_s1, DHA_s2)*B_C_hp + c(DDA_s1, DDA_s2)*A_C_hp
A_A_hp ~ c(DHA_s1, DHA_s2)*D_A_hp + c(DDA_s1, DDA_s2)*C_A_hp

# hearsay consensus
B_C_hp ~~ c(HC_s1, HC_s2)*A_C_hp
D_A_hp ~~ c(HC_s1, HC_s2)*C_A_hp

# variances (pooled)
C_C_hp ~~ c(v_s_s1, v_s_s2)*C_C_hp
A_A_hp ~~ c(v_s_s1, v_s_s2)*A_A_hp
A_C_hp ~~ c(v_p1_s1, v_p1_s2)*A_C_hp
C_A_hp ~~ c(v_p1_s1, v_p1_s2)*C_A_hp
B_C_hp ~~ c(v_p2_s1, v_p2_s2)*B_C_hp
D_A_hp ~~ c(v_p2_s1, v_p2_s2)*D_A_hp

# intercepts (pooled)
C_C_hp ~ c(int_s_s1, int_s_s2)*1
A_A_hp ~ c(int_s_s1, int_s_s2)*1
B_C_hp ~ c(int_p1_s1, int_p1_s2)*1
D_A_hp ~ c(int_p1_s1, int_p1_s2)*1
A_C_hp ~ c(int_p2_s1, int_p2_s2)*1
C_A_hp ~ c(int_p2_s1, int_p2_s2)*1
'
# fit the model
fit_hp_distinctive_hearsay_accuracy_uneq <- 
  sem(hp_distinctive_hearsay_accuracy_uneq,
      data = integrated, 
      group = "study",
      # missing = FIML critical due to planned missingness
      missing="FIML")
```

```{r distinctive_ha_hp_model2_eq}
# specify the model
hp_distinctive_hearsay_accuracy_eq <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_hp ~ c(DHA, DHA)*B_C_hp + c(DDA, DDA)*A_C_hp
A_A_hp ~ c(DHA, DHA)*D_A_hp + c(DDA, DDA)*C_A_hp

# hearsay consensus
B_C_hp ~~ c(HC, HC)*A_C_hp
D_A_hp ~~ c(HC, HC)*C_A_hp

# variances (pooled)
C_C_hp ~~ c(v_s, v_s)*C_C_hp
A_A_hp ~~ c(v_s, v_s)*A_A_hp
A_C_hp ~~ c(v_p1, v_p1)*A_C_hp
C_A_hp ~~ c(v_p1, v_p1)*C_A_hp
B_C_hp ~~ c(v_p2, v_p2)*B_C_hp
D_A_hp ~~ c(v_p2, v_p2)*D_A_hp

# intercepts (pooled)
C_C_hp ~ c(int_s, int_s)*1
A_A_hp ~ c(int_s, int_s)*1
B_C_hp ~ c(int_p1, int_p1)*1
D_A_hp ~ c(int_p1, int_p1)*1
A_C_hp ~ c(int_p2, int_p2)*1
C_A_hp ~ c(int_p2, int_p2)*1
'
# fit the model
fit_hp_distinctive_hearsay_accuracy_eq <- 
  sem(hp_distinctive_hearsay_accuracy_eq,
      data = integrated, 
      group = "study",
      # missing = FIML critical due to planned missingness
      missing = "FIML")
```

##### Compare Models

```{r hp_dha_model_comp}
hp_dha_model_comp <- anova(fit_hp_distinctive_hearsay_accuracy_uneq,
      fit_hp_distinctive_hearsay_accuracy_eq)

hp_dha_model_comp
```
AIC and BIC are better for the model pooling across studies. and $\chi^2$ is not significant. All signs point to pooling across studies.

#### Full Model Results

```{r hp_model_results}
summary(fit_hp_distinctive_hearsay_accuracy_eq, 
        standardized = TRUE)
```

Looks like the path from P2(T) -> T(T) is not significant, suggesting that P2s do not achieve distinctive hearsay accuracy for Honesty-Propriety.

#### Table of Results

Now get a table of the three main results we want:

* Distinctive Hearsay Accuracy
* Distinctive Direct Accuracy
* Hearsay Consensus

```{r hp_DHA_table}
hp_dha_uneq_results <- 
  fit_hp_distinctive_hearsay_accuracy_uneq@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs, group) %>% 
  left_join(standardizedsolution(fit_hp_distinctive_hearsay_accuracy_uneq)) %>% 
  separate(label, c("label", "study"), sep = -3) %>% 
  mutate(study = str_remove(study, "_"),
         study = case_when(study == "s1" ~ "Study 1",
                           study == "s2" ~ "Study 2"))  %>% 
  select(study, label, est.std, ci.lower, ci.upper, pvalue)

hp_dha_eq_results <- 
  fit_hp_distinctive_hearsay_accuracy_eq@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs) %>% 
  left_join(standardizedsolution(fit_hp_distinctive_hearsay_accuracy_eq)) %>% 
  mutate(study = "Integrated") %>% 
  select(study, label, est.std, ci.lower, ci.upper, pvalue)

hp_dha_table <- hp_dha_uneq_results %>% 
  full_join(hp_dha_eq_results) %>% 
  filter(label == "DHA" |
         label == "DDA" |
         label == "HC") %>% 
  distinct(label, study, .keep_all = TRUE) %>% 
  mutate(label = str_replace_all(label, "DHA", "Distinctive Hearsay Accuracy"),
         label = str_replace_all(label, "DDA", "Distinctive Direct Accuracy"),
         label = str_replace_all(label, "HC", "Hearsay Consensus")) %>%
  select(study, label, est.std, ci.lower, ci.upper, pvalue)
```


### Neuroticism
The model and results for distinctive hearsay accuracy of Neuroticism. 

#### Check Justifiability of Pooling
```{r distinctive_ha_neuroticism_model1_uneq}
# specify the model
neuroticism_distinctive_hearsay_accuracy_uneq <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_neuroticism ~ c(DHA_s1, DHA_s2)*B_C_neuroticism + c(DDA_s1, DDA_s2)*A_C_neuroticism
A_A_neuroticism ~ c(DHA_s1, DHA_s2)*D_A_neuroticism + c(DDA_s1, DDA_s2)*C_A_neuroticism

# hearsay consensus
B_C_neuroticism ~~ c(HC_s1, HC_s2)*A_C_neuroticism
D_A_neuroticism ~~ c(HC_s1, HC_s2)*C_A_neuroticism

# variances (pooled)
C_C_neuroticism ~~ c(v_s_s1, v_s_s2)*C_C_neuroticism
A_A_neuroticism ~~ c(v_s_s1, v_s_s2)*A_A_neuroticism
A_C_neuroticism ~~ c(v_p1_s1, v_p1_s2)*A_C_neuroticism
C_A_neuroticism ~~ c(v_p1_s1, v_p1_s2)*C_A_neuroticism
B_C_neuroticism ~~ c(v_p2_s1, v_p2_s2)*B_C_neuroticism
D_A_neuroticism ~~ c(v_p2_s1, v_p2_s2)*D_A_neuroticism

# intercepts (pooled)
C_C_neuroticism ~ c(int_s_s1, int_s_s2)*1
A_A_neuroticism ~ c(int_s_s1, int_s_s2)*1
B_C_neuroticism ~ c(int_p1_s1, int_p1_s2)*1
D_A_neuroticism ~ c(int_p1_s1, int_p1_s2)*1
A_C_neuroticism ~ c(int_p2_s1, int_p2_s2)*1
C_A_neuroticism ~ c(int_p2_s1, int_p2_s2)*1
'
# fit the model
fit_neuroticism_distinctive_hearsay_accuracy_uneq <- 
  sem(neuroticism_distinctive_hearsay_accuracy_uneq,
      data = integrated, 
      group = "study",
      # missing = FIML critical due to planned missingness
      missing="FIML")
```

```{r distinctive_ha_neuroticism_model2_eq}
# specify the model
neuroticism_distinctive_hearsay_accuracy_eq <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_neuroticism ~ c(DHA, DHA)*B_C_neuroticism + c(DDA, DDA)*A_C_neuroticism
A_A_neuroticism ~ c(DHA, DHA)*D_A_neuroticism + c(DDA, DDA)*C_A_neuroticism

# hearsay consensus
B_C_neuroticism ~~ c(HC, HC)*A_C_neuroticism
D_A_neuroticism ~~ c(HC, HC)*C_A_neuroticism

# variances (pooled)
C_C_neuroticism ~~ c(v_s, v_s)*C_C_neuroticism
A_A_neuroticism ~~ c(v_s, v_s)*A_A_neuroticism
A_C_neuroticism ~~ c(v_p1, v_p1)*A_C_neuroticism
C_A_neuroticism ~~ c(v_p1, v_p1)*C_A_neuroticism
B_C_neuroticism ~~ c(v_p2, v_p2)*B_C_neuroticism
D_A_neuroticism ~~ c(v_p2, v_p2)*D_A_neuroticism

# intercepts (pooled)
C_C_neuroticism ~ c(int_s, int_s)*1
A_A_neuroticism ~ c(int_s, int_s)*1
B_C_neuroticism ~ c(int_p1, int_p1)*1
D_A_neuroticism ~ c(int_p1, int_p1)*1
A_C_neuroticism ~ c(int_p2, int_p2)*1
C_A_neuroticism ~ c(int_p2, int_p2)*1
'
# fit the model
fit_neuroticism_distinctive_hearsay_accuracy_eq <- 
  sem(neuroticism_distinctive_hearsay_accuracy_eq,
      data = integrated, 
      group = "study",
      # missing = FIML critical due to planned missingness
      missing = "FIML")
```

##### Compare Models

```{r neuroticism_model_comp}
neuro_dha_model_comp <- anova(fit_neuroticism_distinctive_hearsay_accuracy_uneq,
      fit_neuroticism_distinctive_hearsay_accuracy_eq)

neuro_dha_model_comp
```
AIC and BIC are better for the model pooling across studies. and $\chi^2$ is not significant. All signs point to pooling across studies.

#### Full Model Results

```{r neuroticism_model_results}
summary(fit_neuroticism_distinctive_hearsay_accuracy_eq, 
        standardized = TRUE)
```

Looks like the path from P2(T) -> T(T) is not significant, suggesting that P2s do not achieve distinctive hearsay accuracy for Neuroticism.

#### Table of Results

Now get a table of the three main results we want:

* Distinctive Hearsay Accuracy
* Distinctive Direct Accuracy
* Hearsay Consensus

```{r neuroticism_DHA_table}
neuro_dha_uneq_results <- 
  fit_neuroticism_distinctive_hearsay_accuracy_uneq@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs, group) %>% 
  left_join(standardizedsolution(fit_neuroticism_distinctive_hearsay_accuracy_uneq)) %>% 
  separate(label, c("label", "study"), sep = -3) %>% 
  mutate(study = str_remove(study, "_"),
         study = case_when(study == "s1" ~ "Study 1",
                           study == "s2" ~ "Study 2"))  %>% 
  select(study, label, est.std, ci.lower, ci.upper, pvalue)

neuro_dha_eq_results <- 
  fit_neuroticism_distinctive_hearsay_accuracy_eq@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs) %>% 
  left_join(standardizedsolution(fit_neuroticism_distinctive_hearsay_accuracy_eq)) %>% 
  mutate(study = "Integrated") %>% 
  select(study, label, est.std, ci.lower, ci.upper, pvalue)

neuro_dha_table <- neuro_dha_uneq_results %>% 
  full_join(neuro_dha_eq_results) %>% 
  filter(label == "DHA" |
         label == "DDA" |
         label == "HC") %>% 
  distinct(label, study, .keep_all = TRUE) %>% 
  mutate(label = str_replace_all(label, "DHA", "Distinctive Hearsay Accuracy"),
         label = str_replace_all(label, "DDA", "Distinctive Direct Accuracy"),
         label = str_replace_all(label, "HC", "Hearsay Consensus")) %>%
  select(study, label, est.std, ci.lower, ci.upper, pvalue)
```

### Extraversion
The model and results for distinctive hearsay accuracy of Extraversion. 

#### Check Justifiability of Pooling
```{r distinctive_ha_extraversion_model1_uneq}
# specify the model
extraversion_distinctive_hearsay_accuracy_uneq <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_extraversion ~ c(DHA_s1, DHA_s2)*B_C_extraversion + c(DDA_s1, DDA_s2)*A_C_extraversion
A_A_extraversion ~ c(DHA_s1, DHA_s2)*D_A_extraversion + c(DDA_s1, DDA_s2)*C_A_extraversion

# hearsay consensus
B_C_extraversion ~~ c(HC_s1, HC_s2)*A_C_extraversion
D_A_extraversion ~~ c(HC_s1, HC_s2)*C_A_extraversion

# variances (pooled)
C_C_extraversion ~~ c(v_s_s1, v_s_s2)*C_C_extraversion
A_A_extraversion ~~ c(v_s_s1, v_s_s2)*A_A_extraversion
A_C_extraversion ~~ c(v_p1_s1, v_p1_s2)*A_C_extraversion
C_A_extraversion ~~ c(v_p1_s1, v_p1_s2)*C_A_extraversion
B_C_extraversion ~~ c(v_p2_s1, v_p2_s2)*B_C_extraversion
D_A_extraversion ~~ c(v_p2_s1, v_p2_s2)*D_A_extraversion

# intercepts (pooled)
C_C_extraversion ~ c(int_s_s1, int_s_s2)*1
A_A_extraversion ~ c(int_s_s1, int_s_s2)*1
B_C_extraversion ~ c(int_p1_s1, int_p1_s2)*1
D_A_extraversion ~ c(int_p1_s1, int_p1_s2)*1
A_C_extraversion ~ c(int_p2_s1, int_p2_s2)*1
C_A_extraversion ~ c(int_p2_s1, int_p2_s2)*1
'
# fit the model
fit_extraversion_distinctive_hearsay_accuracy_uneq <- 
  sem(extraversion_distinctive_hearsay_accuracy_uneq,
      data = integrated, 
      group = "study",
      # missing = FIML critical due to planned missingness
      missing="FIML")
```

```{r distinctive_ha_extraversion_model2_eq}
# specify the model
extraversion_distinctive_hearsay_accuracy_eq <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_extraversion ~ c(DHA, DHA)*B_C_extraversion + c(DDA, DDA)*A_C_extraversion
A_A_extraversion ~ c(DHA, DHA)*D_A_extraversion + c(DDA, DDA)*C_A_extraversion

# hearsay consensus
B_C_extraversion ~~ c(HC, HC)*A_C_extraversion
D_A_extraversion ~~ c(HC, HC)*C_A_extraversion

# variances (pooled)
C_C_extraversion ~~ c(v_s, v_s)*C_C_extraversion
A_A_extraversion ~~ c(v_s, v_s)*A_A_extraversion
A_C_extraversion ~~ c(v_p1, v_p1)*A_C_extraversion
C_A_extraversion ~~ c(v_p1, v_p1)*C_A_extraversion
B_C_extraversion ~~ c(v_p2, v_p2)*B_C_extraversion
D_A_extraversion ~~ c(v_p2, v_p2)*D_A_extraversion

# intercepts (pooled)
C_C_extraversion ~ c(int_s, int_s)*1
A_A_extraversion ~ c(int_s, int_s)*1
B_C_extraversion ~ c(int_p1, int_p1)*1
D_A_extraversion ~ c(int_p1, int_p1)*1
A_C_extraversion ~ c(int_p2, int_p2)*1
C_A_extraversion ~ c(int_p2, int_p2)*1
'
# fit the model
fit_extraversion_distinctive_hearsay_accuracy_eq <- 
  sem(extraversion_distinctive_hearsay_accuracy_eq,
      data = integrated, 
      group = "study",
      # missing = FIML critical due to planned missingness
      missing = "FIML")
```

##### Compare Models

```{r extraversion_model_comp}
extra_dha_model_comp <- anova(fit_extraversion_distinctive_hearsay_accuracy_uneq,
      fit_extraversion_distinctive_hearsay_accuracy_eq)

extra_dha_model_comp
```
AIC and BIC are better for the model pooling across studies. and $\chi^2$ is not significant. All signs point to pooling across studies.

#### Full Model Results

```{r extraversion_model_results}
summary(fit_extraversion_distinctive_hearsay_accuracy_eq, 
        standardized = TRUE)
```

Looks like the path from P2(T) -> T(T) is not significant, suggesting that P2s do not achieve distinctive hearsay accuracy for Extraversion.

#### Table of Results

Now get a table of the three main results we want:

* Distinctive Hearsay Accuracy
* Distinctive Direct Accuracy
* Hearsay Consensus

```{r extraversion_DHA_table}
extra_dha_uneq_results <- 
  fit_extraversion_distinctive_hearsay_accuracy_uneq@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs, group) %>% 
  left_join(standardizedsolution(fit_extraversion_distinctive_hearsay_accuracy_uneq)) %>% 
  separate(label, c("label", "study"), sep = -3) %>% 
  mutate(study = str_remove(study, "_"),
         study = case_when(study == "s1" ~ "Study 1",
                           study == "s2" ~ "Study 2"))  %>% 
  select(study, label, est.std, ci.lower, ci.upper, pvalue)

extra_dha_eq_results <- 
  fit_extraversion_distinctive_hearsay_accuracy_eq@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs) %>% 
  left_join(standardizedsolution(fit_extraversion_distinctive_hearsay_accuracy_eq)) %>% 
  mutate(study = "Integrated") %>% 
  select(study, label, est.std, ci.lower, ci.upper, pvalue)

extra_dha_table <- extra_dha_uneq_results %>% 
  full_join(extra_dha_eq_results) %>% 
  filter(label == "DHA" |
         label == "DDA" |
         label == "HC") %>% 
  distinct(label, study, .keep_all = TRUE) %>% 
  mutate(label = str_replace_all(label, "DHA", "Distinctive Hearsay Accuracy"),
         label = str_replace_all(label, "DDA", "Distinctive Direct Accuracy"),
         label = str_replace_all(label, "HC", "Hearsay Consensus")) %>%
  select(study, label, est.std, ci.lower, ci.upper, pvalue)
```

### Openness
The model and results for distinctive hearsay accuracy of Openness. 

#### Full Model
```{r distinctive_ha_openness_model1_uneq}
# specify the model
openness_distinctive_hearsay_accuracy_uneq <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_openness ~ c(DHA_s1, DHA_s2)*B_C_openness + c(DDA_s1, DDA_s2)*A_C_openness
A_A_openness ~ c(DHA_s1, DHA_s2)*D_A_openness + c(DDA_s1, DDA_s2)*C_A_openness

# hearsay consensus
B_C_openness ~~ c(HC_s1, HC_s2)*A_C_openness
D_A_openness ~~ c(HC_s1, HC_s2)*C_A_openness

# variances (pooled)
C_C_openness ~~ c(v_s_s1, v_s_s2)*C_C_openness
A_A_openness ~~ c(v_s_s1, v_s_s2)*A_A_openness
A_C_openness ~~ c(v_p1_s1, v_p1_s2)*A_C_openness
C_A_openness ~~ c(v_p1_s1, v_p1_s2)*C_A_openness
B_C_openness ~~ c(v_p2_s1, v_p2_s2)*B_C_openness
D_A_openness ~~ c(v_p2_s1, v_p2_s2)*D_A_openness

# intercepts (pooled)
C_C_openness ~ c(int_s_s1, int_s_s2)*1
A_A_openness ~ c(int_s_s1, int_s_s2)*1
B_C_openness ~ c(int_p1_s1, int_p1_s2)*1
D_A_openness ~ c(int_p1_s1, int_p1_s2)*1
A_C_openness ~ c(int_p2_s1, int_p2_s2)*1
C_A_openness ~ c(int_p2_s1, int_p2_s2)*1
'
# fit the model
fit_openness_distinctive_hearsay_accuracy_uneq <- 
  sem(openness_distinctive_hearsay_accuracy_uneq,
      data = integrated, 
      group = "study",
      # missing = FIML critical due to planned missingness
      missing="FIML")
```

```{r distinctive_ha_openness_model2_eq}
# specify the model
openness_distinctive_hearsay_accuracy_eq <-'
# distinctive hearsay accuracy and distinctive direct accuracy paths
C_C_openness ~ c(DHA, DHA)*B_C_openness + c(DDA, DDA)*A_C_openness
A_A_openness ~ c(DHA, DHA)*D_A_openness + c(DDA, DDA)*C_A_openness

# hearsay consensus
B_C_openness ~~ c(HC, HC)*A_C_openness
D_A_openness ~~ c(HC, HC)*C_A_openness

# variances (pooled)
C_C_openness ~~ c(v_s, v_s)*C_C_openness
A_A_openness ~~ c(v_s, v_s)*A_A_openness
A_C_openness ~~ c(v_p1, v_p1)*A_C_openness
C_A_openness ~~ c(v_p1, v_p1)*C_A_openness
B_C_openness ~~ c(v_p2, v_p2)*B_C_openness
D_A_openness ~~ c(v_p2, v_p2)*D_A_openness

# intercepts (pooled)
C_C_openness ~ c(int_s, int_s)*1
A_A_openness ~ c(int_s, int_s)*1
B_C_openness ~ c(int_p1, int_p1)*1
D_A_openness ~ c(int_p1, int_p1)*1
A_C_openness ~ c(int_p2, int_p2)*1
C_A_openness ~ c(int_p2, int_p2)*1
'
# fit the model
fit_openness_distinctive_hearsay_accuracy_eq <- 
  sem(openness_distinctive_hearsay_accuracy_eq,
      data = integrated, 
      group = "study",
      # missing = FIML critical due to planned missingness
      missing = "FIML")
```

##### Compare Models

```{r openness_model_comp}
open_dha_model_comp <- anova(fit_openness_distinctive_hearsay_accuracy_uneq,
      fit_openness_distinctive_hearsay_accuracy_eq)
open_dha_model_comp
```
AIC and BIC are better for the model pooling across studies. and $\chi^2$ is not significant. All signs point to pooling across studies.

#### Full Model Results

```{r openness_model_results}
summary(fit_openness_distinctive_hearsay_accuracy_eq, 
        standardized = TRUE)
```

Looks like the path from P2(T) -> T(T) is significant. This suggests that P2s achieve some degree of distinctive hearsay accuracy for Openness (distinct from the accuracy they share with P1).

#### Table of Results

Now get a table of the three main results we want:

* Distinctive Hearsay Accuracy
* Distinctive Direct Accuracy
* Hearsay Consensus

```{r openness_DHA_table}
open_dha_uneq_results <- 
  fit_openness_distinctive_hearsay_accuracy_uneq@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs, group) %>% 
  left_join(standardizedsolution(fit_openness_distinctive_hearsay_accuracy_uneq)) %>% 
  separate(label, c("label", "study"), sep = -3) %>% 
  mutate(study = str_remove(study, "_"),
         study = case_when(study == "s1" ~ "Study 1",
                           study == "s2" ~ "Study 2"))  %>% 
  select(study, label, est.std, ci.lower, ci.upper, pvalue)

open_dha_eq_results <- 
  fit_openness_distinctive_hearsay_accuracy_eq@ParTable %>% 
  as.data.frame() %>% 
  select(label, lhs, op, rhs) %>% 
  left_join(standardizedsolution(fit_openness_distinctive_hearsay_accuracy_eq)) %>% 
  mutate(study = "Integrated") %>% 
  select(study, label, est.std, ci.lower, ci.upper, pvalue)

open_dha_table <- open_dha_uneq_results %>% 
  full_join(open_dha_eq_results) %>% 
  filter(label == "DHA" |
         label == "DDA" |
         label == "HC") %>% 
  distinct(label, study, .keep_all = TRUE) %>% 
  mutate(label = str_replace_all(label, "DHA", "Distinctive Hearsay Accuracy"),
         label = str_replace_all(label, "DDA", "Distinctive Direct Accuracy"),
         label = str_replace_all(label, "HC", "Hearsay Consensus")) %>%
  select(study, label, est.std, ci.lower, ci.upper, pvalue)
```

### Table of Integrated & Study 2 Distinctive Hearsay Accuracy Results

And finally a table of all of the results together. This is akin to Table 4 in the manuscript, but is organized a bit differently.
```{r int_table_dha_all}
agree_dha_table$domain = "Agreeableness"
consc_dha_table$domain = "Conscientiousness"
hp_dha_table$domain = "Honesty-Propriety"
neuro_dha_table$domain = "Neuroticism"
extra_dha_table$domain = "Extraversion"
open_dha_table$domain = "Openness"

agree_dha_table %>% 
  full_join(consc_dha_table) %>% 
  full_join(hp_dha_table) %>% 
  full_join(neuro_dha_table) %>% 
  full_join(extra_dha_table) %>% 
  full_join(open_dha_table) %>% 
  filter(study != "Study 1") %>% 
  mutate(parameter = fct_relevel(label,
                                 "Distinctive Hearsay Accuracy",
                                 "Distinctive Direct Accuracy",
                                 "Hearsay Consensus")) %>% 
  arrange(study, parameter) %>% 
  select(domain, parameter, est.std, ci.lower, ci.upper, pvalue) %>% 
  knitr::kable(digits = c(NA, NA, 2, 2, 2, 3),
               caption = "Distinctive Hearsay Accuracy: All Big Six") %>% 
  kable_styling("striped", full_width = F) %>% 
  pack_rows("Integrated", 1, 18) %>% 
  pack_rows("Study 2", 19, 36)
```

### Table of Model Comparisons for Pooling Studies for Distinctive Hearsay Accuracy (like Supplemental Table S11).

```{r dha_model_comp}
ls()[str_detect(ls(), "[:alpha:]*_dha_model_comp")] %>% 
  lapply(FUN = get) %>%
  map(mutate, delt_aic = AIC - lag(AIC) ,
         delt_bic = BIC - lag(BIC) ) %>% 
  map_df(slice, -1) %>% 
  rename(pvalue = `Pr(>Chisq)`) %>% 
  mutate(pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 4, side = "right", pad ="0"),  
                         "< .001"),
         domain = model_comp_domains,
         domain = case_when(domain == "agree" ~ "Agreeableness",
                            domain == "consc" ~ "Conscientiousness",
                            domain == "hp" ~ "Honesty-Propriety",
                            domain == "neuro" ~ "Neuroticism",
                            domain == "extra" ~ "Extraversion",
                            domain == "open" ~ "Openness")) %>% 
  select(domain, `Df diff`, `Chisq diff`, pvalue, delt_aic, delt_bic) %>% 
  knitr::kable(caption = "Model Comparison Results for Integrating across Studies for Distinctive Hearsay Accuracy (S11)",
               digits = c(NA, 0, 2, 3, 2, 2),
               format = "html", escape = FALSE) %>% 
  kable_styling("striped", full_width = F)
```

## Study 2 & Integrated: Extraversion Moderating Hearsay Consensus

I'll start with Extraversion moderating hearsay consensus, which predicts P1 reports from P2 reports, (Target, P1, and P2 ) self-reported Extraversion, and their interaction.

### Study 2 & Integrated:Target Extraversion

Starting with targets' self-reported Extraversion moderating hearsay consensus for each of the Big Six.

#### Agreeableness
##### Model Comparison
```{r Text_mod_hc_int_agree}
agree_Textmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXagree_CB", 
                                           "extraXagree_AD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

agree_Textmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXagree_CB", 
                                           "extraXagree_AD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_agree_Textmod_hc <- anova(agree_Textmod_hc_int_noeq,
      agree_Textmod_hc_int_alleq)
model_comp_agree_Textmod_hc
```

```{r summary_intmodel_Text_hc_agree}
summary(agree_Textmod_hc_int_alleq,
        standardized = TRUE)
```

#### Conscientiousness
##### Model Comparison
```{r Text_mod_hc_int_consc}
consc_Textmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXconsc_CB", 
                                           "extraXconsc_AD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

consc_Textmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXconsc_CB", 
                                           "extraXconsc_AD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_consc_Textmod_hc <- anova(consc_Textmod_hc_int_noeq,
                                     consc_Textmod_hc_int_alleq)
model_comp_consc_Textmod_hc
```

```{r summary_intmodel_Text_hc_consc}
summary(consc_Textmod_hc_int_alleq,
        standardized = TRUE)
```

#### Honesty-Propriety
##### Model Comparison
```{r Text_mod_hc_int_hp}
hp_Textmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXhp_CB", 
                                           "extraXhp_AD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

hp_Textmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXhp_CB", 
                                           "extraXhp_AD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_hp_Textmod_hc <- anova(hp_Textmod_hc_int_noeq,
                                  hp_Textmod_hc_int_alleq)
model_comp_hp_Textmod_hc
```

```{r summary_intmodel_Text_hc_hp}
summary(hp_Textmod_hc_int_alleq,
        standardized = TRUE)
```

#### Neuroticism
##### Model Comparison
```{r Text_mod_hc_int_neuro}
neuro_Textmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXneuro_CB", 
                                           "extraXneuro_AD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

neuro_Textmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXneuro_CB", 
                                           "extraXneuro_AD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_neuro_Textmod_hc <- anova(neuro_Textmod_hc_int_noeq,
                                     neuro_Textmod_hc_int_alleq)
model_comp_neuro_Textmod_hc
```

```{r summary_intmodel_Text_hc_neuro}
summary(neuro_Textmod_hc_int_alleq,
        standardized = TRUE)
```

#### Extraversion
##### Model Comparison
```{r Text_mod_hc_int_extra}
extra_Textmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXextra_CB", 
                                           "extraXextra_AD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

extra_Textmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXextra_CB", 
                                           "extraXextra_AD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_extra_Textmod_hc <- anova(extra_Textmod_hc_int_noeq,
                                     extra_Textmod_hc_int_alleq)
model_comp_extra_Textmod_hc
```

```{r summary_intmodel_Text_hc_extra}
summary(extra_Textmod_hc_int_alleq,
        standardized = TRUE)
```

#### Openness
##### Model Comparison
```{r Text_mod_hc_int_open}
open_Textmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXopen_CB", 
                                           "extraXopen_AD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

open_Textmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXopen_CB", 
                                           "extraXopen_AD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_open_Textmod_hc <- anova(open_Textmod_hc_int_noeq,
                                    open_Textmod_hc_int_alleq)
model_comp_open_Textmod_hc
```

```{r summary_intmodel_Text_hc_open}
summary(open_Textmod_hc_int_alleq,
        standardized = TRUE)
```
### Study 2 & Integrated: P1 Extraversion

Next, P1s' self-reported Extraversion moderating hearsay consensus for each of the Big Six.

#### Agreeableness
##### Model Comparison
```{r P1Ext_mod_hc_int_agree}
agree_P1extmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXagree_AB", 
                                           "extraXagree_CD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

agree_P1extmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXagree_AB", 
                                           "extraXagree_CD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_agree_P1extmod_hc <- anova(agree_P1extmod_hc_int_noeq,
                                      agree_P1extmod_hc_int_alleq)
model_comp_agree_P1extmod_hc
```

```{r summary_intmodel_P1ext_hc_agree}
summary(agree_P1extmod_hc_int_alleq,
        standardized = TRUE)
```

#### Conscientiousness
##### Model Comparison
```{r P1Ext_mod_hc_int_consc}
consc_P1extmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXconsc_AB", 
                                           "extraXconsc_CD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

consc_P1extmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXconsc_AB", 
                                           "extraXconsc_CD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_consc_P1extmod_hc <- anova(consc_P1extmod_hc_int_noeq,
      consc_P1extmod_hc_int_alleq)

model_comp_consc_P1extmod_hc
```

```{r summary_intmodel_P1ext_hc_consc}
summary(consc_P1extmod_hc_int_alleq,
        standardized = TRUE)
```

#### Honesty-Propriety
##### Model Comparison
```{r P1Ext_mod_hc_int_hp}
hp_P1extmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXhp_AB", 
                                           "extraXhp_CD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

hp_P1extmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXhp_AB", 
                                           "extraXhp_CD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_hp_P1extmod_hc <- anova(hp_P1extmod_hc_int_noeq,
                                   hp_P1extmod_hc_int_alleq)
model_comp_hp_P1extmod_hc
```

```{r summary_intmodel_P1ext_hc_hp}
summary(hp_P1extmod_hc_int_alleq,
        standardized = TRUE)
```

#### Neuroticism
##### Model Comparison
```{r P1Ext_mod_hc_int_neuro}
neuro_P1extmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXneuro_AB", 
                                           "extraXneuro_CD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

neuro_P1extmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXneuro_AB", 
                                           "extraXneuro_CD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_neuro_P1extmod_hc <- anova(neuro_P1extmod_hc_int_noeq,
                                      neuro_P1extmod_hc_int_alleq)
model_comp_neuro_P1extmod_hc
```

```{r summary_intmodel_P1ext_hc_neuro}
summary(neuro_P1extmod_hc_int_alleq,
        standardized = TRUE)
```

#### Extraversion
##### Model Comparison
```{r P1Ext_mod_hc_int_extra}
extra_P1extmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXextra_AB", 
                                           "extraXextra_CD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

extra_P1extmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXextra_AB", 
                                           "extraXextra_CD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_extra_P1extmod_hc <- anova(extra_P1extmod_hc_int_noeq,
                                      extra_P1extmod_hc_int_alleq)
model_comp_extra_P1extmod_hc 
```

```{r summary_intmodel_P1ext_hc_extra}
summary(extra_P1extmod_hc_int_alleq,
        standardized = TRUE)
```

#### Openness
##### Model Comparison
```{r P1Ext_mod_hc_int_open}
open_P1extmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXopen_AB", 
                                           "extraXopen_CD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

open_P1extmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXopen_AB", 
                                           "extraXopen_CD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_open_P1extmod_hc <- anova(open_P1extmod_hc_int_noeq,
                                     open_P1extmod_hc_int_alleq)
model_comp_open_P1extmod_hc
```

```{r summary_intmodel_P1ext_hc_open}
summary(open_P1extmod_hc_int_alleq,
        standardized = TRUE)
```
### Study 2 & Integrated: P2 Extraversion

Next, P2s' self-reported Extraversion moderating hearsay consensus for each of the Big Six.

#### Agreeableness
##### Model Comparison
```{r P2Ext_mod_hc_int_agree}
agree_P2extmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXagree_BB", 
                                           "extraXagree_DD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

agree_P2extmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXagree_BB", 
                                           "extraXagree_DD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_agree_P2extmod_hc <- anova(agree_P2extmod_hc_int_noeq,
                                      agree_P2extmod_hc_int_alleq)
model_comp_agree_P2extmod_hc
```

```{r summary_intmodel_P2ext_hc_agree}
summary(agree_P2extmod_hc_int_alleq,
        standardized = TRUE)
```

#### Conscientiousness
##### Model Comparison
```{r P2Ext_mod_hc_int_consc}
consc_P2extmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXconsc_BB", 
                                           "extraXconsc_DD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

consc_P2extmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXconsc_BB", 
                                           "extraXconsc_DD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_consc_P2extmod_hc <- anova(consc_P2extmod_hc_int_noeq,
                                      consc_P2extmod_hc_int_alleq)
model_comp_consc_P2extmod_hc
```

```{r summary_intmodel_P2ext_hc_consc}
summary(consc_P2extmod_hc_int_alleq,
        standardized = TRUE)
```

#### Honesty-Propriety
##### Model Comparison
```{r P2Ext_mod_hc_int_hp}
hp_P2extmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXhp_BB", 
                                           "extraXhp_DD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

hp_P2extmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXhp_BB", 
                                           "extraXhp_DD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_hp_P2extmod_hc <- anova(hp_P2extmod_hc_int_noeq,
                                   hp_P2extmod_hc_int_alleq)
model_comp_hp_P2extmod_hc
```

```{r summary_intmodel_P2ext_hc_hp}
summary(hp_P2extmod_hc_int_alleq,
        standardized = TRUE)
```

#### Neuroticism
##### Model Comparison
```{r P2Ext_mod_hc_int_neuro}
neuro_P2extmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXneuro_BB", 
                                           "extraXneuro_DD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

neuro_P2extmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXneuro_BB", 
                                           "extraXneuro_DD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_neuro_P2extmod_hc <- anova(neuro_P2extmod_hc_int_noeq,
                                     neuro_P2extmod_hc_int_alleq)
model_comp_neuro_P2extmod_hc
```

```{r summary_intmodel_P2ext_hc_neuro}
summary(neuro_P2extmod_hc_int_alleq,
        standardized = TRUE)
```

#### Extraversion
##### Model Comparison
```{r P2Ext_mod_hc_int_extra}
extra_P2extmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXextra_BB", 
                                           "extraXextra_DD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

extra_P2extmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXextra_BB", 
                                           "extraXextra_DD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_extra_P2extmod_hc <- anova(extra_P2extmod_hc_int_noeq,
                                     extra_P2extmod_hc_int_alleq)
model_comp_extra_P2extmod_hc
```

```{r summary_intmodel_P2ext_hc_extra}
summary(extra_P2extmod_hc_int_alleq,
        standardized = TRUE)
```

#### Openness
##### Model Comparison
```{r P2Ext_mod_hc_int_open}
open_P2extmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXopen_BB", 
                                           "extraXopen_DD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

open_P2extmod_hc_int_alleq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXopen_BB", 
                                           "extraXopen_DD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_open_P2extmod_hc <- anova(open_P2extmod_hc_int_noeq,
                                     open_P2extmod_hc_int_alleq)
model_comp_open_P2extmod_hc
```

```{r summary_intmodel_P2ext_hc_open}
summary(open_P2extmod_hc_int_alleq,
        standardized = TRUE)
```
### Table of Model Comparison for Pooling Extraversion Moderator Analyses (Table S12)
```{r extra_mod_hc_int_comp_tbl}
extra_mod_hc_modelcomps <- ls()[str_detect(ls(), 
                                           "model_comp_[:alpha:]*_[:alnum:]*extmod")]

extra_mod_hc_modelcomps %>% 
  lapply(FUN = get) %>%
  map(mutate, delt_aic = AIC - lag(AIC) ,
         delt_bic = BIC - lag(BIC) ) %>% 
  map_df(slice, -1) %>% 
  rename(pvalue = `Pr(>Chisq)`) %>% 
  mutate(name = extra_mod_hc_modelcomps) %>% 
  separate(name, c("temp1", "temp2", "domain", "mod", "temp3")) %>% 
  select(-starts_with("temp")) %>% 
  mutate(domain = case_when(domain == "agree" ~ "Agreeableness",
                            domain == "consc" ~ "Conscientiousness",
                            domain == "hp" ~ "Honesty-Propriety",
                            domain == "neuro" ~ "Neuroticism",
                            domain == "extra" ~ "Extraversion",
                            domain == "open" ~ "Openness"),
         domain = fct_relevel(domain, 
                              "Agreeableness",
                              "Conscientiousness",
                              "Honesty-Propriety",
                              "Neuroticism",
                              "Extraversion",
                              "Openness"),
         moderator = str_remove_all(str_to_lower(mod), "extmod"),
         moderator = str_to_upper(moderator),
         moderator = paste(moderator, "Extraversion"),
         moderator = fct_relevel(moderator,
                                 "T Extraversion",
                                 "P1 Extraversion",
                                 "P2 Extraversion"),
         pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 
                                 4, side = "right", pad ="0"),  
                         "< .001")) %>% 
  arrange(moderator, domain) %>% 
  select(moderator, domain, `Df diff`, `Chisq diff`,  pvalue, delt_aic, delt_bic) %>% 
  knitr::kable(caption = "Model Comparison Results for Integrating across Studies for Extraversion moderator Hearsay Consensys (S12)",
               digits = c(NA, NA, 0, 2, 3, 2, 2),
               format = "html", escape = FALSE) %>% 
  kable_styling("striped", full_width = F)
```
### Table of Extraversion Moderating Hearsay Consensus (Table S14 & S15)
First, search the environment for all of the objects ending in _hc_int, which is how all of the  Extraversion moderating Heaesay Consensus models end.

```{r extra_mod_hc_int_tbl}
extra_mod_hc_int <- ls() %>% 
  .[str_detect(., "_hc_int_[:alpha:]*$")]

extra_mod_hc_int %>% 
  map(get) %>%
  map(ez_group_id_mod_table) %>% 
  enframe() %>% 
  mutate(name = extra_mod_hc_int) %>% 
  unnest() %>% 
  separate(name, c("domain", "mod", "temp")) %>% 
  select(-temp) %>% 
  mutate(domain = case_when(domain == "agree" ~ "Agreeableness",
                            domain == "consc" ~ "Conscientiousness",
                            domain == "hp" ~ "Honesty-Propriety",
                            domain == "neuro" ~ "Neuroticism",
                            domain == "extra" ~ "Extraversion",
                            domain == "open" ~ "Openness"),
         moderator = str_remove_all(str_to_lower(mod), "extmod"),
         moderator = str_to_upper(moderator),
         moderator = paste(moderator, "Extraversion"),
         moderator = fct_relevel(moderator,
                                 "T Extraversion", 
                                 "P1 Extraversion",
                                 "P2 Extraversion"),
         study = case_when(is.na(group_label) ~ "Integrated",
           group_label == "grp1" ~ "Study 1",
           group_label == "grp2" ~ "Study 2"),
         domain = fct_relevel(domain, 
                              "Agreeableness",
                              "Conscientiousness",
                              "Honesty-Propriety",
                              "Neuroticism",
                              "Extraversion",
                              "Openness"),
         study = fct_relevel(study,
                             "Study 1",
                             "Study 2",
                             "Integrated"),
         beta = round(beta, 2),
         beta = ifelse(str_detect(beta, "\\..$"), paste0(beta, "0"), 
                    ifelse(str_detect(beta, "^0$"), paste0(beta, ".00"), beta)),
         beta = cell_spec(beta, "html",
                             bold = ifelse(pvalue == "< .001", TRUE,
                                    ifelse(as.numeric(pvalue) < .05, TRUE, FALSE))),
         ci_lower = round(ci_lower, 2),
         ci_lower = ifelse(str_detect(ci_lower, "\\..$"), paste0(ci_lower, "0"), 
                    ifelse(str_detect(ci_lower, "^0$"), paste0(ci_lower, ".00"), ci_lower)),
         ci_lower = cell_spec(ci_lower, "html",
                             bold = ifelse(pvalue == "< .001", TRUE,
                                    ifelse(as.numeric(pvalue) < .05, TRUE, FALSE))),
         ci_upper = round(ci_upper, 2),
         ci_upper = ifelse(str_detect(ci_upper, "\\..$"), paste0(ci_upper, "0"), 
                    ifelse(str_detect(ci_upper, "^0$"), paste0(ci_upper, ".00"), ci_upper)),
         ci_upper = cell_spec(ci_upper, "html",
                             bold = ifelse(pvalue == "< .001", TRUE,
                                    ifelse(as.numeric(pvalue) < .05, TRUE, FALSE))),
         pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 4, side = "right", pad ="0"),  
                         "< .001")) %>% 
  arrange(desc(study), moderator, domain) %>% 
  filter(parameter == "interaction effect" & 
           study != "Study 1") %>% 
  select(moderator, study, everything(),
         -group_label, -mod, -parameter, - study) %>% 
  knitr::kable(caption = "Study 2 & Integrated Extraversion Moderating Hearsay Consensus",
              format = "html", escape = F) %>% 
  kable_styling("striped", full_width = F) %>% 
  pack_rows("Integrated", 1, 18) %>% 
  pack_rows("Study 2", 19, 36)
```

## Study 2 & Integrated: Extraversion Moderating Hearsay Accuracy

I'll start with Extraversion moderating hearsay accuracy, which predicts P1 reports from P2 reports, (Target, P1, and P2 ) self-reported Extraversion, and their interaction.

### Study 2 & Integrated: Target Extraversion Moderating Hearsay Accuracy

Starting with targets' self-reported Extraversion moderating hearsay accuracy for each of the Big Six.

#### Agreeableness
##### Model Comparison
```{r Text_mod_ha_int_agree}
agree_Textmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXagree_CB", 
                                           "extraXagree_AD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

agree_Textmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXagree_CB", 
                                           "extraXagree_AD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_agree_Textmod_ha <- anova(agree_Textmod_ha_int_noeq,
      agree_Textmod_ha_int_alleq)
model_comp_agree_Textmod_ha
```

```{r summary_intmodel_Text_ha_agree}
summary(agree_Textmod_ha_int_alleq,
        standardized = TRUE)
```

#### Conscientiousness
##### Model Comparison
```{r Text_mod_ha_int_consc}
consc_Textmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXconsc_CB", 
                                           "extraXconsc_AD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

consc_Textmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXconsc_CB", 
                                           "extraXconsc_AD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_consc_Textmod_ha <- anova(consc_Textmod_ha_int_noeq,
                                     consc_Textmod_ha_int_alleq)
model_comp_consc_Textmod_ha
```

```{r summary_intmodel_Text_ha_consc}
summary(consc_Textmod_ha_int_alleq,
        standardized = TRUE)
```

#### Honesty-Propriety
##### Model Comparison
```{r Text_mod_ha_int_hp}
hp_Textmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXhp_CB", 
                                           "extraXhp_AD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

hp_Textmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXhp_CB", 
                                           "extraXhp_AD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_hp_Textmod_ha <- anova(hp_Textmod_ha_int_noeq,
                                  hp_Textmod_ha_int_alleq)
model_comp_hp_Textmod_ha
```

```{r summary_intmodel_Text_ha_hp}
summary(hp_Textmod_ha_int_alleq,
        standardized = TRUE)
```

#### Neuroticism
##### Model Comparison
```{r Text_mod_ha_int_neuro}
neuro_Textmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXneuro_CB", 
                                           "extraXneuro_AD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

neuro_Textmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXneuro_CB", 
                                           "extraXneuro_AD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_neuro_Textmod_ha <- anova(neuro_Textmod_ha_int_noeq,
                                     neuro_Textmod_ha_int_alleq)
model_comp_neuro_Textmod_ha
```

```{r summary_intmodel_Text_ha_neuro}
summary(neuro_Textmod_ha_int_alleq,
        standardized = TRUE)
```

#### Extraversion

Model not possible.

#### Openness
##### Model Comparison
```{r Text_mod_ha_int_open}
open_Textmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXopen_CB", 
                                           "extraXopen_AD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

open_Textmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("C_C_extraversion_cent",
                                          "A_A_extraversion_cent"),
                      interaction_term = c("extraXopen_CB", 
                                           "extraXopen_AD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_open_Textmod_ha <- anova(open_Textmod_ha_int_noeq,
                                    open_Textmod_ha_int_alleq)
model_comp_open_Textmod_ha
```

```{r summary_intmodel_Text_ha_open}
summary(open_Textmod_ha_int_alleq,
        standardized = TRUE)
```
### Study 2 & Integrated: P1 Extraversion Moderating Hearsay Accuracy

Next, P1s' self-reported Extraversion moderating hearsay accuracy for each of the Big Six.

#### Agreeableness
##### Model Comparison
```{r P1Ext_mod_ha_int_agree}
agree_P1extmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXagree_AB", 
                                           "extraXagree_CD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

agree_P1extmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXagree_AB", 
                                           "extraXagree_CD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_agree_P1extmod_ha <- anova(agree_P1extmod_ha_int_noeq,
                                      agree_P1extmod_ha_int_alleq)
model_comp_agree_P1extmod_ha
```

```{r summary_intmodel_P1ext_ha_agree}
summary(agree_P1extmod_ha_int_alleq,
        standardized = TRUE)
```

#### Conscientiousness
##### Model Comparison
```{r P1Ext_mod_ha_int_consc}
consc_P1extmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXconsc_AB", 
                                           "extraXconsc_CD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

consc_P1extmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXconsc_AB", 
                                           "extraXconsc_CD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_consc_P1extmod_ha <- anova(consc_P1extmod_ha_int_noeq,
      consc_P1extmod_ha_int_alleq)

model_comp_consc_P1extmod_ha
```

```{r summary_intmodel_P1ext_ha_consc}
summary(consc_P1extmod_ha_int_alleq,
        standardized = TRUE)
```

#### Honesty-Propriety
##### Model Comparison
```{r P1Ext_mod_ha_int_hp}
hp_P1extmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXhp_AB", 
                                           "extraXhp_CD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

hp_P1extmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXhp_AB", 
                                           "extraXhp_CD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_hp_P1extmod_ha <- anova(hp_P1extmod_ha_int_noeq,
                                   hp_P1extmod_ha_int_alleq)
model_comp_hp_P1extmod_ha
```

```{r summary_intmodel_P1ext_ha_hp}
summary(hp_P1extmod_ha_int_alleq,
        standardized = TRUE)
```

#### Neuroticism
##### Model Comparison
```{r P1Ext_mod_ha_int_neuro}
neuro_P1extmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXneuro_AB", 
                                           "extraXneuro_CD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

neuro_P1extmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXneuro_AB", 
                                           "extraXneuro_CD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_neuro_P1extmod_ha <- anova(neuro_P1extmod_ha_int_noeq,
                                      neuro_P1extmod_ha_int_alleq)
model_comp_neuro_P1extmod_ha
```

```{r summary_intmodel_P1ext_ha_neuro}
summary(neuro_P1extmod_ha_int_alleq,
        standardized = TRUE)
```

#### Extraversion
##### Model Comparison

Because this one is a little tricky - the moderator is the outcome in the other equation - we have to do this one with lavaan syntax 'by hand'.
```{r P1Ext_mod_ha_int_extra}
extra_P1extmod_ha_noeq <- '
C_C_extraversion_cent ~ c(grp1_ha_me, grp2_ha_me)*B_C_extraversion_cent + c(grp1_mod_me, grp2_mod_me)*A_A_extraversion_cent + c(grp1_interaction, grp2_interaction)*extraXextra_AB
A_A_extraversion_cent ~ c(grp1_ha_me, grp2_ha_me)*D_A_extraversion_cent + c(grp1_mod_me, grp2_mod_me)*C_C_extraversion_cent + c(grp1_interaction, grp2_interaction)*extraXextra_CD

C_C_extraversion_cent ~ c(grp1_int_self, grp2_int_self)*1
A_A_extraversion_cent ~ c(grp1_int_self, grp2_int_self)*1
B_C_extraversion_cent ~ c(grp1_int_p2, grp2_int_p2)*1
D_A_extraversion_cent ~ c(grp1_int_p2, grp2_int_p2)*1
extraXextra_AB ~ int_c(grp1_interaction, grp2_interaction)*1
extraXextra_CD ~ int_c(grp1_interaction, grp2_interaction)*1

B_C_extraversion_cent ~~ c(grp1_v_p2, grp2_v_p2)*B_C_extraversion_cent
D_A_extraversion_cent ~~ c(grp1_v_p2, grp2_v_p2)*D_A_extraversion_cent

A_A_extraversion_cent ~~ c(grp1_v_self, grp2_v_self)*A_A_extraversion_cent
C_C_extraversion_cent ~~ c(grp1_v_self, grp2_v_self)*C_C_extraversion_cent

extraXextra_AB ~~ v_c(grp1_interaction, grp2_interaction)*extraXextra_AB
extraXextra_CD ~~ v_c(grp1_interaction, grp2_interaction)*extraXextra_CD
'

extra_P1extmod_ha_int_noeq  <- sem(extra_P1extmod_ha_noeq, 
                               data = integrated, 
                               missing="FIML", 
                               group = "study",
                               fixed.x = FALSE)

extra_P1extmod_ha_alleq <- '
C_C_extraversion_cent ~ c(ha_me, ha_me)*B_C_extraversion_cent + c(mod_me, mod_me)*A_A_extraversion_cent + c(interaction, interaction)*extraXextra_AB
A_A_extraversion_cent ~ c(ha_me, ha_me)*D_A_extraversion_cent + c(mod_me, mod_me)*C_C_extraversion_cent + c(interaction, interaction)*extraXextra_CD

C_C_extraversion_cent ~ c(int_self, int_self)*1
A_A_extraversion_cent ~ c(int_self, int_self)*1
B_C_extraversion_cent ~ c(int_p2, int_p2)*1
D_A_extraversion_cent ~ c(int_p2, int_p2)*1
extraXextra_AB ~ int_c(interaction, interaction)*1
extraXextra_CD ~ int_c(interaction, interaction)*1

B_C_extraversion_cent ~~ c(v_p2, v_p2)*B_C_extraversion_cent
D_A_extraversion_cent ~~ c(v_p2, v_p2)*D_A_extraversion_cent

A_A_extraversion_cent ~~ c(v_self, v_self)*A_A_extraversion_cent
C_C_extraversion_cent ~~ c(v_self, v_self)*C_C_extraversion_cent

extraXextra_AB ~~ v_c(interaction, interaction)*extraXextra_AB
extraXextra_CD ~~ v_c(interaction, interaction)*extraXextra_CD
'

extra_P1extmod_ha_int_alleq  <- sem(extra_P1extmod_ha_alleq, 
                               data = integrated, 
                               missing="FIML", 
                               group = "study",
                               fixed.x = FALSE)
  
model_comp_extra_P1extmod_ha <- anova(extra_P1extmod_ha_int_noeq,
                                      extra_P1extmod_ha_int_alleq)
model_comp_extra_P1extmod_ha 
```

```{r summary_intmodel_P1ext_ha_extra}
summary(extra_P1extmod_ha_int_alleq,
        standardized = TRUE)
```

#### Openness
##### Model Comparison
```{r P1Ext_mod_ha_int_open}
open_P1extmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXopen_AB", 
                                           "extraXopen_CD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

open_P1extmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("A_A_extraversion_cent",
                                          "C_C_extraversion_cent"),
                      interaction_term = c("extraXopen_AB", 
                                           "extraXopen_CD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_open_P1extmod_ha <- anova(open_P1extmod_ha_int_noeq,
                                     open_P1extmod_ha_int_alleq)
model_comp_open_P1extmod_ha
```

```{r summary_intmodel_P1ext_ha_open}
summary(open_P1extmod_ha_int_alleq,
        standardized = TRUE)
```
### Study 2 & Integrated: P2 Extraversion Moderating Hearsay Accuracy

Next, P2s' self-reported Extraversion moderating hearsay accuracy for each of the Big Six.

#### Agreeableness
##### Model Comparison
```{r P2Ext_mod_ha_int_agree}
agree_P2extmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXagree_BB", 
                                           "extraXagree_DD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

agree_P2extmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXagree_BB", 
                                           "extraXagree_DD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_agree_P2extmod_ha <- anova(agree_P2extmod_ha_int_noeq,
                                      agree_P2extmod_ha_int_alleq)
model_comp_agree_P2extmod_ha
```

```{r summary_intmodel_P2ext_ha_agree}
summary(agree_P2extmod_ha_int_alleq,
        standardized = TRUE)
```

#### Conscientiousness
##### Model Comparison
```{r P2Ext_mod_ha_int_consc}
consc_P2extmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXconsc_BB", 
                                           "extraXconsc_DD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

consc_P2extmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXconsc_BB", 
                                           "extraXconsc_DD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_consc_P2extmod_ha <- anova(consc_P2extmod_ha_int_noeq,
                                      consc_P2extmod_ha_int_alleq)
model_comp_consc_P2extmod_ha
```

```{r summary_intmodel_P2ext_ha_consc}
summary(consc_P2extmod_ha_int_alleq,
        standardized = TRUE)
```

#### Honesty-Propriety
##### Model Comparison
```{r P2Ext_mod_ha_int_hp}
hp_P2extmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXhp_BB", 
                                           "extraXhp_DD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

hp_P2extmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXhp_BB", 
                                           "extraXhp_DD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_hp_P2extmod_ha <- anova(hp_P2extmod_ha_int_noeq,
                                   hp_P2extmod_ha_int_alleq)
model_comp_hp_P2extmod_ha
```

```{r summary_intmodel_P2ext_ha_hp}
summary(hp_P2extmod_ha_int_alleq,
        standardized = TRUE)
```

#### Neuroticism
##### Model Comparison
```{r P2Ext_mod_ha_int_neuro}
neuro_P2extmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXneuro_BB", 
                                           "extraXneuro_DD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

neuro_P2extmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXneuro_BB", 
                                           "extraXneuro_DD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_neuro_P2extmod_ha <- anova(neuro_P2extmod_ha_int_noeq,
                                     neuro_P2extmod_ha_int_alleq)
model_comp_neuro_P2extmod_ha
```

```{r summary_intmodel_P2ext_ha_neuro}
summary(neuro_P2extmod_ha_int_alleq,
        standardized = TRUE)
```

#### Extraversion
##### Model Comparison
```{r P2Ext_mod_ha_int_extra}
extra_P2extmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_extraversion", 
                                     "A_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXextra_BB", 
                                           "extraXextra_DD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

extra_P2extmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_extraversion", 
                                     "A_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXextra_BB", 
                                           "extraXextra_DD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_extra_P2extmod_ha <- anova(extra_P2extmod_ha_int_noeq,
                                     extra_P2extmod_ha_int_alleq)
model_comp_extra_P2extmod_ha
```

```{r summary_intmodel_P2ext_ha_extra}
summary(extra_P2extmod_ha_int_alleq,
        standardized = TRUE)
```

#### Openness
##### Model Comparison
```{r P2Ext_mod_ha_int_open}
open_P2extmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXopen_BB", 
                                           "extraXopen_DD"),
                      group_mod = "study",
                      groups_eql = "none",
                      params_eql = "all")

open_P2extmod_ha_int_alleq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_B_extraversion_cent",
                                          "D_D_extraversion_cent"),
                      interaction_term = c("extraXopen_BB", 
                                           "extraXopen_DD"),
                      group_mod = "study",
                      groups_eql = "all",
                      params_eql = "all")

model_comp_open_P2extmod_ha <- anova(open_P2extmod_ha_int_noeq,
                                     open_P2extmod_ha_int_alleq)
model_comp_open_P2extmod_ha
```

```{r summary_intmodel_P2ext_ha_open}
summary(open_P2extmod_ha_int_alleq,
        standardized = TRUE)
```

### Table of Model Comparison for Pooling Extraversion Moderating Hearsay Accuracy (Table S13)
```{r extra_mod_ha_modelcomps}
extra_mod_ha_modelcomps <- ls()[str_detect(ls(), 
                                           "model_comp_[:alpha:]*_[:alnum:]*extmod_ha")]

extra_mod_ha_modelcomps %>% 
  lapply(FUN = get) %>%
  map(mutate, delt_aic = AIC - lag(AIC) ,
         delt_bic = BIC - lag(BIC) ) %>% 
  map_df(slice, -1) %>% 
  rename(pvalue = `Pr(>Chisq)`) %>% 
  mutate(name = extra_mod_ha_modelcomps) %>% 
  separate(name, c("temp1", "temp2", "domain", "mod", "temp3")) %>% 
  select(-starts_with("temp")) %>% 
  mutate(domain = case_when(domain == "agree" ~ "Agreeableness",
                            domain == "consc" ~ "Conscientiousness",
                            domain == "hp" ~ "Honesty-Propriety",
                            domain == "neuro" ~ "Neuroticism",
                            domain == "extra" ~ "Extraversion",
                            domain == "open" ~ "Openness"),
         domain = fct_relevel(domain, 
                              "Agreeableness",
                              "Conscientiousness",
                              "Honesty-Propriety",
                              "Neuroticism",
                              "Extraversion",
                              "Openness"),
         moderator = str_remove_all(str_to_lower(mod), "extmod"),
         moderator = str_to_upper(moderator),
         moderator = paste(moderator, "Extraversion"),
         moderator = fct_relevel(moderator,
                                 "T Extraversion",
                                 "P1 Extraversion",
                                 "P2 Extraversion"),
         pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 
                                 4, side = "right", pad ="0"),  
                         "< .001")) %>% 
  arrange(moderator, domain) %>% 
  select(moderator, domain, `Df diff`, `Chisq diff`, pvalue, delt_aic, delt_bic) %>% 
  knitr::kable(caption = "Model Comparison Results for Integrating across Studies for Extraversion moderator Hearsay Accuracy (S13)",
               digits = c(NA, NA, 2, 2, 3, 2, 2),
               format = "html", escape = FALSE) %>% 
  kable_styling("striped", full_width = F)
```

### Table of Extraversion Moderating Hearsay Accuracy (Table S16 & S17)
First, search the environment for all of the objects ending in _ha_int, which is how all of the  Extraversion moderating Heaesay Consensus models end.

```{r extra_mod_ha_int_tbl}
extra_mod_ha_int <- ls() %>% 
  .[str_detect(., "_ha_int_[:alpha:]*$")]

extra_mod_ha_int %>% 
  map(get) %>%
  map(ez_group_id_mod_table) %>% 
  enframe() %>% 
  mutate(name = extra_mod_ha_int) %>% 
  unnest() %>% 
  separate(name, c("domain", "mod", "temp")) %>% 
  select(-temp) %>% 
  mutate(domain = case_when(domain == "agree" ~ "Agreeableness",
                            domain == "consc" ~ "Conscientiousness",
                            domain == "hp" ~ "Honesty-Propriety",
                            domain == "neuro" ~ "Neuroticism",
                            domain == "extra" ~ "Extraversion",
                            domain == "open" ~ "Openness"),
         moderator = str_remove_all(str_to_lower(mod), "extmod"),
         moderator = str_to_upper(moderator),
         moderator = paste(moderator, "Extraversion"),
         moderator = fct_relevel(moderator,
                                 "T Extraversion", 
                                 "P1 Extraversion",
                                 "P2 Extraversion"),
         study = case_when(is.na(group_label) ~ "Integrated",
           group_label == "grp1" ~ "Study 1",
           group_label == "grp2" ~ "Study 2"),
         domain = fct_relevel(domain, 
                              "Agreeableness",
                              "Conscientiousness",
                              "Honesty-Propriety",
                              "Neuroticism",
                              "Extraversion",
                              "Openness"),
         study = fct_relevel(study,
                             "Study 1",
                             "Study 2",
                             "Integrated"),
         beta = round(beta, 2),
         beta = ifelse(str_detect(beta, "\\..$"), paste0(beta, "0"), 
                    ifelse(str_detect(beta, "^0$"), paste0(beta, ".00"), beta)),
         beta = cell_spec(beta, "html",
                             bold = ifelse(pvalue == "< .001", TRUE,
                                    ifelse(as.numeric(pvalue) < .05, TRUE, FALSE))),
         ci_lower = round(ci_lower, 2),
         ci_lower = ifelse(str_detect(ci_lower, "\\..$"), paste0(ci_lower, "0"), 
                    ifelse(str_detect(ci_lower, "^0$"), paste0(ci_lower, ".00"), ci_lower)),
         ci_lower = cell_spec(ci_lower, "html",
                             bold = ifelse(pvalue == "< .001", TRUE,
                                    ifelse(as.numeric(pvalue) < .05, TRUE, FALSE))),
         ci_upper = round(ci_upper, 2),
         ci_upper = ifelse(str_detect(ci_upper, "\\..$"), paste0(ci_upper, "0"), 
                    ifelse(str_detect(ci_upper, "^0$"), paste0(ci_upper, ".00"), ci_upper)),
         ci_upper = cell_spec(ci_upper, "html",
                             bold = ifelse(pvalue == "< .001", TRUE,
                                    ifelse(as.numeric(pvalue) < .05, TRUE, FALSE))),
         pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 4, side = "right", pad ="0"),  
                         "< .001")) %>% 
  arrange(desc(study), moderator, domain) %>% 
  filter(parameter == "interaction effect" & 
           study != "Study 1") %>% 
  select(moderator, study, everything(),
         -group_label, -mod, -parameter, - study) %>% 
  knitr::kable(caption = "Study 2 & Integrated Extraversion Moderating Hearsay Accuracy",
              format = "html", escape = F) %>% 
  kable_styling("striped", full_width = F) %>% 
  pack_rows("Integrated", 1, 17) %>% 
  pack_rows("Study 2", 18, 34)
```

## Study 2 & Integrated: Empathy Moderating Hearsay Consensus

Next up: P2s' self-reported Empathy (as assessed by the IRI; Davis, 1980) moderating hearsay consensus for each of the Big Six.

### Study 2 & Integrated Perspective Taking Moderating Hearsay Consensus
Starting with perspective taking.
#### Study 2 & Integrated Perspective Taking Moderating Hearsay Consensus for Agreeableness
```{r PTmod_hc_agree_int}
agree_PTmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxA_B", 
                                           "PTxA_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

agree_PTmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxA_B", 
                                           "PTxA_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_agree_PTmod_hc <- anova(agree_PTmod_hc_int_noeq,
                                   agree_PTmod_hc_int_alleq)
model_comp_agree_PTmod_hc
```

#### Study 2 & Integrated Perspective Taking Moderating Hearsay Consensus for Conscientiousness
```{r PTmod_hc_consc_int}
consc_PTmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxC_B", 
                                           "PTxC_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

consc_PTmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxC_B", 
                                           "PTxC_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_consc_PTmod_hc <- anova(consc_PTmod_hc_int_noeq,
                                   consc_PTmod_hc_int_alleq)
model_comp_consc_PTmod_hc
```

#### Study 2 & Integrated Perspective Taking Moderating Hearsay Consensus for Honesty-Propriety
```{r PTmod_hc_hp_int}
hp_PTmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxHP_B", 
                                           "PTxHP_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

hp_PTmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxHP_B", 
                                           "PTxHP_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_hp_PTmod_hc <- anova(hp_PTmod_hc_int_noeq,
                                   hp_PTmod_hc_int_alleq)
model_comp_hp_PTmod_hc
```

#### Study 2 & Integrated Perspective Taking Moderating Hearsay Consensus for Neuroticism
```{r PTmod_hc_neuro_int}
neuro_PTmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxN_B", 
                                           "PTxN_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

neuro_PTmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxN_B", 
                                           "PTxN_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_neuro_PTmod_hc <- anova(neuro_PTmod_hc_int_noeq,
                                   neuro_PTmod_hc_int_alleq)
model_comp_neuro_PTmod_hc
```

#### Study 2 & Integrated Perspective Taking Moderating Hearsay Consensus for Extraversion
```{r PTmod_hc_extra_int}
extra_PTmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxE_B", 
                                           "PTxE_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

extra_PTmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxE_B", 
                                           "PTxE_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_extra_PTmod_hc <- anova(extra_PTmod_hc_int_noeq,
                                   extra_PTmod_hc_int_alleq)
model_comp_extra_PTmod_hc
```

#### Study 2 & Integrated Perspective Taking Moderating Hearsay Consensus for Openness
```{r PTmod_hc_open_int}
open_PTmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxO_B", 
                                           "PTxO_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

open_PTmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxO_B", 
                                           "PTxO_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_open_PTmod_hc <- anova(open_PTmod_hc_int_noeq,
                                   open_PTmod_hc_int_alleq)
model_comp_open_PTmod_hc
```

### Study 2 & Integrated Empathic Concern Moderating Hearsay Consensus
Starting with perspective taking.
#### Study 2 & Integrated Empathic Concern Moderating Hearsay Consensus for Agreeableness
```{r empmod_hc_agree_int}
agree_empmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxA_B", 
                                           "empxA_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

agree_empmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxA_B", 
                                           "empxA_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_agree_empmod_hc <- anova(agree_empmod_hc_int_noeq,
                                   agree_empmod_hc_int_alleq)
model_comp_agree_empmod_hc
```

#### Study 2 & Integrated Empathic Concern Moderating Hearsay Consensus for Conscientiousness
```{r empmod_hc_consc_int}
consc_empmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxC_B", 
                                           "empxC_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

consc_empmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxC_B", 
                                           "empxC_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_consc_empmod_hc <- anova(consc_empmod_hc_int_noeq,
                                   consc_empmod_hc_int_alleq)
model_comp_consc_empmod_hc
```

#### Study 2 & Integrated Empathic Concern Moderating Hearsay Consensus for Honesty-Propriety
```{r empmod_hc_hp_int}
hp_empmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxHP_B", 
                                           "empxHP_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

hp_empmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxHP_B", 
                                           "empxHP_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_hp_empmod_hc <- anova(hp_empmod_hc_int_noeq,
                                   hp_empmod_hc_int_alleq)
model_comp_hp_empmod_hc
```

#### Study 2 & Integrated Empathic Concern Moderating Hearsay Consensus for Neuroticism
```{r empmod_hc_neuro_int}
neuro_empmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxN_B", 
                                           "empxN_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

neuro_empmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxN_B", 
                                           "empxN_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_neuro_empmod_hc <- anova(neuro_empmod_hc_int_noeq,
                                   neuro_empmod_hc_int_alleq)
model_comp_neuro_empmod_hc
```

#### Study 2 & Integrated Empathic Concern Moderating Hearsay Consensus for Extraversion
```{r empmod_hc_extra_int}
extra_empmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxE_B", 
                                           "empxE_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

extra_empmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxE_B", 
                                           "empxE_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_extra_empmod_hc <- anova(extra_empmod_hc_int_noeq,
                                   extra_empmod_hc_int_alleq)
model_comp_extra_empmod_hc
```

#### Study 2 & Integrated Empathic Concern Moderating Hearsay Consensus for Openness
```{r empmod_hc_open_int}
open_empmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxO_B", 
                                           "empxO_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

open_empmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxO_B", 
                                           "empxO_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_open_empmod_hc <- anova(open_empmod_hc_int_noeq,
                                   open_empmod_hc_int_alleq)
model_comp_open_empmod_hc
```

### Study 2 & Integrated Personal Distress Moderating Hearsay Consensus
Starting with perspective taking.
#### Study 2 & Integrated Personal Distress Moderating Hearsay Consensus for Agreeableness
```{r dismod_hc_agree_int}
agree_dismod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxA_B", 
                                           "disxA_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

agree_dismod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxA_B", 
                                           "disxA_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_agree_dismod_hc <- anova(agree_dismod_hc_int_noeq,
                                   agree_dismod_hc_int_alleq)
model_comp_agree_dismod_hc
```

#### Study 2 & Integrated Personal Distress Moderating Hearsay Consensus for Conscientiousness
```{r dismod_hc_consc_int}
consc_dismod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxC_B", 
                                           "disxC_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

consc_dismod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxC_B", 
                                           "disxC_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_consc_dismod_hc <- anova(consc_dismod_hc_int_noeq,
                                   consc_dismod_hc_int_alleq)
model_comp_consc_dismod_hc
```

#### Study 2 & Integrated Personal Distress Moderating Hearsay Consensus for Honesty-Propriety
```{r dismod_hc_hp_int}
hp_dismod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxHP_B", 
                                           "disxHP_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

hp_dismod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxHP_B", 
                                           "disxHP_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_hp_dismod_hc <- anova(hp_dismod_hc_int_noeq,
                                   hp_dismod_hc_int_alleq)
model_comp_hp_dismod_hc
```

#### Study 2 & Integrated Personal Distress Moderating Hearsay Consensus for Neuroticism
```{r dismod_hc_neuro_int}
neuro_dismod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxN_B", 
                                           "disxN_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

neuro_dismod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxN_B", 
                                           "disxN_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_neuro_dismod_hc <- anova(neuro_dismod_hc_int_noeq,
                                   neuro_dismod_hc_int_alleq)
model_comp_neuro_dismod_hc
```

#### Study 2 & Integrated Personal Distress Moderating Hearsay Consensus for Extraversion
```{r dismod_hc_extra_int}
extra_dismod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxE_B", 
                                           "disxE_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

extra_dismod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxE_B", 
                                           "disxE_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_extra_dismod_hc <- anova(extra_dismod_hc_int_noeq,
                                   extra_dismod_hc_int_alleq)
model_comp_extra_dismod_hc
```

#### Study 2 & Integrated Personal Distress Moderating Hearsay Consensus for Openness
```{r dismod_hc_open_int}
open_dismod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxO_B", 
                                           "disxO_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

open_dismod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxO_B", 
                                           "disxO_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_open_dismod_hc <- anova(open_dismod_hc_int_noeq,
                                   open_dismod_hc_int_alleq)
model_comp_open_dismod_hc
```

### Study 2 & Integrated Fantasy Moderating Hearsay Consensus
Starting with perspective taking.
#### Study 2 & Integrated Fantasy Moderating Hearsay Consensus for Agreeableness
```{r fantmod_hc_agree_int}
agree_fantmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxA_B", 
                                           "fantxA_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

agree_fantmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_agreeableness", 
                                     "C_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxA_B", 
                                           "fantxA_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_agree_fantmod_hc <- anova(agree_fantmod_hc_int_noeq,
                                   agree_fantmod_hc_int_alleq)
model_comp_agree_fantmod_hc
```

#### Study 2 & Integrated Fantasy Moderating Hearsay Consensus for Conscientiousness
```{r fantmod_hc_consc_int}
consc_fantmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxC_B", 
                                           "fantxC_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

consc_fantmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_conscientiousness", 
                                     "C_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxC_B", 
                                           "fantxC_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_consc_fantmod_hc <- anova(consc_fantmod_hc_int_noeq,
                                   consc_fantmod_hc_int_alleq)
model_comp_consc_fantmod_hc
```

#### Study 2 & Integrated Fantasy Moderating Hearsay Consensus for Honesty-Propriety
```{r fantmod_hc_hp_int}
hp_fantmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxHP_B", 
                                           "fantxHP_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

hp_fantmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_hp", 
                                     "C_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxHP_B", 
                                           "fantxHP_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_hp_fantmod_hc <- anova(hp_fantmod_hc_int_noeq,
                                   hp_fantmod_hc_int_alleq)
model_comp_hp_fantmod_hc
```

#### Study 2 & Integrated Fantasy Moderating Hearsay Consensus for Neuroticism
```{r fantmod_hc_neuro_int}
neuro_fantmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxN_B", 
                                           "fantxN_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

neuro_fantmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_neuroticism", 
                                     "C_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxN_B", 
                                           "fantxN_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_neuro_fantmod_hc <- anova(neuro_fantmod_hc_int_noeq,
                                   neuro_fantmod_hc_int_alleq)
model_comp_neuro_fantmod_hc
```

#### Study 2 & Integrated Fantasy Moderating Hearsay Consensus for Extraversion
```{r fantmod_hc_extra_int}
extra_fantmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxE_B", 
                                           "fantxE_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

extra_fantmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_extraversion", 
                                     "C_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxE_B", 
                                           "fantxE_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_extra_fantmod_hc <- anova(extra_fantmod_hc_int_noeq,
                                   extra_fantmod_hc_int_alleq)
model_comp_extra_fantmod_hc
```

#### Study 2 & Integrated Fantasy Moderating Hearsay Consensus for Openness
```{r fantmod_hc_open_int}
open_fantmod_hc_int_noeq <- rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxO_B", 
                                           "fantxO_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

open_fantmod_hc_int_alleq <- 
  rep_consensus_group_id_mods(integrated,
                      p1_reports = c("A_C_openness", 
                                     "C_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxO_B", 
                                           "fantxO_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_open_fantmod_hc <- anova(open_fantmod_hc_int_noeq,
                                   open_fantmod_hc_int_alleq)
model_comp_open_fantmod_hc
```

### Table of Model Comparisons for Pooling Empathy Moderating Hearsay Consensus (part of Table S18)
```{r emp_mod_hc_int_comp_tbl}
pt_mod_hc_modelcomps <- ls() %>% 
  .[str_detect(., "model_comp_[:alpha:]*_PTmod")]
empcon_mod_hc_modelcomps <- ls() %>% 
  .[str_detect(., "model_comp_[:alpha:]*_empmod")]
dis_mod_hc_modelcomps <- ls() %>% 
  .[str_detect(., "model_comp_[:alpha:]*_dismod")]
fant_mod_hc_modelcomps <- ls() %>% 
  .[str_detect(., "model_comp_[:alpha:]*_fantmod")]

emp_mod_hc_modelcomps <- c(pt_mod_hc_modelcomps,
                           empcon_mod_hc_modelcomps,
                           dis_mod_hc_modelcomps,
                           fant_mod_hc_modelcomps)

emp_mod_hc_modelcomps %>% 
  lapply(FUN = get) %>%
  map(mutate, delt_aic = AIC - lag(AIC) ,
         delt_bic = BIC - lag(BIC) ) %>% 
  map_df(slice, -1) %>% 
  rename(pvalue = `Pr(>Chisq)`) %>% 
  mutate(name = emp_mod_hc_modelcomps) %>% 
  separate(name, c("temp1", "temp2", "domain", "mod", "temp3")) %>% 
  select(-starts_with("temp")) %>% 
  mutate(domain = case_when(domain == "agree" ~ "Agreeableness",
                            domain == "consc" ~ "Conscientiousness",
                            domain == "hp" ~ "Honesty-Propriety",
                            domain == "neuro" ~ "Neuroticism",
                            domain == "extra" ~ "Extraversion",
                            domain == "open" ~ "Openness"),
         domain = fct_relevel(domain, 
                              "Agreeableness",
                              "Conscientiousness",
                              "Honesty-Propriety",
                              "Neuroticism",
                              "Extraversion",
                              "Openness"),
         moderator = case_when(mod == "dismod"~ "Personal Distress",
                               mod == "empmod"~ "Empathic Concern",
                               mod == "PTmod"~ "Perspective Taking",
                               mod == "fantmod"~ "Fantasy"),
         moderator = fct_relevel(moderator, 
                                 "Perspective Taking",
                                 "Empathic Concern",
                                 "Personal Distress",
                                 "Fantasy"),
         pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 
                                 4, side = "right", pad ="0"),  
                         "< .001")) %>% 
  arrange(moderator, domain) %>% 
  select(moderator, domain, `Df diff`, `Chisq diff`, pvalue, delt_aic, delt_bic) %>% 
  knitr::kable(caption = "Model Comparison Results for Integrating across Studies for Empathy moderating Hearsay Consensus (part of S18)",
               digits = c(NA, NA, 2, 2, 3, 2, 2),
               format = "html", escape = FALSE) %>% 
  kable_styling("striped", full_width = F)
```
### Table of Empathy Moderating Hearsay Consensus (part of Table S19 & S20)
First, search the environment for all of the objects ending in [moderator]_hc_int, which is how all of the  Empathy Heaesay Accuracy models end.

```{r emp_mod_hc_int_tbl}
pt_mod_hc_int <- ls() %>% 
  .[str_detect(., "PTmod_hc_int_[:alpha:]*$")]
empcon_mod_hc_int <- ls() %>% 
  .[str_detect(., "empmod_hc_int_[:alpha:]*$")]
dis_mod_hc_int <- ls() %>% 
  .[str_detect(., "dismod_hc_int_[:alpha:]*$")]
fant_mod_hc_int <- ls() %>% 
  .[str_detect(., "fantmod_hc_int_[:alpha:]*$")]

emp_mod_hc_int <- c(pt_mod_hc_int,
         empcon_mod_hc_int,
         dis_mod_hc_int,
         fant_mod_hc_int)
  
emp_mod_hc_int %>% 
  map(get) %>%
  map(ez_group_id_mod_table) %>% 
  enframe() %>% 
  mutate(name = emp_mod_hc_int) %>% 
  unnest() %>% 
  separate(name, c("domain", "mod", "temp")) %>% 
  select(-temp) %>% 
  mutate(domain = case_when(domain == "agree" ~ "Agreeableness",
                            domain == "consc" ~ "Conscientiousness",
                            domain == "hp" ~ "Honesty-Propriety",
                            domain == "neuro" ~ "Neuroticism",
                            domain == "extra" ~ "Extraversion",
                            domain == "open" ~ "Openness"),
         moderator = case_when(mod == "dismod"~ "Personal Distress",
                               mod == "empmod"~ "Empathic Concern",
                               mod == "PTmod"~ "Perspective Taking",
                               mod == "fantmod"~ "Fantasy"),
         moderator = fct_relevel(moderator, 
                                 "Perspective Taking",
                                 "Empathic Concern",
                                 "Personal Distress",
                                 "Fantasy"),
         study = case_when(is.na(group_label) ~ "Integrated",
           group_label == "grp1" ~ "Study 1",
           group_label == "grp2" ~ "Study 2"),
         domain = fct_relevel(domain, 
                              "Agreeableness",
                              "Conscientiousness",
                              "Honesty-Propriety",
                              "Neuroticism",
                              "Extraversion",
                              "Openness"),
         study = fct_relevel(study,
                             "Study 1",
                             "Study 2",
                             "Integrated"),
         beta = round(beta, 2),
         beta = ifelse(str_detect(beta, "\\..$"), paste0(beta, "0"), 
                    ifelse(str_detect(beta, "^0$"), paste0(beta, ".00"), beta)),
         beta = cell_spec(beta, "html",
                             bold = ifelse(pvalue == "< .001", TRUE,
                                    ifelse(as.numeric(pvalue) < .05, TRUE, FALSE))),
         ci_lower = round(ci_lower, 2),
         ci_lower = ifelse(str_detect(ci_lower, "\\..$"), paste0(ci_lower, "0"), 
                    ifelse(str_detect(ci_lower, "^0$"), paste0(ci_lower, ".00"), ci_lower)),
         ci_lower = cell_spec(ci_lower, "html",
                             bold = ifelse(pvalue == "< .001", TRUE,
                                    ifelse(as.numeric(pvalue) < .05, TRUE, FALSE))),
         ci_upper = round(ci_upper, 2),
         ci_upper = ifelse(str_detect(ci_upper, "\\..$"), paste0(ci_upper, "0"), 
                    ifelse(str_detect(ci_upper, "^0$"), paste0(ci_upper, ".00"), ci_upper)),
         ci_upper = cell_spec(ci_upper, "html",
                             bold = ifelse(pvalue == "< .001", TRUE,
                                    ifelse(as.numeric(pvalue) < .05, TRUE, FALSE))),
         pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 4, side = "right", pad ="0"),  
                         "< .001")) %>% 
  arrange(desc(study), moderator, domain) %>% 
  filter(parameter == "interaction effect" & 
           study != "Study 1") %>% 
  select(moderator, study, everything(),
         -group_label, -mod, -parameter, - study) %>% 
  knitr::kable(caption = "Study 2 & Integrated Empathy Moderating Hearsay Consensus (part of S19)",
              format = "html", escape = F) %>% 
  kable_styling("striped", full_width = F) %>% 
  pack_rows("Integrated", 1, 24) %>% 
  pack_rows("Study 2", 25, 48)
```

## Study 2 & Integrated: Empathy Moderating Hearsay Accuracy

Next up: P2s' self-reported Empathy (as assessed by the IRI; Davis, 1980) moderating hearsay consensus for each of the Big Six.

### Study 2 & Integrated Perspective Taking Moderating Hearsay Accuracy
Starting with perspective taking.
#### Study 2 & Integrated Perspective Taking Moderating Hearsay Accuracy for Agreeableness
```{r PTmod_ha_agree_int}
agree_PTmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxA_B", 
                                           "PTxA_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

agree_PTmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxA_B", 
                                           "PTxA_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_agree_PTmod_ha <- anova(agree_PTmod_ha_int_noeq,
                                   agree_PTmod_ha_int_alleq)
model_comp_agree_PTmod_ha
```

#### Study 2 & Integrated Perspective Taking Moderating Hearsay Accuracy for Conscientiousness
```{r PTmod_ha_consc_int}
consc_PTmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxC_B", 
                                           "PTxC_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

consc_PTmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxC_B", 
                                           "PTxC_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_consc_PTmod_ha <- anova(consc_PTmod_ha_int_noeq,
                                   consc_PTmod_ha_int_alleq)
model_comp_consc_PTmod_ha
```

#### Study 2 & Integrated Perspective Taking Moderating Hearsay Accuracy for Honesty-Propriety
```{r PTmod_ha_hp_int}
hp_PTmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxHP_B", 
                                           "PTxHP_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

hp_PTmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxHP_B", 
                                           "PTxHP_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_hp_PTmod_ha <- anova(hp_PTmod_ha_int_noeq,
                                   hp_PTmod_ha_int_alleq)
model_comp_hp_PTmod_ha
```

#### Study 2 & Integrated Perspective Taking Moderating Hearsay Accuracy for Neuroticism
```{r PTmod_ha_neuro_int}
neuro_PTmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxN_B", 
                                           "PTxN_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

neuro_PTmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxN_B", 
                                           "PTxN_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_neuro_PTmod_ha <- anova(neuro_PTmod_ha_int_noeq,
                                   neuro_PTmod_ha_int_alleq)
model_comp_neuro_PTmod_ha
```

#### Study 2 & Integrated Perspective Taking Moderating Hearsay Accuracy for Extraversion
```{r PTmod_ha_extra_int}
extra_PTmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_extraversion", 
                                     "A_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxE_B", 
                                           "PTxE_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

extra_PTmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_extraversion", 
                                     "A_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxE_B", 
                                           "PTxE_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_extra_PTmod_ha <- anova(extra_PTmod_ha_int_noeq,
                                   extra_PTmod_ha_int_alleq)
model_comp_extra_PTmod_ha
```

#### Study 2 & Integrated Perspective Taking Moderating Hearsay Accuracy for Openness
```{r PTmod_ha_open_int}
open_PTmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxO_B", 
                                           "PTxO_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

open_PTmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_perspective_cent",
                                          "D_iri_perspective_cent"),
                      interaction_term = c("PTxO_B", 
                                           "PTxO_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_open_PTmod_ha <- anova(open_PTmod_ha_int_noeq,
                                   open_PTmod_ha_int_alleq)
model_comp_open_PTmod_ha
```

### Study 2 & Integrated Empathic Concern Moderating Hearsay Accuracy
Starting with perspective taking.
#### Study 2 & Integrated Empathic Concern Moderating Hearsay Accuracy for Agreeableness
```{r empmod_ha_agree_int}
agree_empmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxA_B", 
                                           "empxA_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

agree_empmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxA_B", 
                                           "empxA_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_agree_empmod_ha <- anova(agree_empmod_ha_int_noeq,
                                   agree_empmod_ha_int_alleq)
model_comp_agree_empmod_ha
```

#### Study 2 & Integrated Empathic Concern Moderating Hearsay Accuracy for Conscientiousness
```{r empmod_ha_consc_int}
consc_empmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxC_B", 
                                           "empxC_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

consc_empmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxC_B", 
                                           "empxC_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_consc_empmod_ha <- anova(consc_empmod_ha_int_noeq,
                                   consc_empmod_ha_int_alleq)
model_comp_consc_empmod_ha
```

#### Study 2 & Integrated Empathic Concern Moderating Hearsay Accuracy for Honesty-Propriety
```{r empmod_ha_hp_int}
hp_empmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxHP_B", 
                                           "empxHP_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

hp_empmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxHP_B", 
                                           "empxHP_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_hp_empmod_ha <- anova(hp_empmod_ha_int_noeq,
                                   hp_empmod_ha_int_alleq)
model_comp_hp_empmod_ha
```

#### Study 2 & Integrated Empathic Concern Moderating Hearsay Accuracy for Neuroticism
```{r empmod_ha_neuro_int}
neuro_empmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxN_B", 
                                           "empxN_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

neuro_empmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxN_B", 
                                           "empxN_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_neuro_empmod_ha <- anova(neuro_empmod_ha_int_noeq,
                                   neuro_empmod_ha_int_alleq)
model_comp_neuro_empmod_ha
```

#### Study 2 & Integrated Empathic Concern Moderating Hearsay Accuracy for Extraversion
```{r empmod_ha_extra_int}
extra_empmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_extraversion", 
                                     "A_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxE_B", 
                                           "empxE_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

extra_empmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_extraversion", 
                                     "A_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxE_B", 
                                           "empxE_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_extra_empmod_ha <- anova(extra_empmod_ha_int_noeq,
                                   extra_empmod_ha_int_alleq)
model_comp_extra_empmod_ha
```

#### Study 2 & Integrated Empathic Concern Moderating Hearsay Accuracy for Openness
```{r empmod_ha_open_int}
open_empmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxO_B", 
                                           "empxO_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

open_empmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_empathic_cent",
                                          "D_iri_empathic_cent"),
                      interaction_term = c("empxO_B", 
                                           "empxO_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_open_empmod_ha <- anova(open_empmod_ha_int_noeq,
                                   open_empmod_ha_int_alleq)
model_comp_open_empmod_ha
```

### Study 2 & Integrated Personal Distress Moderating Hearsay Accuracy
Starting with perspective taking.
#### Study 2 & Integrated Personal Distress Moderating Hearsay Accuracy for Agreeableness
```{r dismod_ha_agree_int}
agree_dismod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxA_B", 
                                           "disxA_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

agree_dismod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxA_B", 
                                           "disxA_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_agree_dismod_ha <- anova(agree_dismod_ha_int_noeq,
                                   agree_dismod_ha_int_alleq)
model_comp_agree_dismod_ha
```

#### Study 2 & Integrated Personal Distress Moderating Hearsay Accuracy for Conscientiousness
```{r dismod_ha_consc_int}
consc_dismod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxC_B", 
                                           "disxC_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

consc_dismod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxC_B", 
                                           "disxC_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_consc_dismod_ha <- anova(consc_dismod_ha_int_noeq,
                                   consc_dismod_ha_int_alleq)
model_comp_consc_dismod_ha
```

#### Study 2 & Integrated Personal Distress Moderating Hearsay Accuracy for Honesty-Propriety
```{r dismod_ha_hp_int}
hp_dismod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxHP_B", 
                                           "disxHP_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

hp_dismod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxHP_B", 
                                           "disxHP_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_hp_dismod_ha <- anova(hp_dismod_ha_int_noeq,
                                   hp_dismod_ha_int_alleq)
model_comp_hp_dismod_ha
```

#### Study 2 & Integrated Personal Distress Moderating Hearsay Accuracy for Neuroticism
```{r dismod_ha_neuro_int}
neuro_dismod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxN_B", 
                                           "disxN_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

neuro_dismod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxN_B", 
                                           "disxN_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_neuro_dismod_ha <- anova(neuro_dismod_ha_int_noeq,
                                   neuro_dismod_ha_int_alleq)
model_comp_neuro_dismod_ha
```

#### Study 2 & Integrated Personal Distress Moderating Hearsay Accuracy for Extraversion
```{r dismod_ha_extra_int}
extra_dismod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_extraversion", 
                                     "A_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxE_B", 
                                           "disxE_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

extra_dismod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_extraversion", 
                                     "A_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxE_B", 
                                           "disxE_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_extra_dismod_ha <- anova(extra_dismod_ha_int_noeq,
                                   extra_dismod_ha_int_alleq)
model_comp_extra_dismod_ha
```

#### Study 2 & Integrated Personal Distress Moderating Hearsay Accuracy for Openness
```{r dismod_ha_open_int}
open_dismod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxO_B", 
                                           "disxO_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

open_dismod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_distress_cent",
                                          "D_iri_distress_cent"),
                      interaction_term = c("disxO_B", 
                                           "disxO_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_open_dismod_ha <- anova(open_dismod_ha_int_noeq,
                                   open_dismod_ha_int_alleq)
model_comp_open_dismod_ha
```

### Study 2 & Integrated Fantasy Moderating Hearsay Accuracy
Starting with perspective taking.
#### Study 2 & Integrated Fantasy Moderating Hearsay Accuracy for Agreeableness
```{r fantmod_ha_agree_int}
agree_fantmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxA_B", 
                                           "fantxA_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

agree_fantmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_agreeableness", 
                                     "A_A_agreeableness"),
                      p2_reports = c("B_C_agreeableness_cent", 
                                     "D_A_agreeableness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxA_B", 
                                           "fantxA_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_agree_fantmod_ha <- anova(agree_fantmod_ha_int_noeq,
                                   agree_fantmod_ha_int_alleq)
model_comp_agree_fantmod_ha
```

#### Study 2 & Integrated Fantasy Moderating Hearsay Accuracy for Conscientiousness
```{r fantmod_ha_consc_int}
consc_fantmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxC_B", 
                                           "fantxC_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

consc_fantmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_conscientiousness", 
                                     "A_A_conscientiousness"),
                      p2_reports = c("B_C_conscientiousness_cent", 
                                     "D_A_conscientiousness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxC_B", 
                                           "fantxC_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_consc_fantmod_ha <- anova(consc_fantmod_ha_int_noeq,
                                   consc_fantmod_ha_int_alleq)
model_comp_consc_fantmod_ha
```

#### Study 2 & Integrated Fantasy Moderating Hearsay Accuracy for Honesty-Propriety
```{r fantmod_ha_hp_int}
hp_fantmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxHP_B", 
                                           "fantxHP_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

hp_fantmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_hp", 
                                     "A_A_hp"),
                      p2_reports = c("B_C_hp_cent", 
                                     "D_A_hp_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxHP_B", 
                                           "fantxHP_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_hp_fantmod_ha <- anova(hp_fantmod_ha_int_noeq,
                                   hp_fantmod_ha_int_alleq)
model_comp_hp_fantmod_ha
```

#### Study 2 & Integrated Fantasy Moderating Hearsay Accuracy for Neuroticism
```{r fantmod_ha_neuro_int}
neuro_fantmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxN_B", 
                                           "fantxN_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

neuro_fantmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_neuroticism", 
                                     "A_A_neuroticism"),
                      p2_reports = c("B_C_neuroticism_cent", 
                                     "D_A_neuroticism_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxN_B", 
                                           "fantxN_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_neuro_fantmod_ha <- anova(neuro_fantmod_ha_int_noeq,
                                   neuro_fantmod_ha_int_alleq)
model_comp_neuro_fantmod_ha
```

#### Study 2 & Integrated Fantasy Moderating Hearsay Accuracy for Extraversion
```{r fantmod_ha_extra_int}
extra_fantmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_extraversion", 
                                     "A_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxE_B", 
                                           "fantxE_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

extra_fantmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_extraversion", 
                                     "A_A_extraversion"),
                      p2_reports = c("B_C_extraversion_cent", 
                                     "D_A_extraversion_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxE_B", 
                                           "fantxE_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_extra_fantmod_ha <- anova(extra_fantmod_ha_int_noeq,
                                   extra_fantmod_ha_int_alleq)
model_comp_extra_fantmod_ha
```

#### Study 2 & Integrated Fantasy Moderating Hearsay Accuracy for Openness
```{r fantmod_ha_open_int}
open_fantmod_ha_int_noeq <- rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxO_B", 
                                           "fantxO_D"),
                      group_mod = "study",
                      params_eql = "none", 
                      groups_eql = "none")

open_fantmod_ha_int_alleq <- 
  rep_accuracy_group_id_mods(integrated,
                      target_self = c("C_C_openness", 
                                     "A_A_openness"),
                      p2_reports = c("B_C_openness_cent", 
                                     "D_A_openness_cent"),
                      id_mod_variable = c("B_iri_fantasy_cent",
                                          "D_iri_fantasy_cent"),
                      interaction_term = c("fantxO_B", 
                                           "fantxO_D"),
                      group_mod = "study",
                      params_eql = "all", 
                      groups_eql = "all")

model_comp_open_fantmod_ha <- anova(open_fantmod_ha_int_noeq,
                                   open_fantmod_ha_int_alleq)
model_comp_open_fantmod_ha
```

### Table of Model Comparisons for Pooling Empathy Moderating Hearsay Accuracy (part of Table S18)
```{r emp_mod_ha_int_comp_tbl}
pt_mod_ha_modelcomps <- ls() %>% 
  .[str_detect(., "model_comp_[:alpha:]*_PTmod_ha")]
empcon_mod_ha_modelcomps <- ls() %>% 
  .[str_detect(., "model_comp_[:alpha:]*_empmod_ha")]
dis_mod_ha_modelcomps <- ls() %>% 
  .[str_detect(., "model_comp_[:alpha:]*_dismod_ha")]
fant_mod_ha_modelcomps <- ls() %>% 
  .[str_detect(., "model_comp_[:alpha:]*_fantmod_ha")]

emp_mod_ha_modelcomps <- c(pt_mod_ha_modelcomps,
                           empcon_mod_ha_modelcomps,
                           dis_mod_ha_modelcomps,
                           fant_mod_ha_modelcomps)

emp_mod_ha_modelcomps %>% 
  lapply(FUN = get) %>%
  map(mutate, delt_aic = AIC - lag(AIC) ,
         delt_bic = BIC - lag(BIC) ) %>% 
  map_df(slice, -1) %>% 
  rename(pvalue = `Pr(>Chisq)`) %>% 
  mutate(name = emp_mod_ha_modelcomps) %>% 
  separate(name, c("temp1", "temp2", "domain", "mod", "temp3")) %>% 
  select(-starts_with("temp")) %>% 
  mutate(domain = case_when(domain == "agree" ~ "Agreeableness",
                            domain == "consc" ~ "Conscientiousness",
                            domain == "hp" ~ "Honesty-Propriety",
                            domain == "neuro" ~ "Neuroticism",
                            domain == "extra" ~ "Extraversion",
                            domain == "open" ~ "Openness"),
         domain = fct_relevel(domain, 
                              "Agreeableness",
                              "Conscientiousness",
                              "Honesty-Propriety",
                              "Neuroticism",
                              "Extraversion",
                              "Openness"),
         moderator = case_when(mod == "dismod"~ "Personal Distress",
                               mod == "empmod"~ "Empathic Concern",
                               mod == "PTmod"~ "Perspective Taking",
                               mod == "fantmod"~ "Fantasy"),
         moderator = fct_relevel(moderator, 
                                 "Perspective Taking",
                                 "Empathic Concern",
                                 "Personal Distress",
                                 "Fantasy"),
         pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 
                                 4, side = "right", pad ="0"),  
                         "< .001")) %>% 
  arrange(moderator, domain) %>% 
  select(moderator, domain,  `Df diff`, `Chisq diff`, pvalue, delt_aic, delt_bic) %>% 
  knitr::kable(caption = "Model Comparison Results for Integrating across Studies for Empathy moderating Hearsay Accuracy (S18)",
               digits = c(NA, NA, 2, 2, 3, 2, 2),
               format = "html", escape = FALSE) %>% 
  kable_styling("striped", full_width = F)
```
### Table of Empathy Moderating Hearsay Accuracy (part of Table S19 & S20)
First, search the environment for all of the objects ending in [moderator]_ha_int, which is how all of the  Empathy Heaesay Accuracy models end.

```{r emp_mod_ha_int_tbl}
pt_mod_ha_int <- ls() %>% 
  .[str_detect(., "PTmod_ha_int_[:alpha:]*$")]
empcon_mod_ha_int <- ls() %>% 
  .[str_detect(., "empmod_ha_int_[:alpha:]*$")]
dis_mod_ha_int <- ls() %>% 
  .[str_detect(., "dismod_ha_int_[:alpha:]*$")]
fant_mod_ha_int <- ls() %>% 
  .[str_detect(., "fantmod_ha_int_[:alpha:]*$")]

emp_mod_ha_int <- c(pt_mod_ha_int,
         empcon_mod_ha_int,
         dis_mod_ha_int,
         fant_mod_ha_int)
  
emp_mod_ha_int %>% 
  map(get) %>%
  map(ez_group_id_mod_table) %>% 
  enframe() %>% 
  mutate(name = emp_mod_ha_int) %>% 
  unnest() %>% 
  separate(name, c("domain", "mod", "temp")) %>% 
  select(-temp) %>% 
  mutate(domain = case_when(domain == "agree" ~ "Agreeableness",
                            domain == "consc" ~ "Conscientiousness",
                            domain == "hp" ~ "Honesty-Propriety",
                            domain == "neuro" ~ "Neuroticism",
                            domain == "extra" ~ "Extraversion",
                            domain == "open" ~ "Openness"),
         moderator = case_when(mod == "dismod"~ "Personal Distress",
                               mod == "empmod"~ "Empathic Concern",
                               mod == "PTmod"~ "Perspective Taking",
                               mod == "fantmod"~ "Fantasy"),
         moderator = fct_relevel(moderator, 
                                 "Perspective Taking",
                                 "Empathic Concern",
                                 "Personal Distress",
                                 "Fantasy"),
         study = case_when(is.na(group_label) ~ "Integrated",
           group_label == "grp1" ~ "Study 1",
           group_label == "grp2" ~ "Study 2"),
         domain = fct_relevel(domain, 
                              "Agreeableness",
                              "Conscientiousness",
                              "Honesty-Propriety",
                              "Neuroticism",
                              "Extraversion",
                              "Openness"),
         study = fct_relevel(study,
                             "Study 1",
                             "Study 2",
                             "Integrated"),
         beta = round(beta, 2),
         beta = ifelse(str_detect(beta, "\\..$"), paste0(beta, "0"), 
                    ifelse(str_detect(beta, "^0$"), paste0(beta, ".00"), beta)),
         beta = cell_spec(beta, "html",
                             bold = ifelse(pvalue == "< .001", TRUE,
                                    ifelse(as.numeric(pvalue) < .05, TRUE, FALSE))),
         ci_lower = round(ci_lower, 2),
         ci_lower = ifelse(str_detect(ci_lower, "\\..$"), paste0(ci_lower, "0"), 
                    ifelse(str_detect(ci_lower, "^0$"), paste0(ci_lower, ".00"), ci_lower)),
         ci_lower = cell_spec(ci_lower, "html",
                             bold = ifelse(pvalue == "< .001", TRUE,
                                    ifelse(as.numeric(pvalue) < .05, TRUE, FALSE))),
         ci_upper = round(ci_upper, 2),
         ci_upper = ifelse(str_detect(ci_upper, "\\..$"), paste0(ci_upper, "0"), 
                    ifelse(str_detect(ci_upper, "^0$"), paste0(ci_upper, ".00"), ci_upper)),
         ci_upper = cell_spec(ci_upper, "html",
                             bold = ifelse(pvalue == "< .001", TRUE,
                                    ifelse(as.numeric(pvalue) < .05, TRUE, FALSE))),
         pvalue = ifelse(pvalue >= .001, 
                         str_pad(str_replace(round(pvalue, 3), "0.", "."), 4, side = "right", pad ="0"),  
                         "< .001")) %>% 
  arrange(desc(study), moderator, domain) %>% 
  filter(parameter == "interaction effect" & 
           study != "Study 1") %>% 
  select(moderator, study, everything(),
         -group_label, -mod, -parameter, - study) %>% 
  knitr::kable(caption = "Study 2 & Integrated Empathy Moderating Hearsay Accuracy (part of S19)",
              format = "html", escape = F) %>% 
  kable_styling("striped", full_width = F) %>% 
  pack_rows("Integrated", 1, 24) %>% 
  pack_rows("Study 2", 25, 48)
```

